2022-11-20 20:30:44.082  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 341 due to node -1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 20:30:44.089  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node -1 disconnected.
2022-11-20 20:30:44.184  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 351 due to node -1 being disconnected (elapsed time since creation: 0ms, elapsed time since send: 0ms, request timeout: 30000ms)
2022-11-20 20:30:44.185  WARN [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-11-20 20:30:44.184  WARN [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-11-20 20:30:46.743  WARN [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Error while fetching metadata with correlation id 353 : {order_topics=LEADER_NOT_AVAILABLE}
2022-11-20 20:30:46.743  WARN [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Error while fetching metadata with correlation id 343 : {customer_topic=LEADER_NOT_AVAILABLE}
2022-11-20 20:30:46.750  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-1, groupId=email] Cluster ID: N6_RKQEzRKyebGgdHnjA8Q
2022-11-20 20:30:46.751  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-2, groupId=email] Cluster ID: N6_RKQEzRKyebGgdHnjA8Q
2022-11-20 20:30:46.869  WARN [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Error while fetching metadata with correlation id 350 : {payment_complete=LEADER_NOT_AVAILABLE}
2022-11-20 20:30:46.869  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-3, groupId=email] Cluster ID: N6_RKQEzRKyebGgdHnjA8Q
2022-11-20 20:30:46.873  WARN [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Error while fetching metadata with correlation id 346 : {customer_topic=LEADER_NOT_AVAILABLE}
2022-11-20 20:30:46.876  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-20 20:30:46.879  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-20 20:30:46.935  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] (Re-)joining group
2022-11-20 20:30:46.941  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-20 20:30:46.951  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] (Re-)joining group
2022-11-20 20:30:46.951  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] (Re-)joining group
2022-11-20 20:30:47.023  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-1, groupId=email] Resetting the last seen epoch of partition order_topics-0 to 0 since the associated topicId changed from null to WFpyU0BqR5-w7pCovYKThg
2022-11-20 20:30:47.024  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-2, groupId=email] Resetting the last seen epoch of partition customer_topic-0 to 0 since the associated topicId changed from null to tKr50QVbTM2_exfwcWm5Og
2022-11-20 20:30:47.092  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Group coordinator localhost:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: error response NOT_COORDINATOR.isDisconnected: false. Rediscovery will be attempted.
2022-11-20 20:30:47.094  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Group coordinator localhost:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: error response NOT_COORDINATOR.isDisconnected: false. Rediscovery will be attempted.
2022-11-20 20:30:47.094  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Requesting disconnect from last known coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-20 20:30:47.094  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] JoinGroup failed: This is not the correct coordinator. Marking coordinator unknown. Sent generation was Generation{generationId=-1, memberId='', protocol='null'}
2022-11-20 20:30:47.095  WARN [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Error while fetching metadata with correlation id 355 : {payment_complete=LEADER_NOT_AVAILABLE}
2022-11-20 20:30:47.099  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Group coordinator localhost:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: error response NOT_COORDINATOR.isDisconnected: false. Rediscovery will be attempted.
2022-11-20 20:30:47.099  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Requesting disconnect from last known coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-20 20:30:47.100  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] JoinGroup failed: This is not the correct coordinator. Marking coordinator unknown. Sent generation was Generation{generationId=-1, memberId='', protocol='null'}
2022-11-20 20:30:47.096  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Requesting disconnect from last known coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-20 20:30:47.110  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] JoinGroup failed: This is not the correct coordinator. Marking coordinator unknown. Sent generation was Generation{generationId=-1, memberId='', protocol='null'}
2022-11-20 20:30:47.200  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Client requested disconnect from node 2147483646
2022-11-20 20:30:47.201  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Client requested disconnect from node 2147483646
2022-11-20 20:30:47.216  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Client requested disconnect from node 2147483646
2022-11-20 20:30:47.228  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-20 20:30:47.229  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Group coordinator localhost:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
2022-11-20 20:30:47.229  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Requesting disconnect from last known coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-20 20:30:47.235  WARN [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Error while fetching metadata with correlation id 357 : {payment_complete=LEADER_NOT_AVAILABLE}
2022-11-20 20:30:47.240  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-20 20:30:47.308  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] (Re-)joining group
2022-11-20 20:30:47.248  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-20 20:30:47.309  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] (Re-)joining group
2022-11-20 20:30:47.327  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Request joining group due to: need to re-join with the given member-id
2022-11-20 20:30:47.327  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] (Re-)joining group
2022-11-20 20:30:47.327  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Request joining group due to: need to re-join with the given member-id
2022-11-20 20:30:47.328  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] (Re-)joining group
2022-11-20 20:30:47.333  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-20 20:30:47.334  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] (Re-)joining group
2022-11-20 20:30:47.345  WARN [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Error while fetching metadata with correlation id 361 : {payment_complete=LEADER_NOT_AVAILABLE}
2022-11-20 20:30:47.398  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Request joining group due to: need to re-join with the given member-id
2022-11-20 20:30:47.398  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] (Re-)joining group
2022-11-20 20:30:47.467  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-3, groupId=email] Resetting the last seen epoch of partition payment_complete-0 to 0 since the associated topicId changed from null to lXK061VOTzqVujfWi-KIWg
2022-11-20 20:31:32.144  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Successfully joined group with generation Generation{generationId=4, memberId='consumer-email-2-2aa210e8-9092-4f47-901c-f61ec8d5ae3a', protocol='range'}
2022-11-20 20:31:32.145  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Successfully joined group with generation Generation{generationId=4, memberId='consumer-email-3-5abe7b14-a077-4c2a-ac22-8be5771f8c09', protocol='range'}
2022-11-20 20:31:32.145  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Successfully joined group with generation Generation{generationId=4, memberId='consumer-email-1-c8ae66a0-0f6b-497b-be13-93018ea08fc8', protocol='range'}
2022-11-20 20:31:32.147  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-2, groupId=email] Resetting the last seen epoch of partition order_topics-0 to 0 since the associated topicId changed from null to WFpyU0BqR5-w7pCovYKThg
2022-11-20 20:31:32.147  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-2, groupId=email] Resetting the last seen epoch of partition payment_complete-0 to 0 since the associated topicId changed from null to lXK061VOTzqVujfWi-KIWg
2022-11-20 20:31:32.172  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Finished assignment for group at generation 4: {consumer-email-2-2aa210e8-9092-4f47-901c-f61ec8d5ae3a=Assignment(partitions=[customer_topic-0]), consumer-email-3-5abe7b14-a077-4c2a-ac22-8be5771f8c09=Assignment(partitions=[payment_complete-0]), consumer-email-1-c8ae66a0-0f6b-497b-be13-93018ea08fc8=Assignment(partitions=[order_topics-0])}
2022-11-20 20:31:32.263  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Successfully synced group in generation Generation{generationId=4, memberId='consumer-email-1-c8ae66a0-0f6b-497b-be13-93018ea08fc8', protocol='range'}
2022-11-20 20:31:32.263  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Successfully synced group in generation Generation{generationId=4, memberId='consumer-email-3-5abe7b14-a077-4c2a-ac22-8be5771f8c09', protocol='range'}
2022-11-20 20:31:32.264  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Notifying assignor about the new Assignment(partitions=[order_topics-0])
2022-11-20 20:31:32.264  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Successfully synced group in generation Generation{generationId=4, memberId='consumer-email-2-2aa210e8-9092-4f47-901c-f61ec8d5ae3a', protocol='range'}
2022-11-20 20:31:32.264  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Notifying assignor about the new Assignment(partitions=[customer_topic-0])
2022-11-20 20:31:32.270  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Notifying assignor about the new Assignment(partitions=[payment_complete-0])
2022-11-20 20:31:32.277  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Adding newly assigned partitions: order_topics-0
2022-11-20 20:31:32.287  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Adding newly assigned partitions: payment_complete-0
2022-11-20 20:31:32.287  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Adding newly assigned partitions: customer_topic-0
2022-11-20 20:31:32.352  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Found no committed offset for partition payment_complete-0
2022-11-20 20:31:32.355  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Found no committed offset for partition customer_topic-0
2022-11-20 20:31:32.356  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Setting offset for partition order_topics-0 to the committed offset FetchPosition{offset=3, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2022-11-20 20:31:32.382  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.SubscriptionState    : [Consumer clientId=consumer-email-3, groupId=email] Resetting offset for partition payment_complete-0 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}.
2022-11-20 20:31:32.387  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.SubscriptionState    : [Consumer clientId=consumer-email-2, groupId=email] Resetting offset for partition customer_topic-0 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}.
2022-11-20 20:31:32.388  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions assigned: [customer_topic-0]
2022-11-20 20:31:32.394  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions assigned: [order_topics-0]
2022-11-20 20:31:32.395  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions assigned: [payment_complete-0]
2022-11-20 20:32:22.359  INFO [EMAIL-SERVICE,5175637fc677250f,20c1ca92d5a0a33f] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => OrderEvent(status=PENDING, message=Complete the payment, customer=Customer(id=1, name=Aditya, email=abc@gamil.com, age=26), order=Order(id=6207d1c3-6e8e-42a1-b87e-b651d94bad6d, cid=1, pid=2, qty=3), product=Product(id=2, name=laptop, price=100000.0, qtyavail=10))
2022-11-20 20:34:49.347  INFO [PAYMENT-SERVICE,,] 94704 --- [main] c.a.p.PaymentServiceApplication          : Starting PaymentServiceApplication using Java 19.0.1 on aditya-ASUS-TUF-Gaming-F15-FX506LI-FX566LI with PID 94704 (/home/aditya/Downloads/Ecommerce-ordering-service/payment-service/target/classes started by aditya in /home/aditya/Downloads/Ecommerce-ordering-service)
2022-11-20 20:34:49.349  INFO [PAYMENT-SERVICE,,] 94704 --- [main] c.a.p.PaymentServiceApplication          : No active profile set, falling back to 1 default profile: "default"
2022-11-20 20:34:50.037  INFO [PAYMENT-SERVICE,,] 94704 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data MongoDB repositories in DEFAULT mode.
2022-11-20 20:34:50.070  INFO [PAYMENT-SERVICE,,] 94704 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 29 ms. Found 1 MongoDB repository interfaces.
2022-11-20 20:34:50.235  INFO [PAYMENT-SERVICE,,] 94704 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=d0402322-be04-3e01-ad61-f132a73926d8
2022-11-20 20:34:50.702  INFO [PAYMENT-SERVICE,,] 94704 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8086 (http)
2022-11-20 20:34:50.709  INFO [PAYMENT-SERVICE,,] 94704 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-20 20:34:50.709  INFO [PAYMENT-SERVICE,,] 94704 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.68]
2022-11-20 20:34:50.809  INFO [PAYMENT-SERVICE,,] 94704 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-20 20:34:50.809  INFO [PAYMENT-SERVICE,,] 94704 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1394 ms
2022-11-20 20:34:51.331  INFO [PAYMENT-SERVICE,,] 94704 --- [main] org.mongodb.driver.client                : MongoClient with metadata {"driver": {"name": "mongo-java-driver|sync|spring-boot", "version": "4.6.1"}, "os": {"type": "Linux", "name": "Linux", "architecture": "amd64", "version": "5.15.0-53-generic"}, "platform": "Java/Oracle Corporation/19.0.1+10-21"} created with settings MongoClientSettings{readPreference=primary, writeConcern=WriteConcern{w=null, wTimeout=null ms, journal=null}, retryWrites=true, retryReads=true, readConcern=ReadConcern{level=null}, credential=null, streamFactoryFactory=null, commandListeners=[org.springframework.cloud.sleuth.instrument.mongodb.TraceMongoCommandListener@4eeab3e], codecRegistry=ProvidersCodecRegistry{codecProviders=[ValueCodecProvider{}, BsonValueCodecProvider{}, DBRefCodecProvider{}, DBObjectCodecProvider{}, DocumentCodecProvider{}, IterableCodecProvider{}, MapCodecProvider{}, GeoJsonCodecProvider{}, GridFSFileCodecProvider{}, Jsr310CodecProvider{}, JsonObjectCodecProvider{}, BsonCodecProvider{}, EnumCodecProvider{}, com.mongodb.Jep395RecordCodecProvider@2b6fb197]}, clusterSettings={hosts=[localhost:27017], srvServiceName=mongodb, mode=SINGLE, requiredClusterType=UNKNOWN, requiredReplicaSetName='null', serverSelector='null', clusterListeners='[]', serverSelectionTimeout='30000 ms', localThreshold='30000 ms'}, socketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=0, receiveBufferSize=0, sendBufferSize=0}, heartbeatSocketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=10000, receiveBufferSize=0, sendBufferSize=0}, connectionPoolSettings=ConnectionPoolSettings{maxSize=100, minSize=0, maxWaitTimeMS=120000, maxConnectionLifeTimeMS=0, maxConnectionIdleTimeMS=0, maintenanceInitialDelayMS=0, maintenanceFrequencyMS=60000, connectionPoolListeners=[], maxConnecting=2}, serverSettings=ServerSettings{heartbeatFrequencyMS=10000, minHeartbeatFrequencyMS=500, serverListeners='[]', serverMonitorListeners='[]'}, sslSettings=SslSettings{enabled=false, invalidHostNameAllowed=false, context=null}, applicationName='null', compressorList=[], uuidRepresentation=JAVA_LEGACY, serverApi=null, autoEncryptionSettings=null, contextProvider=org.springframework.cloud.sleuth.instrument.mongodb.TraceSynchronousMongoClientSettingsBuilderCustomizer$$Lambda$678/0x0000000801458438@2eb0cefe}
2022-11-20 20:34:51.392  INFO [PAYMENT-SERVICE,,] 94704 --- [cluster-ClusterId{value='637a4213f13ab25a04a9c3dd', description='null'}-localhost:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server localhost:27017

com.mongodb.MongoSocketOpenException: Exception opening socket
	at com.mongodb.internal.connection.SocketStream.open(SocketStream.java:70) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.InternalStreamConnection.open(InternalStreamConnection.java:180) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:193) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:157) ~[mongodb-driver-core-4.6.1.jar:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:535) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:585) ~[na:na]
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:666) ~[na:na]
	at com.mongodb.internal.connection.SocketStreamHelper.initialize(SocketStreamHelper.java:107) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.SocketStream.initializeSocket(SocketStream.java:79) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.SocketStream.open(SocketStream.java:65) ~[mongodb-driver-core-4.6.1.jar:na]
	... 4 common frames omitted

2022-11-20 20:34:52.467  INFO [PAYMENT-SERVICE,,] 94704 --- [main] o.a.k.clients.admin.AdminClientConfig    : AdminClientConfig values: 
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	client.id = 
	connections.max.idle.ms = 300000
	default.api.timeout.ms = 60000
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS

2022-11-20 20:34:52.582  INFO [PAYMENT-SERVICE,,] 94704 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-20 20:34:52.582  INFO [PAYMENT-SERVICE,,] 94704 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-20 20:34:52.582  INFO [PAYMENT-SERVICE,,] 94704 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1668956692581
2022-11-20 20:34:52.839  INFO [PAYMENT-SERVICE,,] 94704 --- [kafka-admin-client-thread | adminclient-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.admin.client for adminclient-1 unregistered
2022-11-20 20:34:52.843  INFO [PAYMENT-SERVICE,,] 94704 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-20 20:34:52.844  INFO [PAYMENT-SERVICE,,] 94704 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-20 20:34:52.844  INFO [PAYMENT-SERVICE,,] 94704 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-20 20:34:52.856  INFO [PAYMENT-SERVICE,,] 94704 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8086 (http) with context path ''
2022-11-20 20:34:52.900  INFO [PAYMENT-SERVICE,,] 94704 --- [main] c.a.p.PaymentServiceApplication          : Started PaymentServiceApplication in 4.03 seconds (JVM running for 4.467)
2022-11-20 20:37:53.068  INFO [PAYMENT-SERVICE,,] 94704 --- [Thread-2] o.s.c.s.a.z.ZipkinAutoConfiguration      : Flushing remaining spans on shutdown
2022-11-20 20:37:57.669  INFO [PAYMENT-SERVICE,,] 95982 --- [main] c.a.p.PaymentServiceApplication          : Starting PaymentServiceApplication using Java 19.0.1 on aditya-ASUS-TUF-Gaming-F15-FX506LI-FX566LI with PID 95982 (/home/aditya/Downloads/Ecommerce-ordering-service/payment-service/target/classes started by aditya in /home/aditya/Downloads/Ecommerce-ordering-service)
2022-11-20 20:37:57.671  INFO [PAYMENT-SERVICE,,] 95982 --- [main] c.a.p.PaymentServiceApplication          : No active profile set, falling back to 1 default profile: "default"
2022-11-20 20:37:58.252  INFO [PAYMENT-SERVICE,,] 95982 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data MongoDB repositories in DEFAULT mode.
2022-11-20 20:37:58.283  INFO [PAYMENT-SERVICE,,] 95982 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 27 ms. Found 1 MongoDB repository interfaces.
2022-11-20 20:37:58.441  INFO [PAYMENT-SERVICE,,] 95982 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=d0402322-be04-3e01-ad61-f132a73926d8
2022-11-20 20:37:58.962  INFO [PAYMENT-SERVICE,,] 95982 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8086 (http)
2022-11-20 20:37:58.969  INFO [PAYMENT-SERVICE,,] 95982 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-20 20:37:58.969  INFO [PAYMENT-SERVICE,,] 95982 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.68]
2022-11-20 20:37:59.044  INFO [PAYMENT-SERVICE,,] 95982 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-20 20:37:59.045  INFO [PAYMENT-SERVICE,,] 95982 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1328 ms
2022-11-20 20:37:59.639  INFO [PAYMENT-SERVICE,,] 95982 --- [cluster-ClusterId{value='637a42cf8aa6873caedbf9ef', description='null'}-localhost:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server localhost:27017

com.mongodb.MongoSocketOpenException: Exception opening socket
	at com.mongodb.internal.connection.SocketStream.open(SocketStream.java:70) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.InternalStreamConnection.open(InternalStreamConnection.java:180) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:193) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:157) ~[mongodb-driver-core-4.6.1.jar:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:535) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:585) ~[na:na]
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:666) ~[na:na]
	at com.mongodb.internal.connection.SocketStreamHelper.initialize(SocketStreamHelper.java:107) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.SocketStream.initializeSocket(SocketStream.java:79) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.SocketStream.open(SocketStream.java:65) ~[mongodb-driver-core-4.6.1.jar:na]
	... 4 common frames omitted

2022-11-20 20:37:59.641  INFO [PAYMENT-SERVICE,,] 95982 --- [main] org.mongodb.driver.client                : MongoClient with metadata {"driver": {"name": "mongo-java-driver|sync|spring-boot", "version": "4.6.1"}, "os": {"type": "Linux", "name": "Linux", "architecture": "amd64", "version": "5.15.0-53-generic"}, "platform": "Java/Oracle Corporation/19.0.1+10-21"} created with settings MongoClientSettings{readPreference=primary, writeConcern=WriteConcern{w=null, wTimeout=null ms, journal=null}, retryWrites=true, retryReads=true, readConcern=ReadConcern{level=null}, credential=null, streamFactoryFactory=null, commandListeners=[org.springframework.cloud.sleuth.instrument.mongodb.TraceMongoCommandListener@7a0ab480], codecRegistry=ProvidersCodecRegistry{codecProviders=[ValueCodecProvider{}, BsonValueCodecProvider{}, DBRefCodecProvider{}, DBObjectCodecProvider{}, DocumentCodecProvider{}, IterableCodecProvider{}, MapCodecProvider{}, GeoJsonCodecProvider{}, GridFSFileCodecProvider{}, Jsr310CodecProvider{}, JsonObjectCodecProvider{}, BsonCodecProvider{}, EnumCodecProvider{}, com.mongodb.Jep395RecordCodecProvider@79df80a4]}, clusterSettings={hosts=[localhost:27017], srvServiceName=mongodb, mode=SINGLE, requiredClusterType=UNKNOWN, requiredReplicaSetName='null', serverSelector='null', clusterListeners='[]', serverSelectionTimeout='30000 ms', localThreshold='30000 ms'}, socketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=0, receiveBufferSize=0, sendBufferSize=0}, heartbeatSocketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=10000, receiveBufferSize=0, sendBufferSize=0}, connectionPoolSettings=ConnectionPoolSettings{maxSize=100, minSize=0, maxWaitTimeMS=120000, maxConnectionLifeTimeMS=0, maxConnectionIdleTimeMS=0, maintenanceInitialDelayMS=0, maintenanceFrequencyMS=60000, connectionPoolListeners=[], maxConnecting=2}, serverSettings=ServerSettings{heartbeatFrequencyMS=10000, minHeartbeatFrequencyMS=500, serverListeners='[]', serverMonitorListeners='[]'}, sslSettings=SslSettings{enabled=false, invalidHostNameAllowed=false, context=null}, applicationName='null', compressorList=[], uuidRepresentation=JAVA_LEGACY, serverApi=null, autoEncryptionSettings=null, contextProvider=org.springframework.cloud.sleuth.instrument.mongodb.TraceSynchronousMongoClientSettingsBuilderCustomizer$$Lambda$678/0x0000000801451b28@130cfc47}
2022-11-20 20:38:00.838  INFO [PAYMENT-SERVICE,,] 95982 --- [main] o.a.k.clients.admin.AdminClientConfig    : AdminClientConfig values: 
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	client.id = 
	connections.max.idle.ms = 300000
	default.api.timeout.ms = 60000
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS

2022-11-20 20:38:00.954  INFO [PAYMENT-SERVICE,,] 95982 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-20 20:38:00.955  INFO [PAYMENT-SERVICE,,] 95982 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-20 20:38:00.955  INFO [PAYMENT-SERVICE,,] 95982 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1668956880954
2022-11-20 20:38:01.164  INFO [PAYMENT-SERVICE,,] 95982 --- [kafka-admin-client-thread | adminclient-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.admin.client for adminclient-1 unregistered
2022-11-20 20:38:01.168  INFO [PAYMENT-SERVICE,,] 95982 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-20 20:38:01.168  INFO [PAYMENT-SERVICE,,] 95982 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-20 20:38:01.168  INFO [PAYMENT-SERVICE,,] 95982 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-20 20:38:01.182  INFO [PAYMENT-SERVICE,,] 95982 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8086 (http) with context path ''
2022-11-20 20:38:01.226  INFO [PAYMENT-SERVICE,,] 95982 --- [main] c.a.p.PaymentServiceApplication          : Started PaymentServiceApplication in 3.998 seconds (JVM running for 4.412)
2022-11-20 20:38:53.499  INFO [PAYMENT-SERVICE,e713478205e23185,e713478205e23185] 95982 --- [http-nio-8086-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-11-20 20:38:53.499  INFO [PAYMENT-SERVICE,e713478205e23185,e713478205e23185] 95982 --- [http-nio-8086-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-11-20 20:38:53.500  INFO [PAYMENT-SERVICE,e713478205e23185,e713478205e23185] 95982 --- [http-nio-8086-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2022-11-20 20:38:53.512  WARN [PAYMENT-SERVICE,e713478205e23185,e713478205e23185] 95982 --- [http-nio-8086-exec-2] .w.s.m.s.DefaultHandlerExceptionResolver : Resolved [org.springframework.web.HttpRequestMethodNotSupportedException: Request method 'GET' not supported]
2022-11-20 20:38:59.919  INFO [PAYMENT-SERVICE,206cd71e8496a40b,206cd71e8496a40b] 95982 --- [http-nio-8086-exec-3] org.mongodb.driver.cluster               : Cluster description not yet available. Waiting for 30000 ms before timing out
2022-11-20 20:39:29.929 ERROR [PAYMENT-SERVICE,206cd71e8496a40b,206cd71e8496a40b] 95982 --- [http-nio-8086-exec-3] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is org.springframework.dao.DataAccessResourceFailureException: Timed out after 30000 ms while waiting to connect. Client view of cluster state is {type=UNKNOWN, servers=[{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketOpenException: Exception opening socket}, caused by {java.net.ConnectException: Connection refused}}]; nested exception is com.mongodb.MongoTimeoutException: Timed out after 30000 ms while waiting to connect. Client view of cluster state is {type=UNKNOWN, servers=[{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketOpenException: Exception opening socket}, caused by {java.net.ConnectException: Connection refused}}]] with root cause

com.mongodb.MongoTimeoutException: Timed out after 30000 ms while waiting to connect. Client view of cluster state is {type=UNKNOWN, servers=[{address=localhost:27017, type=UNKNOWN, state=CONNECTING, exception={com.mongodb.MongoSocketOpenException: Exception opening socket}, caused by {java.net.ConnectException: Connection refused}}]
	at com.mongodb.internal.connection.BaseCluster.getDescription(BaseCluster.java:180) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.SingleServerCluster.getDescription(SingleServerCluster.java:44) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.client.internal.MongoClientDelegate.getConnectedClusterDescription(MongoClientDelegate.java:144) ~[mongodb-driver-sync-4.6.1.jar:na]
	at com.mongodb.client.internal.MongoClientDelegate.createClientSession(MongoClientDelegate.java:101) ~[mongodb-driver-sync-4.6.1.jar:na]
	at com.mongodb.client.internal.MongoClientDelegate$DelegateOperationExecutor.getClientSession(MongoClientDelegate.java:291) ~[mongodb-driver-sync-4.6.1.jar:na]
	at com.mongodb.client.internal.MongoClientDelegate$DelegateOperationExecutor.execute(MongoClientDelegate.java:207) ~[mongodb-driver-sync-4.6.1.jar:na]
	at com.mongodb.client.internal.MongoCollectionImpl.executeSingleWriteRequest(MongoCollectionImpl.java:1010) ~[mongodb-driver-sync-4.6.1.jar:na]
	at com.mongodb.client.internal.MongoCollectionImpl.executeReplaceOne(MongoCollectionImpl.java:568) ~[mongodb-driver-sync-4.6.1.jar:na]
	at com.mongodb.client.internal.MongoCollectionImpl.replaceOne(MongoCollectionImpl.java:551) ~[mongodb-driver-sync-4.6.1.jar:na]
	at org.springframework.data.mongodb.core.MongoTemplate.lambda$saveDocument$17(MongoTemplate.java:1632) ~[spring-data-mongodb-3.4.5.jar:3.4.5]
	at org.springframework.data.mongodb.core.MongoTemplate.execute(MongoTemplate.java:598) ~[spring-data-mongodb-3.4.5.jar:3.4.5]
	at org.springframework.data.mongodb.core.MongoTemplate.saveDocument(MongoTemplate.java:1598) ~[spring-data-mongodb-3.4.5.jar:3.4.5]
	at org.springframework.data.mongodb.core.MongoTemplate.doSave(MongoTemplate.java:1530) ~[spring-data-mongodb-3.4.5.jar:3.4.5]
	at org.springframework.data.mongodb.core.MongoTemplate.save(MongoTemplate.java:1473) ~[spring-data-mongodb-3.4.5.jar:3.4.5]
	at org.springframework.data.mongodb.repository.support.SimpleMongoRepository.save(SimpleMongoRepository.java:98) ~[spring-data-mongodb-3.4.5.jar:3.4.5]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:289) ~[spring-data-commons-2.7.5.jar:2.7.5]
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137) ~[spring-data-commons-2.7.5.jar:2.7.5]
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121) ~[spring-data-commons-2.7.5.jar:2.7.5]
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:530) ~[spring-data-commons-2.7.5.jar:2.7.5]
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:286) ~[spring-data-commons-2.7.5.jar:2.7.5]
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:640) ~[spring-data-commons-2.7.5.jar:2.7.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:164) ~[spring-data-commons-2.7.5.jar:2.7.5]
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139) ~[spring-data-commons-2.7.5.jar:2.7.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81) ~[spring-data-commons-2.7.5.jar:2.7.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215) ~[spring-aop-5.3.23.jar:5.3.23]
	at jdk.proxy2/jdk.proxy2.$Proxy98.save(Unknown Source) ~[na:na]
	at com.adirn.paymentservice.service.PaymentService.savePayment(PaymentService.java:23) ~[classes/:na]
	at com.adirn.paymentservice.controller.PaymentController.postPayment(ProductController.java:28) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.23.jar:5.3.23]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.23.jar:5.3.23]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.23.jar:5.3.23]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.23.jar:5.3.23]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1071) ~[spring-webmvc-5.3.23.jar:5.3.23]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:964) ~[spring-webmvc-5.3.23.jar:5.3.23]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.23.jar:5.3.23]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.23.jar:5.3.23]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:696) ~[tomcat-embed-core-9.0.68.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.23.jar:5.3.23]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:779) ~[tomcat-embed-core-9.0.68.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) ~[tomcat-embed-websocket-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.23.jar:5.3.23]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.23.jar:5.3.23]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.springframework.cloud.sleuth.instrument.web.servlet.TracingFilter.doFilter(TracingFilter.java:68) ~[spring-cloud-sleuth-instrumentation-3.1.5.jar:3.1.5]
	at org.springframework.cloud.sleuth.autoconfig.instrument.web.TraceWebServletConfiguration$LazyTracingFilter.doFilter(TraceWebServletConfiguration.java:131) ~[spring-cloud-sleuth-autoconfigure-3.1.5.jar:3.1.5]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.23.jar:5.3.23]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:541) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.springframework.cloud.sleuth.instrument.web.tomcat.TraceValve.invoke(TraceValve.java:103) ~[spring-cloud-sleuth-instrumentation-3.1.5.jar:3.1.5]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:360) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1789) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]

2022-11-20 20:39:46.929  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node -1 disconnected.
2022-11-20 20:39:46.939  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node -1 disconnected.
2022-11-20 20:39:46.939  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node -1 disconnected.
2022-11-20 20:39:56.731  INFO [PAYMENT-SERVICE,,] 95982 --- [Thread-2] o.s.c.s.a.z.ZipkinAutoConfiguration      : Flushing remaining spans on shutdown
2022-11-20 20:40:00.334  INFO [PAYMENT-SERVICE,,] 96733 --- [main] c.a.p.PaymentServiceApplication          : Starting PaymentServiceApplication using Java 19.0.1 on aditya-ASUS-TUF-Gaming-F15-FX506LI-FX566LI with PID 96733 (/home/aditya/Downloads/Ecommerce-ordering-service/payment-service/target/classes started by aditya in /home/aditya/Downloads/Ecommerce-ordering-service)
2022-11-20 20:40:00.337  INFO [PAYMENT-SERVICE,,] 96733 --- [main] c.a.p.PaymentServiceApplication          : No active profile set, falling back to 1 default profile: "default"
2022-11-20 20:40:01.045  INFO [PAYMENT-SERVICE,,] 96733 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data MongoDB repositories in DEFAULT mode.
2022-11-20 20:40:01.086  INFO [PAYMENT-SERVICE,,] 96733 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 38 ms. Found 1 MongoDB repository interfaces.
2022-11-20 20:40:01.287  INFO [PAYMENT-SERVICE,,] 96733 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=d0402322-be04-3e01-ad61-f132a73926d8
2022-11-20 20:40:01.778  INFO [PAYMENT-SERVICE,,] 96733 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8086 (http)
2022-11-20 20:40:01.785  INFO [PAYMENT-SERVICE,,] 96733 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-20 20:40:01.785  INFO [PAYMENT-SERVICE,,] 96733 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.68]
2022-11-20 20:40:01.870  INFO [PAYMENT-SERVICE,,] 96733 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-20 20:40:01.870  INFO [PAYMENT-SERVICE,,] 96733 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1481 ms
2022-11-20 20:40:02.460  INFO [PAYMENT-SERVICE,,] 96733 --- [main] org.mongodb.driver.client                : MongoClient with metadata {"driver": {"name": "mongo-java-driver|sync|spring-boot", "version": "4.6.1"}, "os": {"type": "Linux", "name": "Linux", "architecture": "amd64", "version": "5.15.0-53-generic"}, "platform": "Java/Oracle Corporation/19.0.1+10-21"} created with settings MongoClientSettings{readPreference=primary, writeConcern=WriteConcern{w=majority, wTimeout=null ms, journal=null}, retryWrites=true, retryReads=true, readConcern=ReadConcern{level=null}, credential=MongoCredential{mechanism=null, userName='user1', source='admin', password=<hidden>, mechanismProperties=<hidden>}, streamFactoryFactory=null, commandListeners=[org.springframework.cloud.sleuth.instrument.mongodb.TraceMongoCommandListener@37d28938], codecRegistry=ProvidersCodecRegistry{codecProviders=[ValueCodecProvider{}, BsonValueCodecProvider{}, DBRefCodecProvider{}, DBObjectCodecProvider{}, DocumentCodecProvider{}, IterableCodecProvider{}, MapCodecProvider{}, GeoJsonCodecProvider{}, GridFSFileCodecProvider{}, Jsr310CodecProvider{}, JsonObjectCodecProvider{}, BsonCodecProvider{}, EnumCodecProvider{}, com.mongodb.Jep395RecordCodecProvider@7d0cd23c]}, clusterSettings={hosts=[127.0.0.1:27017], srvHost=cluster0.rckqz.mongodb.net, srvServiceName=mongodb, mode=MULTIPLE, requiredClusterType=REPLICA_SET, requiredReplicaSetName='atlas-tp1paz-shard-0', serverSelector='null', clusterListeners='[]', serverSelectionTimeout='30000 ms', localThreshold='30000 ms'}, socketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=0, receiveBufferSize=0, sendBufferSize=0}, heartbeatSocketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=10000, receiveBufferSize=0, sendBufferSize=0}, connectionPoolSettings=ConnectionPoolSettings{maxSize=100, minSize=0, maxWaitTimeMS=120000, maxConnectionLifeTimeMS=0, maxConnectionIdleTimeMS=0, maintenanceInitialDelayMS=0, maintenanceFrequencyMS=60000, connectionPoolListeners=[], maxConnecting=2}, serverSettings=ServerSettings{heartbeatFrequencyMS=10000, minHeartbeatFrequencyMS=500, serverListeners='[]', serverMonitorListeners='[]'}, sslSettings=SslSettings{enabled=true, invalidHostNameAllowed=false, context=null}, applicationName='null', compressorList=[], uuidRepresentation=JAVA_LEGACY, serverApi=null, autoEncryptionSettings=null, contextProvider=org.springframework.cloud.sleuth.instrument.mongodb.TraceSynchronousMongoClientSettingsBuilderCustomizer$$Lambda$687/0x0000000801458a88@17c4dc5b}
2022-11-20 20:40:02.498  INFO [PAYMENT-SERVICE,,] 96733 --- [cluster-ClusterId{value='637a434a90e2501a8b8f3af8', description='null'}-srv-cluster0.rckqz.mongodb.net] org.mongodb.driver.cluster               : Adding discovered server cluster0-shard-00-02.rckqz.mongodb.net:27017 to client view of cluster
2022-11-20 20:40:02.521  INFO [PAYMENT-SERVICE,,] 96733 --- [cluster-ClusterId{value='637a434a90e2501a8b8f3af8', description='null'}-srv-cluster0.rckqz.mongodb.net] org.mongodb.driver.cluster               : Adding discovered server cluster0-shard-00-01.rckqz.mongodb.net:27017 to client view of cluster
2022-11-20 20:40:02.523  INFO [PAYMENT-SERVICE,,] 96733 --- [cluster-ClusterId{value='637a434a90e2501a8b8f3af8', description='null'}-srv-cluster0.rckqz.mongodb.net] org.mongodb.driver.cluster               : Adding discovered server cluster0-shard-00-00.rckqz.mongodb.net:27017 to client view of cluster
2022-11-20 20:40:03.105  INFO [PAYMENT-SERVICE,,] 96733 --- [cluster-rtt-ClusterId{value='637a434a90e2501a8b8f3af8', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:5, serverValue:6621}] to cluster0-shard-00-01.rckqz.mongodb.net:27017
2022-11-20 20:40:03.105  INFO [PAYMENT-SERVICE,,] 96733 --- [cluster-ClusterId{value='637a434a90e2501a8b8f3af8', description='null'}-cluster0-shard-00-02.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:3, serverValue:7750}] to cluster0-shard-00-02.rckqz.mongodb.net:27017
2022-11-20 20:40:03.105  INFO [PAYMENT-SERVICE,,] 96733 --- [cluster-rtt-ClusterId{value='637a434a90e2501a8b8f3af8', description='null'}-cluster0-shard-00-02.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:1, serverValue:7735}] to cluster0-shard-00-02.rckqz.mongodb.net:27017
2022-11-20 20:40:03.105  INFO [PAYMENT-SERVICE,,] 96733 --- [cluster-rtt-ClusterId{value='637a434a90e2501a8b8f3af8', description='null'}-cluster0-shard-00-00.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:6, serverValue:7283}] to cluster0-shard-00-00.rckqz.mongodb.net:27017
2022-11-20 20:40:03.105  INFO [PAYMENT-SERVICE,,] 96733 --- [cluster-ClusterId{value='637a434a90e2501a8b8f3af8', description='null'}-cluster0-shard-00-02.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=cluster0-shard-00-02.rckqz.mongodb.net:27017, type=REPLICA_SET_PRIMARY, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=13, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=318505042, setName='atlas-tp1paz-shard-0', canonicalAddress=cluster0-shard-00-02.rckqz.mongodb.net:27017, hosts=[cluster0-shard-00-02.rckqz.mongodb.net:27017, cluster0-shard-00-01.rckqz.mongodb.net:27017, cluster0-shard-00-00.rckqz.mongodb.net:27017], passives=[], arbiters=[], primary='cluster0-shard-00-02.rckqz.mongodb.net:27017', tagSet=TagSet{[Tag{name='nodeType', value='ELECTABLE'}, Tag{name='provider', value='AWS'}, Tag{name='region', value='AP_SOUTH_1'}, Tag{name='workloadType', value='OPERATIONAL'}]}, electionId=7fffffff0000000000000142, setVersion=7, topologyVersion=TopologyVersion{processId=637a0103d8ca2976d20bdc8a, counter=6}, lastWriteDate=Sun Nov 20 20:40:03 IST 2022, lastUpdateTimeNanos=17572002718225}
2022-11-20 20:40:03.108  INFO [PAYMENT-SERVICE,,] 96733 --- [cluster-ClusterId{value='637a434a90e2501a8b8f3af8', description='null'}-cluster0-shard-00-02.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Setting max election id to 7fffffff0000000000000142 from replica set primary cluster0-shard-00-02.rckqz.mongodb.net:27017
2022-11-20 20:40:03.108  INFO [PAYMENT-SERVICE,,] 96733 --- [cluster-ClusterId{value='637a434a90e2501a8b8f3af8', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:4, serverValue:6621}] to cluster0-shard-00-01.rckqz.mongodb.net:27017
2022-11-20 20:40:03.108  INFO [PAYMENT-SERVICE,,] 96733 --- [cluster-ClusterId{value='637a434a90e2501a8b8f3af8', description='null'}-cluster0-shard-00-00.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:2, serverValue:7283}] to cluster0-shard-00-00.rckqz.mongodb.net:27017
2022-11-20 20:40:03.108  INFO [PAYMENT-SERVICE,,] 96733 --- [cluster-ClusterId{value='637a434a90e2501a8b8f3af8', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=cluster0-shard-00-01.rckqz.mongodb.net:27017, type=REPLICA_SET_SECONDARY, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=13, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=323476640, setName='atlas-tp1paz-shard-0', canonicalAddress=cluster0-shard-00-01.rckqz.mongodb.net:27017, hosts=[cluster0-shard-00-02.rckqz.mongodb.net:27017, cluster0-shard-00-01.rckqz.mongodb.net:27017, cluster0-shard-00-00.rckqz.mongodb.net:27017], passives=[], arbiters=[], primary='cluster0-shard-00-02.rckqz.mongodb.net:27017', tagSet=TagSet{[Tag{name='nodeType', value='ELECTABLE'}, Tag{name='provider', value='AWS'}, Tag{name='region', value='AP_SOUTH_1'}, Tag{name='workloadType', value='OPERATIONAL'}]}, electionId=null, setVersion=7, topologyVersion=TopologyVersion{processId=637a02391f563ed75643efb8, counter=3}, lastWriteDate=Sun Nov 20 20:40:03 IST 2022, lastUpdateTimeNanos=17572006648436}
2022-11-20 20:40:03.108  INFO [PAYMENT-SERVICE,,] 96733 --- [cluster-ClusterId{value='637a434a90e2501a8b8f3af8', description='null'}-cluster0-shard-00-00.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=cluster0-shard-00-00.rckqz.mongodb.net:27017, type=REPLICA_SET_SECONDARY, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=13, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=323479432, setName='atlas-tp1paz-shard-0', canonicalAddress=cluster0-shard-00-00.rckqz.mongodb.net:27017, hosts=[cluster0-shard-00-02.rckqz.mongodb.net:27017, cluster0-shard-00-01.rckqz.mongodb.net:27017, cluster0-shard-00-00.rckqz.mongodb.net:27017], passives=[], arbiters=[], primary='cluster0-shard-00-02.rckqz.mongodb.net:27017', tagSet=TagSet{[Tag{name='nodeType', value='ELECTABLE'}, Tag{name='provider', value='AWS'}, Tag{name='region', value='AP_SOUTH_1'}, Tag{name='workloadType', value='OPERATIONAL'}]}, electionId=null, setVersion=7, topologyVersion=TopologyVersion{processId=6379ffd165a4cc3c39988f54, counter=4}, lastWriteDate=Sun Nov 20 20:40:03 IST 2022, lastUpdateTimeNanos=17572006648463}
2022-11-20 20:40:03.108  INFO [PAYMENT-SERVICE,,] 96733 --- [cluster-ClusterId{value='637a434a90e2501a8b8f3af8', description='null'}-cluster0-shard-00-02.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Setting max set version to 7 from replica set primary cluster0-shard-00-02.rckqz.mongodb.net:27017
2022-11-20 20:40:03.109  INFO [PAYMENT-SERVICE,,] 96733 --- [cluster-ClusterId{value='637a434a90e2501a8b8f3af8', description='null'}-cluster0-shard-00-02.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Discovered replica set primary cluster0-shard-00-02.rckqz.mongodb.net:27017
2022-11-20 20:40:03.726  INFO [PAYMENT-SERVICE,,] 96733 --- [main] o.a.k.clients.admin.AdminClientConfig    : AdminClientConfig values: 
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	client.id = 
	connections.max.idle.ms = 300000
	default.api.timeout.ms = 60000
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS

2022-11-20 20:40:03.825  INFO [PAYMENT-SERVICE,,] 96733 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-20 20:40:03.825  INFO [PAYMENT-SERVICE,,] 96733 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-20 20:40:03.825  INFO [PAYMENT-SERVICE,,] 96733 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1668957003824
2022-11-20 20:40:04.071  INFO [PAYMENT-SERVICE,,] 96733 --- [kafka-admin-client-thread | adminclient-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.admin.client for adminclient-1 unregistered
2022-11-20 20:40:04.075  INFO [PAYMENT-SERVICE,,] 96733 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-20 20:40:04.075  INFO [PAYMENT-SERVICE,,] 96733 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-20 20:40:04.075  INFO [PAYMENT-SERVICE,,] 96733 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-20 20:40:04.086  INFO [PAYMENT-SERVICE,,] 96733 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8086 (http) with context path ''
2022-11-20 20:40:04.161  INFO [PAYMENT-SERVICE,,] 96733 --- [main] c.a.p.PaymentServiceApplication          : Started PaymentServiceApplication in 4.281 seconds (JVM running for 4.67)
2022-11-20 20:40:10.015  INFO [PAYMENT-SERVICE,f60837d52919ad61,f60837d52919ad61] 96733 --- [http-nio-8086-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-11-20 20:40:10.015  INFO [PAYMENT-SERVICE,f60837d52919ad61,f60837d52919ad61] 96733 --- [http-nio-8086-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-11-20 20:40:10.017  INFO [PAYMENT-SERVICE,f60837d52919ad61,f60837d52919ad61] 96733 --- [http-nio-8086-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 2 ms
2022-11-20 20:40:10.426  INFO [PAYMENT-SERVICE,f60837d52919ad61,f60837d52919ad61] 96733 --- [http-nio-8086-exec-2] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:7, serverValue:7695}] to cluster0-shard-00-02.rckqz.mongodb.net:27017
2022-11-20 20:40:10.560  INFO [PAYMENT-SERVICE,f60837d52919ad61,f60837d52919ad61] 96733 --- [http-nio-8086-exec-2] c.a.p.kafka.PaymentProducer              : Payment Event => Payment(transId=d79785d0-f1ec-4ca7-8d21-ec4f7abac32d, status=Transaction completed, orderId=null, price=0.0)
2022-11-20 20:40:10.568  INFO [PAYMENT-SERVICE,f60837d52919ad61,f60837d52919ad61] 96733 --- [http-nio-8086-exec-2] o.a.k.clients.producer.ProducerConfig    : ProducerConfig values: 
	acks = -1
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-1
	compression.type = none
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.class = class org.apache.kafka.clients.producer.internals.DefaultPartitioner
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2022-11-20 20:40:10.577  INFO [PAYMENT-SERVICE,f60837d52919ad61,f60837d52919ad61] 96733 --- [http-nio-8086-exec-2] o.a.k.clients.producer.KafkaProducer     : [Producer clientId=producer-1] Instantiated an idempotent producer.
2022-11-20 20:40:10.591  INFO [PAYMENT-SERVICE,f60837d52919ad61,f60837d52919ad61] 96733 --- [http-nio-8086-exec-2] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-20 20:40:10.592  INFO [PAYMENT-SERVICE,f60837d52919ad61,f60837d52919ad61] 96733 --- [http-nio-8086-exec-2] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-20 20:40:10.592  INFO [PAYMENT-SERVICE,f60837d52919ad61,f60837d52919ad61] 96733 --- [http-nio-8086-exec-2] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1668957010591
2022-11-20 20:40:10.599  INFO [PAYMENT-SERVICE,,] 96733 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.Metadata        : [Producer clientId=producer-1] Cluster ID: N6_RKQEzRKyebGgdHnjA8Q
2022-11-20 20:40:10.602  INFO [PAYMENT-SERVICE,,] 96733 --- [kafka-producer-network-thread | producer-1] o.a.k.c.p.internals.TransactionManager   : [Producer clientId=producer-1] ProducerId set to 2001 with epoch 0
2022-11-20 20:40:10.604  INFO [PAYMENT-SERVICE,,] 96733 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.Metadata        : [Producer clientId=producer-1] Resetting the last seen epoch of partition payment_complete-0 to 0 since the associated topicId changed from null to lXK061VOTzqVujfWi-KIWg
2022-11-20 20:40:10.611 ERROR [PAYMENT-SERVICE,f60837d52919ad61,f60837d52919ad61] 96733 --- [http-nio-8086-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is org.apache.kafka.common.errors.SerializationException: Can't convert value of class com.adirn.basemodels.models.Payment to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer] with root cause

java.lang.ClassCastException: class com.adirn.basemodels.models.Payment cannot be cast to class java.lang.String (com.adirn.basemodels.models.Payment is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:29) ~[kafka-clients-3.1.2.jar:na]
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62) ~[kafka-clients-3.1.2.jar:na]
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:954) ~[kafka-clients-3.1.2.jar:na]
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:914) ~[kafka-clients-3.1.2.jar:na]
	at brave.kafka.clients.TracingProducer.send(TracingProducer.java:129) ~[brave-instrumentation-kafka-clients-5.13.9.jar:na]
	at org.springframework.kafka.core.DefaultKafkaProducerFactory$CloseSafeProducer.send(DefaultKafkaProducerFactory.java:1087) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.core.KafkaTemplate.doSend(KafkaTemplate.java:655) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.core.KafkaTemplate.send(KafkaTemplate.java:442) ~[spring-kafka-2.8.10.jar:2.8.10]
	at com.adirn.paymentservice.kafka.PaymentProducer.sendMessage(PaymentProducer.java:33) ~[classes/:na]
	at com.adirn.paymentservice.service.PaymentService.savePayment(PaymentService.java:24) ~[classes/:na]
	at com.adirn.paymentservice.controller.PaymentController.postPayment(ProductController.java:28) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.23.jar:5.3.23]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.23.jar:5.3.23]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.23.jar:5.3.23]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.23.jar:5.3.23]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1071) ~[spring-webmvc-5.3.23.jar:5.3.23]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:964) ~[spring-webmvc-5.3.23.jar:5.3.23]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.23.jar:5.3.23]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.23.jar:5.3.23]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:696) ~[tomcat-embed-core-9.0.68.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.23.jar:5.3.23]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:779) ~[tomcat-embed-core-9.0.68.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) ~[tomcat-embed-websocket-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.23.jar:5.3.23]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.23.jar:5.3.23]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.springframework.cloud.sleuth.instrument.web.servlet.TracingFilter.doFilter(TracingFilter.java:68) ~[spring-cloud-sleuth-instrumentation-3.1.5.jar:3.1.5]
	at org.springframework.cloud.sleuth.autoconfig.instrument.web.TraceWebServletConfiguration$LazyTracingFilter.doFilter(TraceWebServletConfiguration.java:131) ~[spring-cloud-sleuth-autoconfigure-3.1.5.jar:3.1.5]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.23.jar:5.3.23]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:541) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.springframework.cloud.sleuth.instrument.web.tomcat.TraceValve.invoke(TraceValve.java:103) ~[spring-cloud-sleuth-instrumentation-3.1.5.jar:3.1.5]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:360) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1789) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]

2022-11-20 20:41:56.722  INFO [PAYMENT-SERVICE,,] 96733 --- [Thread-2] o.s.c.s.a.z.ZipkinAutoConfiguration      : Flushing remaining spans on shutdown
2022-11-20 20:41:56.743  INFO [PAYMENT-SERVICE,,] 96733 --- [SpringApplicationShutdownHook] o.a.k.clients.producer.KafkaProducer     : [Producer clientId=producer-1] Closing the Kafka producer with timeoutMillis = 30000 ms.
2022-11-20 20:41:56.746  INFO [PAYMENT-SERVICE,,] 96733 --- [SpringApplicationShutdownHook] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-20 20:41:56.746  INFO [PAYMENT-SERVICE,,] 96733 --- [SpringApplicationShutdownHook] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-20 20:41:56.746  INFO [PAYMENT-SERVICE,,] 96733 --- [SpringApplicationShutdownHook] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-20 20:41:56.746  INFO [PAYMENT-SERVICE,,] 96733 --- [SpringApplicationShutdownHook] o.a.kafka.common.utils.AppInfoParser     : App info kafka.producer for producer-1 unregistered
2022-11-20 20:42:00.111  INFO [PAYMENT-SERVICE,,] 97471 --- [main] c.a.p.PaymentServiceApplication          : Starting PaymentServiceApplication using Java 19.0.1 on aditya-ASUS-TUF-Gaming-F15-FX506LI-FX566LI with PID 97471 (/home/aditya/Downloads/Ecommerce-ordering-service/payment-service/target/classes started by aditya in /home/aditya/Downloads/Ecommerce-ordering-service)
2022-11-20 20:42:00.113  INFO [PAYMENT-SERVICE,,] 97471 --- [main] c.a.p.PaymentServiceApplication          : No active profile set, falling back to 1 default profile: "default"
2022-11-20 20:42:00.716  INFO [PAYMENT-SERVICE,,] 97471 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data MongoDB repositories in DEFAULT mode.
2022-11-20 20:42:00.747  INFO [PAYMENT-SERVICE,,] 97471 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 28 ms. Found 1 MongoDB repository interfaces.
2022-11-20 20:42:00.912  INFO [PAYMENT-SERVICE,,] 97471 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=d0402322-be04-3e01-ad61-f132a73926d8
2022-11-20 20:42:01.391  INFO [PAYMENT-SERVICE,,] 97471 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8086 (http)
2022-11-20 20:42:01.397  INFO [PAYMENT-SERVICE,,] 97471 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-20 20:42:01.398  INFO [PAYMENT-SERVICE,,] 97471 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.68]
2022-11-20 20:42:01.476  INFO [PAYMENT-SERVICE,,] 97471 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-20 20:42:01.476  INFO [PAYMENT-SERVICE,,] 97471 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1315 ms
2022-11-20 20:42:01.993  INFO [PAYMENT-SERVICE,,] 97471 --- [main] org.mongodb.driver.client                : MongoClient with metadata {"driver": {"name": "mongo-java-driver|sync|spring-boot", "version": "4.6.1"}, "os": {"type": "Linux", "name": "Linux", "architecture": "amd64", "version": "5.15.0-53-generic"}, "platform": "Java/Oracle Corporation/19.0.1+10-21"} created with settings MongoClientSettings{readPreference=primary, writeConcern=WriteConcern{w=majority, wTimeout=null ms, journal=null}, retryWrites=true, retryReads=true, readConcern=ReadConcern{level=null}, credential=MongoCredential{mechanism=null, userName='user1', source='admin', password=<hidden>, mechanismProperties=<hidden>}, streamFactoryFactory=null, commandListeners=[org.springframework.cloud.sleuth.instrument.mongodb.TraceMongoCommandListener@63e5b8aa], codecRegistry=ProvidersCodecRegistry{codecProviders=[ValueCodecProvider{}, BsonValueCodecProvider{}, DBRefCodecProvider{}, DBObjectCodecProvider{}, DocumentCodecProvider{}, IterableCodecProvider{}, MapCodecProvider{}, GeoJsonCodecProvider{}, GridFSFileCodecProvider{}, Jsr310CodecProvider{}, JsonObjectCodecProvider{}, BsonCodecProvider{}, EnumCodecProvider{}, com.mongodb.Jep395RecordCodecProvider@2c9306d3]}, clusterSettings={hosts=[127.0.0.1:27017], srvHost=cluster0.rckqz.mongodb.net, srvServiceName=mongodb, mode=MULTIPLE, requiredClusterType=REPLICA_SET, requiredReplicaSetName='atlas-tp1paz-shard-0', serverSelector='null', clusterListeners='[]', serverSelectionTimeout='30000 ms', localThreshold='30000 ms'}, socketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=0, receiveBufferSize=0, sendBufferSize=0}, heartbeatSocketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=10000, receiveBufferSize=0, sendBufferSize=0}, connectionPoolSettings=ConnectionPoolSettings{maxSize=100, minSize=0, maxWaitTimeMS=120000, maxConnectionLifeTimeMS=0, maxConnectionIdleTimeMS=0, maintenanceInitialDelayMS=0, maintenanceFrequencyMS=60000, connectionPoolListeners=[], maxConnecting=2}, serverSettings=ServerSettings{heartbeatFrequencyMS=10000, minHeartbeatFrequencyMS=500, serverListeners='[]', serverMonitorListeners='[]'}, sslSettings=SslSettings{enabled=true, invalidHostNameAllowed=false, context=null}, applicationName='null', compressorList=[], uuidRepresentation=JAVA_LEGACY, serverApi=null, autoEncryptionSettings=null, contextProvider=org.springframework.cloud.sleuth.instrument.mongodb.TraceSynchronousMongoClientSettingsBuilderCustomizer$$Lambda$687/0x0000000801451a88@4270b142}
2022-11-20 20:42:02.013  INFO [PAYMENT-SERVICE,,] 97471 --- [cluster-ClusterId{value='637a43c104b1e72cf7912cac', description='null'}-srv-cluster0.rckqz.mongodb.net] org.mongodb.driver.cluster               : Adding discovered server cluster0-shard-00-02.rckqz.mongodb.net:27017 to client view of cluster
2022-11-20 20:42:02.030  INFO [PAYMENT-SERVICE,,] 97471 --- [cluster-ClusterId{value='637a43c104b1e72cf7912cac', description='null'}-srv-cluster0.rckqz.mongodb.net] org.mongodb.driver.cluster               : Adding discovered server cluster0-shard-00-01.rckqz.mongodb.net:27017 to client view of cluster
2022-11-20 20:42:02.032  INFO [PAYMENT-SERVICE,,] 97471 --- [cluster-ClusterId{value='637a43c104b1e72cf7912cac', description='null'}-srv-cluster0.rckqz.mongodb.net] org.mongodb.driver.cluster               : Adding discovered server cluster0-shard-00-00.rckqz.mongodb.net:27017 to client view of cluster
2022-11-20 20:42:02.538  INFO [PAYMENT-SERVICE,,] 97471 --- [cluster-rtt-ClusterId{value='637a43c104b1e72cf7912cac', description='null'}-cluster0-shard-00-00.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:6, serverValue:7349}] to cluster0-shard-00-00.rckqz.mongodb.net:27017
2022-11-20 20:42:02.538  INFO [PAYMENT-SERVICE,,] 97471 --- [cluster-ClusterId{value='637a43c104b1e72cf7912cac', description='null'}-cluster0-shard-00-00.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:5, serverValue:7349}] to cluster0-shard-00-00.rckqz.mongodb.net:27017
2022-11-20 20:42:02.539  INFO [PAYMENT-SERVICE,,] 97471 --- [cluster-ClusterId{value='637a43c104b1e72cf7912cac', description='null'}-cluster0-shard-00-00.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=cluster0-shard-00-00.rckqz.mongodb.net:27017, type=REPLICA_SET_SECONDARY, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=13, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=305191534, setName='atlas-tp1paz-shard-0', canonicalAddress=cluster0-shard-00-00.rckqz.mongodb.net:27017, hosts=[cluster0-shard-00-02.rckqz.mongodb.net:27017, cluster0-shard-00-01.rckqz.mongodb.net:27017, cluster0-shard-00-00.rckqz.mongodb.net:27017], passives=[], arbiters=[], primary='cluster0-shard-00-02.rckqz.mongodb.net:27017', tagSet=TagSet{[Tag{name='nodeType', value='ELECTABLE'}, Tag{name='provider', value='AWS'}, Tag{name='region', value='AP_SOUTH_1'}, Tag{name='workloadType', value='OPERATIONAL'}]}, electionId=null, setVersion=7, topologyVersion=TopologyVersion{processId=6379ffd165a4cc3c39988f54, counter=4}, lastWriteDate=Sun Nov 20 20:42:02 IST 2022, lastUpdateTimeNanos=17691435875467}
2022-11-20 20:42:02.544  INFO [PAYMENT-SERVICE,,] 97471 --- [cluster-rtt-ClusterId{value='637a43c104b1e72cf7912cac', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:4, serverValue:6691}] to cluster0-shard-00-01.rckqz.mongodb.net:27017
2022-11-20 20:42:02.547  INFO [PAYMENT-SERVICE,,] 97471 --- [cluster-ClusterId{value='637a43c104b1e72cf7912cac', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:3, serverValue:6686}] to cluster0-shard-00-01.rckqz.mongodb.net:27017
2022-11-20 20:42:02.547  INFO [PAYMENT-SERVICE,,] 97471 --- [cluster-ClusterId{value='637a43c104b1e72cf7912cac', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=cluster0-shard-00-01.rckqz.mongodb.net:27017, type=REPLICA_SET_SECONDARY, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=13, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=311543666, setName='atlas-tp1paz-shard-0', canonicalAddress=cluster0-shard-00-01.rckqz.mongodb.net:27017, hosts=[cluster0-shard-00-02.rckqz.mongodb.net:27017, cluster0-shard-00-01.rckqz.mongodb.net:27017, cluster0-shard-00-00.rckqz.mongodb.net:27017], passives=[], arbiters=[], primary='cluster0-shard-00-02.rckqz.mongodb.net:27017', tagSet=TagSet{[Tag{name='nodeType', value='ELECTABLE'}, Tag{name='provider', value='AWS'}, Tag{name='region', value='AP_SOUTH_1'}, Tag{name='workloadType', value='OPERATIONAL'}]}, electionId=null, setVersion=7, topologyVersion=TopologyVersion{processId=637a02391f563ed75643efb8, counter=3}, lastWriteDate=Sun Nov 20 20:42:02 IST 2022, lastUpdateTimeNanos=17691445514273}
2022-11-20 20:42:02.551  INFO [PAYMENT-SERVICE,,] 97471 --- [cluster-ClusterId{value='637a43c104b1e72cf7912cac', description='null'}-cluster0-shard-00-02.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:1, serverValue:7784}] to cluster0-shard-00-02.rckqz.mongodb.net:27017
2022-11-20 20:42:02.551  INFO [PAYMENT-SERVICE,,] 97471 --- [cluster-ClusterId{value='637a43c104b1e72cf7912cac', description='null'}-cluster0-shard-00-02.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=cluster0-shard-00-02.rckqz.mongodb.net:27017, type=REPLICA_SET_PRIMARY, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=13, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=313099626, setName='atlas-tp1paz-shard-0', canonicalAddress=cluster0-shard-00-02.rckqz.mongodb.net:27017, hosts=[cluster0-shard-00-02.rckqz.mongodb.net:27017, cluster0-shard-00-01.rckqz.mongodb.net:27017, cluster0-shard-00-00.rckqz.mongodb.net:27017], passives=[], arbiters=[], primary='cluster0-shard-00-02.rckqz.mongodb.net:27017', tagSet=TagSet{[Tag{name='nodeType', value='ELECTABLE'}, Tag{name='provider', value='AWS'}, Tag{name='region', value='AP_SOUTH_1'}, Tag{name='workloadType', value='OPERATIONAL'}]}, electionId=7fffffff0000000000000142, setVersion=7, topologyVersion=TopologyVersion{processId=637a0103d8ca2976d20bdc8a, counter=6}, lastWriteDate=Sun Nov 20 20:42:02 IST 2022, lastUpdateTimeNanos=17691449446666}
2022-11-20 20:42:02.552  INFO [PAYMENT-SERVICE,,] 97471 --- [cluster-ClusterId{value='637a43c104b1e72cf7912cac', description='null'}-cluster0-shard-00-02.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Setting max election id to 7fffffff0000000000000142 from replica set primary cluster0-shard-00-02.rckqz.mongodb.net:27017
2022-11-20 20:42:02.552  INFO [PAYMENT-SERVICE,,] 97471 --- [cluster-ClusterId{value='637a43c104b1e72cf7912cac', description='null'}-cluster0-shard-00-02.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Setting max set version to 7 from replica set primary cluster0-shard-00-02.rckqz.mongodb.net:27017
2022-11-20 20:42:02.552  INFO [PAYMENT-SERVICE,,] 97471 --- [cluster-ClusterId{value='637a43c104b1e72cf7912cac', description='null'}-cluster0-shard-00-02.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Discovered replica set primary cluster0-shard-00-02.rckqz.mongodb.net:27017
2022-11-20 20:42:02.559  INFO [PAYMENT-SERVICE,,] 97471 --- [cluster-rtt-ClusterId{value='637a43c104b1e72cf7912cac', description='null'}-cluster0-shard-00-02.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:2, serverValue:7445}] to cluster0-shard-00-02.rckqz.mongodb.net:27017
2022-11-20 20:42:03.279  INFO [PAYMENT-SERVICE,,] 97471 --- [main] o.a.k.clients.admin.AdminClientConfig    : AdminClientConfig values: 
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	client.id = 
	connections.max.idle.ms = 300000
	default.api.timeout.ms = 60000
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS

2022-11-20 20:42:03.416  INFO [PAYMENT-SERVICE,,] 97471 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-20 20:42:03.417  INFO [PAYMENT-SERVICE,,] 97471 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-20 20:42:03.417  INFO [PAYMENT-SERVICE,,] 97471 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1668957123415
2022-11-20 20:42:03.674  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-admin-client-thread | adminclient-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.admin.client for adminclient-1 unregistered
2022-11-20 20:42:03.678  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-20 20:42:03.679  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-20 20:42:03.679  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-20 20:42:03.691  INFO [PAYMENT-SERVICE,,] 97471 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8086 (http) with context path ''
2022-11-20 20:42:03.731  INFO [PAYMENT-SERVICE,,] 97471 --- [main] c.a.p.PaymentServiceApplication          : Started PaymentServiceApplication in 4.04 seconds (JVM running for 4.446)
2022-11-20 20:42:16.221  INFO [PAYMENT-SERVICE,3aaed9c873a2b0f0,3aaed9c873a2b0f0] 97471 --- [http-nio-8086-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-11-20 20:42:16.222  INFO [PAYMENT-SERVICE,3aaed9c873a2b0f0,3aaed9c873a2b0f0] 97471 --- [http-nio-8086-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-11-20 20:42:16.223  INFO [PAYMENT-SERVICE,3aaed9c873a2b0f0,3aaed9c873a2b0f0] 97471 --- [http-nio-8086-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2022-11-20 20:42:16.599  INFO [PAYMENT-SERVICE,3aaed9c873a2b0f0,3aaed9c873a2b0f0] 97471 --- [http-nio-8086-exec-2] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:7, serverValue:7750}] to cluster0-shard-00-02.rckqz.mongodb.net:27017
2022-11-20 20:42:16.678  INFO [PAYMENT-SERVICE,3aaed9c873a2b0f0,3aaed9c873a2b0f0] 97471 --- [http-nio-8086-exec-2] c.a.p.kafka.PaymentProducer              : Payment Event => Payment(transId=40fcde34-a61c-46a2-ac2e-9b5acc4afd4f, status=Transaction completed, orderId=null, price=0.0)
2022-11-20 20:42:16.686  INFO [PAYMENT-SERVICE,3aaed9c873a2b0f0,3aaed9c873a2b0f0] 97471 --- [http-nio-8086-exec-2] o.a.k.clients.producer.ProducerConfig    : ProducerConfig values: 
	acks = -1
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-1
	compression.type = none
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.class = class org.apache.kafka.clients.producer.internals.DefaultPartitioner
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2022-11-20 20:42:16.699  INFO [PAYMENT-SERVICE,3aaed9c873a2b0f0,3aaed9c873a2b0f0] 97471 --- [http-nio-8086-exec-2] o.a.k.clients.producer.KafkaProducer     : [Producer clientId=producer-1] Instantiated an idempotent producer.
2022-11-20 20:42:16.712  INFO [PAYMENT-SERVICE,3aaed9c873a2b0f0,3aaed9c873a2b0f0] 97471 --- [http-nio-8086-exec-2] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-20 20:42:16.712  INFO [PAYMENT-SERVICE,3aaed9c873a2b0f0,3aaed9c873a2b0f0] 97471 --- [http-nio-8086-exec-2] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-20 20:42:16.712  INFO [PAYMENT-SERVICE,3aaed9c873a2b0f0,3aaed9c873a2b0f0] 97471 --- [http-nio-8086-exec-2] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1668957136711
2022-11-20 20:42:16.722  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.Metadata        : [Producer clientId=producer-1] Cluster ID: N6_RKQEzRKyebGgdHnjA8Q
2022-11-20 20:42:16.723  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] o.a.k.c.p.internals.TransactionManager   : [Producer clientId=producer-1] ProducerId set to 2002 with epoch 0
2022-11-20 20:42:16.730  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.Metadata        : [Producer clientId=producer-1] Resetting the last seen epoch of partition payment_complete-0 to 0 since the associated topicId changed from null to lXK061VOTzqVujfWi-KIWg
2022-11-20 20:42:17.055  INFO [EMAIL-SERVICE,3aaed9c873a2b0f0,4e73eaf71867bb43] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => Payment(transId=40fcde34-a61c-46a2-ac2e-9b5acc4afd4f, status=Transaction completed, orderId=null, price=0.0)
2022-11-20 20:42:18.588  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Seeking to offset 0 for partition payment_complete-0
2022-11-20 20:42:18.601 ERROR [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:18.439+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:18.439+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:18.439+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:18.439+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:18.439+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:117) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:168) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:122) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:819) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:777) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:732) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.getForEntity(RestTemplate.java:370) ~[spring-web-5.3.23.jar:5.3.23]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:52) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$4a958919.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-20 20:42:18.612  INFO [EMAIL-SERVICE,3aaed9c873a2b0f0,640f784bd91dc786] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => Payment(transId=40fcde34-a61c-46a2-ac2e-9b5acc4afd4f, status=Transaction completed, orderId=null, price=0.0)
2022-11-20 20:42:18.636  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Seeking to offset 0 for partition payment_complete-0
2022-11-20 20:42:18.638 ERROR [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:18.621+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:18.621+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:18.621+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:18.621+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:18.621+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:117) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:168) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:122) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:819) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:777) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:732) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.getForEntity(RestTemplate.java:370) ~[spring-web-5.3.23.jar:5.3.23]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:52) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$4a958919.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-20 20:42:19.118  INFO [EMAIL-SERVICE,3aaed9c873a2b0f0,2f074745555d235a] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => Payment(transId=40fcde34-a61c-46a2-ac2e-9b5acc4afd4f, status=Transaction completed, orderId=null, price=0.0)
2022-11-20 20:42:19.138  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Seeking to offset 0 for partition payment_complete-0
2022-11-20 20:42:19.139 ERROR [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:19.124+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:19.124+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:19.124+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:19.124+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:19.124+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:117) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:168) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:122) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:819) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:777) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:732) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.getForEntity(RestTemplate.java:370) ~[spring-web-5.3.23.jar:5.3.23]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:52) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$4a958919.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-20 20:42:19.621  INFO [EMAIL-SERVICE,3aaed9c873a2b0f0,b3a94998e3add69f] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => Payment(transId=40fcde34-a61c-46a2-ac2e-9b5acc4afd4f, status=Transaction completed, orderId=null, price=0.0)
2022-11-20 20:42:19.645  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Seeking to offset 0 for partition payment_complete-0
2022-11-20 20:42:19.647 ERROR [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:19.630+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:19.630+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:19.630+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:19.630+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:19.630+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:117) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:168) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:122) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:819) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:777) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:732) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.getForEntity(RestTemplate.java:370) ~[spring-web-5.3.23.jar:5.3.23]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:52) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$4a958919.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-20 20:42:20.123  INFO [EMAIL-SERVICE,3aaed9c873a2b0f0,609ee59f02ebbb82] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => Payment(transId=40fcde34-a61c-46a2-ac2e-9b5acc4afd4f, status=Transaction completed, orderId=null, price=0.0)
2022-11-20 20:42:20.147  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Seeking to offset 0 for partition payment_complete-0
2022-11-20 20:42:20.148 ERROR [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:20.132+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:20.132+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:20.132+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:20.132+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:20.132+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:117) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:168) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:122) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:819) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:777) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:732) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.getForEntity(RestTemplate.java:370) ~[spring-web-5.3.23.jar:5.3.23]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:52) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$4a958919.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-20 20:42:20.625  INFO [EMAIL-SERVICE,3aaed9c873a2b0f0,85467ee7373d793d] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => Payment(transId=40fcde34-a61c-46a2-ac2e-9b5acc4afd4f, status=Transaction completed, orderId=null, price=0.0)
2022-11-20 20:42:20.647  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Seeking to offset 0 for partition payment_complete-0
2022-11-20 20:42:20.649 ERROR [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:20.634+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:20.634+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:20.634+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:20.634+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:20.634+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:117) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:168) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:122) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:819) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:777) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:732) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.getForEntity(RestTemplate.java:370) ~[spring-web-5.3.23.jar:5.3.23]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:52) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$4a958919.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-20 20:42:21.127  INFO [EMAIL-SERVICE,3aaed9c873a2b0f0,8aa96b10981a87a7] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => Payment(transId=40fcde34-a61c-46a2-ac2e-9b5acc4afd4f, status=Transaction completed, orderId=null, price=0.0)
2022-11-20 20:42:21.147  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Seeking to offset 0 for partition payment_complete-0
2022-11-20 20:42:21.148 ERROR [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:21.133+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:21.133+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:21.133+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:21.133+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:21.133+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:117) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:168) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:122) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:819) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:777) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:732) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.getForEntity(RestTemplate.java:370) ~[spring-web-5.3.23.jar:5.3.23]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:52) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$4a958919.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-20 20:42:21.634  INFO [EMAIL-SERVICE,3aaed9c873a2b0f0,4d2b5b2ddfba7449] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => Payment(transId=40fcde34-a61c-46a2-ac2e-9b5acc4afd4f, status=Transaction completed, orderId=null, price=0.0)
2022-11-20 20:42:21.661  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Seeking to offset 0 for partition payment_complete-0
2022-11-20 20:42:21.664 ERROR [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:21.645+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:21.645+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:21.645+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:21.645+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:21.645+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:117) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:168) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:122) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:819) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:777) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:732) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.getForEntity(RestTemplate.java:370) ~[spring-web-5.3.23.jar:5.3.23]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:52) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$4a958919.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-20 20:42:22.137  INFO [EMAIL-SERVICE,3aaed9c873a2b0f0,212fcac4d9decf21] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => Payment(transId=40fcde34-a61c-46a2-ac2e-9b5acc4afd4f, status=Transaction completed, orderId=null, price=0.0)
2022-11-20 20:42:22.158  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Seeking to offset 0 for partition payment_complete-0
2022-11-20 20:42:22.159 ERROR [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:22.144+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:22.144+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:22.144+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:22.144+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:22.144+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:117) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:168) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:122) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:819) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:777) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:732) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.getForEntity(RestTemplate.java:370) ~[spring-web-5.3.23.jar:5.3.23]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:52) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$4a958919.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-20 20:42:22.638  INFO [EMAIL-SERVICE,3aaed9c873a2b0f0,7ef84768f1db4bef] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => Payment(transId=40fcde34-a61c-46a2-ac2e-9b5acc4afd4f, status=Transaction completed, orderId=null, price=0.0)
2022-11-20 20:42:22.654 ERROR [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.kafka.listener.DefaultErrorHandler   : Backoff FixedBackOff{interval=0, currentAttempts=10, maxAttempts=9} exhausted for payment_complete-0@0

org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:22.647+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"; nested exception is org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:22.647+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.web.client.HttpClientErrorException$MethodNotAllowed: 405 : "{"timestamp":"2022-11-20T15:12:22.647+00:00","status":405,"error":"Method Not Allowed","path":"/orders/customer/"}"
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:117) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:168) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:122) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:819) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:777) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:732) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.getForEntity(RestTemplate.java:370) ~[spring-web-5.3.23.jar:5.3.23]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:52) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$4a958919.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-20 20:48:59.739  INFO [PAYMENT-SERVICE,2bae89663003bb13,2bae89663003bb13] 97471 --- [http-nio-8086-exec-5] c.a.p.kafka.PaymentProducer              : Payment Event => Payment(transId=183b6caf-8ebc-4a7e-baf2-f3533c4afb96, status=Transaction completed, orderId=6207d1c3-6e8e-42a1-b87e-b651d94bad6d, price=0.0)
2022-11-20 20:49:00.076  INFO [EMAIL-SERVICE,2bae89663003bb13,3a47fa60061403fe] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => Payment(transId=183b6caf-8ebc-4a7e-baf2-f3533c4afb96, status=Transaction completed, orderId=6207d1c3-6e8e-42a1-b87e-b651d94bad6d, price=0.0)
2022-11-20 20:49:00.187  INFO [EMAIL-SERVICE,2bae89663003bb13,3a47fa60061403fe] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Send reciept to customer => %s
2022-11-20 20:49:41.140  INFO [EMAIL-SERVICE,,] 88980 --- [Thread-2] o.s.c.s.a.z.ZipkinAutoConfiguration      : Flushing remaining spans on shutdown
2022-11-20 20:49:41.593  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Revoke previously assigned partitions customer_topic-0
2022-11-20 20:49:41.593  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Revoke previously assigned partitions payment_complete-0
2022-11-20 20:49:41.597  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions revoked: [customer_topic-0]
2022-11-20 20:49:41.598  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions revoked: [payment_complete-0]
2022-11-20 20:49:41.602  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Revoke previously assigned partitions order_topics-0
2022-11-20 20:49:41.603  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions revoked: [order_topics-0]
2022-11-20 20:49:41.608  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Member consumer-email-1-c8ae66a0-0f6b-497b-be13-93018ea08fc8 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2022-11-20 20:49:41.611  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Member consumer-email-3-5abe7b14-a077-4c2a-ac22-8be5771f8c09 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2022-11-20 20:49:41.612  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-20 20:49:41.612  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-20 20:49:41.612  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-20 20:49:41.612  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-20 20:49:41.613  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-1, groupId=email] Unsubscribed all topics or patterns and assigned partitions
2022-11-20 20:49:41.612  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Unsubscribed all topics or patterns and assigned partitions
2022-11-20 20:49:41.623  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Member consumer-email-2-2aa210e8-9092-4f47-901c-f61ec8d5ae3a sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2022-11-20 20:49:41.631  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-20 20:49:41.631  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-20 20:49:41.631  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-20 20:49:41.631  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-2, groupId=email] Unsubscribed all topics or patterns and assigned partitions
2022-11-20 20:49:41.631  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-20 20:49:41.631  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-20 20:49:41.632  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-20 20:49:41.632  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-20 20:49:41.632  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-20 20:49:41.668  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-20 20:49:41.668  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-20 20:49:41.669  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-20 20:49:41.668  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-20 20:49:41.669  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-20 20:49:41.668  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-20 20:49:41.669  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-20 20:49:41.669  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-20 20:49:41.670  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-20 20:49:41.697  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-email-1 unregistered
2022-11-20 20:49:41.699  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-email-2 unregistered
2022-11-20 20:49:41.699  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-email-3 unregistered
2022-11-20 20:49:41.700  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: Consumer stopped
2022-11-20 20:49:41.700  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: Consumer stopped
2022-11-20 20:49:41.702  INFO [EMAIL-SERVICE,,] 88980 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: Consumer stopped
2022-11-20 20:49:46.905  INFO [EMAIL-SERVICE,,] 100084 --- [main] c.a.e.EmailServiceApplication            : Starting EmailServiceApplication using Java 19.0.1 on aditya-ASUS-TUF-Gaming-F15-FX506LI-FX566LI with PID 100084 (/home/aditya/Downloads/Ecommerce-ordering-service/email-service/target/classes started by aditya in /home/aditya/Downloads/Ecommerce-ordering-service)
2022-11-20 20:49:46.908  INFO [EMAIL-SERVICE,,] 100084 --- [main] c.a.e.EmailServiceApplication            : No active profile set, falling back to 1 default profile: "default"
2022-11-20 20:49:47.625  INFO [EMAIL-SERVICE,,] 100084 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data MongoDB repositories in DEFAULT mode.
2022-11-20 20:49:47.634  INFO [EMAIL-SERVICE,,] 100084 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 4 ms. Found 0 MongoDB repository interfaces.
2022-11-20 20:49:47.772  INFO [EMAIL-SERVICE,,] 100084 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=d620a4fc-e5f9-3ec2-ab20-28674c7b93cf
2022-11-20 20:49:48.228  INFO [EMAIL-SERVICE,,] 100084 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8084 (http)
2022-11-20 20:49:48.236  INFO [EMAIL-SERVICE,,] 100084 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-20 20:49:48.236  INFO [EMAIL-SERVICE,,] 100084 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.68]
2022-11-20 20:49:48.323  INFO [EMAIL-SERVICE,,] 100084 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-20 20:49:48.324  INFO [EMAIL-SERVICE,,] 100084 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1363 ms
2022-11-20 20:49:49.319  INFO [EMAIL-SERVICE,,] 100084 --- [cluster-ClusterId{value='637a4595053cfc13b6536e7c', description='null'}-localhost:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server localhost:27017

com.mongodb.MongoSocketOpenException: Exception opening socket
	at com.mongodb.internal.connection.SocketStream.open(SocketStream.java:70) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.InternalStreamConnection.open(InternalStreamConnection.java:180) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:193) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:157) ~[mongodb-driver-core-4.6.1.jar:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:535) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:585) ~[na:na]
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:666) ~[na:na]
	at com.mongodb.internal.connection.SocketStreamHelper.initialize(SocketStreamHelper.java:107) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.SocketStream.initializeSocket(SocketStream.java:79) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.SocketStream.open(SocketStream.java:65) ~[mongodb-driver-core-4.6.1.jar:na]
	... 4 common frames omitted

2022-11-20 20:49:49.322  INFO [EMAIL-SERVICE,,] 100084 --- [main] org.mongodb.driver.client                : MongoClient with metadata {"driver": {"name": "mongo-java-driver|sync|spring-boot", "version": "4.6.1"}, "os": {"type": "Linux", "name": "Linux", "architecture": "amd64", "version": "5.15.0-53-generic"}, "platform": "Java/Oracle Corporation/19.0.1+10-21"} created with settings MongoClientSettings{readPreference=primary, writeConcern=WriteConcern{w=null, wTimeout=null ms, journal=null}, retryWrites=true, retryReads=true, readConcern=ReadConcern{level=null}, credential=null, streamFactoryFactory=null, commandListeners=[org.springframework.cloud.sleuth.instrument.mongodb.TraceMongoCommandListener@3cd46491], codecRegistry=ProvidersCodecRegistry{codecProviders=[ValueCodecProvider{}, BsonValueCodecProvider{}, DBRefCodecProvider{}, DBObjectCodecProvider{}, DocumentCodecProvider{}, IterableCodecProvider{}, MapCodecProvider{}, GeoJsonCodecProvider{}, GridFSFileCodecProvider{}, Jsr310CodecProvider{}, JsonObjectCodecProvider{}, BsonCodecProvider{}, EnumCodecProvider{}, com.mongodb.Jep395RecordCodecProvider@27d98bef]}, clusterSettings={hosts=[localhost:27017], srvServiceName=mongodb, mode=SINGLE, requiredClusterType=UNKNOWN, requiredReplicaSetName='null', serverSelector='null', clusterListeners='[]', serverSelectionTimeout='30000 ms', localThreshold='30000 ms'}, socketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=0, receiveBufferSize=0, sendBufferSize=0}, heartbeatSocketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=10000, receiveBufferSize=0, sendBufferSize=0}, connectionPoolSettings=ConnectionPoolSettings{maxSize=100, minSize=0, maxWaitTimeMS=120000, maxConnectionLifeTimeMS=0, maxConnectionIdleTimeMS=0, maintenanceInitialDelayMS=0, maintenanceFrequencyMS=60000, connectionPoolListeners=[], maxConnecting=2}, serverSettings=ServerSettings{heartbeatFrequencyMS=10000, minHeartbeatFrequencyMS=500, serverListeners='[]', serverMonitorListeners='[]'}, sslSettings=SslSettings{enabled=false, invalidHostNameAllowed=false, context=null}, applicationName='null', compressorList=[], uuidRepresentation=JAVA_LEGACY, serverApi=null, autoEncryptionSettings=null, contextProvider=org.springframework.cloud.sleuth.instrument.mongodb.TraceSynchronousMongoClientSettingsBuilderCustomizer$$Lambda$836/0x00000008014a7208@349312d5}
2022-11-20 20:49:49.901  INFO [EMAIL-SERVICE,,] 100084 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-email-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = email
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2022-11-20 20:49:50.027  INFO [EMAIL-SERVICE,,] 100084 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-20 20:49:50.028  INFO [EMAIL-SERVICE,,] 100084 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-20 20:49:50.028  INFO [EMAIL-SERVICE,,] 100084 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1668957590026
2022-11-20 20:49:50.030  INFO [EMAIL-SERVICE,,] 100084 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-1, groupId=email] Subscribed to topic(s): order_topics
2022-11-20 20:49:50.036  INFO [EMAIL-SERVICE,,] 100084 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-email-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = email
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2022-11-20 20:49:50.041  INFO [EMAIL-SERVICE,,] 100084 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-20 20:49:50.041  INFO [EMAIL-SERVICE,,] 100084 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-20 20:49:50.041  INFO [EMAIL-SERVICE,,] 100084 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1668957590041
2022-11-20 20:49:50.042  INFO [EMAIL-SERVICE,,] 100084 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-2, groupId=email] Subscribed to topic(s): customer_topic
2022-11-20 20:49:50.043  INFO [EMAIL-SERVICE,,] 100084 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-email-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = email
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2022-11-20 20:49:50.051  INFO [EMAIL-SERVICE,,] 100084 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-20 20:49:50.051  INFO [EMAIL-SERVICE,,] 100084 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-20 20:49:50.051  INFO [EMAIL-SERVICE,,] 100084 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1668957590051
2022-11-20 20:49:50.051  INFO [EMAIL-SERVICE,,] 100084 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Subscribed to topic(s): payment_complete
2022-11-20 20:49:50.062  INFO [EMAIL-SERVICE,,] 100084 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8084 (http) with context path ''
2022-11-20 20:49:50.107  INFO [EMAIL-SERVICE,,] 100084 --- [main] c.a.e.EmailServiceApplication            : Started EmailServiceApplication in 3.675 seconds (JVM running for 4.021)
2022-11-20 20:49:50.302  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-3, groupId=email] Resetting the last seen epoch of partition payment_complete-0 to 0 since the associated topicId changed from null to lXK061VOTzqVujfWi-KIWg
2022-11-20 20:49:50.302  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-2, groupId=email] Resetting the last seen epoch of partition customer_topic-0 to 0 since the associated topicId changed from null to tKr50QVbTM2_exfwcWm5Og
2022-11-20 20:49:50.302  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-1, groupId=email] Resetting the last seen epoch of partition order_topics-0 to 0 since the associated topicId changed from null to WFpyU0BqR5-w7pCovYKThg
2022-11-20 20:49:50.304  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-3, groupId=email] Cluster ID: N6_RKQEzRKyebGgdHnjA8Q
2022-11-20 20:49:50.304  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-1, groupId=email] Cluster ID: N6_RKQEzRKyebGgdHnjA8Q
2022-11-20 20:49:50.304  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-2, groupId=email] Cluster ID: N6_RKQEzRKyebGgdHnjA8Q
2022-11-20 20:49:50.321  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-20 20:49:50.321  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-20 20:49:50.324  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-20 20:49:50.325  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] (Re-)joining group
2022-11-20 20:49:50.327  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] (Re-)joining group
2022-11-20 20:49:50.333  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] (Re-)joining group
2022-11-20 20:49:50.368  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Request joining group due to: need to re-join with the given member-id
2022-11-20 20:49:50.370  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] (Re-)joining group
2022-11-20 20:49:50.371  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Request joining group due to: need to re-join with the given member-id
2022-11-20 20:49:50.371  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Request joining group due to: need to re-join with the given member-id
2022-11-20 20:49:50.371  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] (Re-)joining group
2022-11-20 20:49:50.371  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] (Re-)joining group
2022-11-20 20:49:53.396  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Successfully joined group with generation Generation{generationId=6, memberId='consumer-email-3-75cecbce-e1e9-4dd5-9327-34b248cbd4d8', protocol='range'}
2022-11-20 20:49:53.397  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Successfully joined group with generation Generation{generationId=6, memberId='consumer-email-2-9fc15be2-0d23-42fb-8eb3-6c5cc49bfe93', protocol='range'}
2022-11-20 20:49:53.396  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Successfully joined group with generation Generation{generationId=6, memberId='consumer-email-1-e0546fc5-3e38-42ce-a2ee-54f33bd04a62', protocol='range'}
2022-11-20 20:49:53.411  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-3, groupId=email] Resetting the last seen epoch of partition order_topics-0 to 0 since the associated topicId changed from null to WFpyU0BqR5-w7pCovYKThg
2022-11-20 20:49:53.412  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-3, groupId=email] Resetting the last seen epoch of partition customer_topic-0 to 0 since the associated topicId changed from null to tKr50QVbTM2_exfwcWm5Og
2022-11-20 20:49:53.417  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Finished assignment for group at generation 6: {consumer-email-1-e0546fc5-3e38-42ce-a2ee-54f33bd04a62=Assignment(partitions=[order_topics-0]), consumer-email-3-75cecbce-e1e9-4dd5-9327-34b248cbd4d8=Assignment(partitions=[payment_complete-0]), consumer-email-2-9fc15be2-0d23-42fb-8eb3-6c5cc49bfe93=Assignment(partitions=[customer_topic-0])}
2022-11-20 20:49:53.432  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Successfully synced group in generation Generation{generationId=6, memberId='consumer-email-1-e0546fc5-3e38-42ce-a2ee-54f33bd04a62', protocol='range'}
2022-11-20 20:49:53.432  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Successfully synced group in generation Generation{generationId=6, memberId='consumer-email-2-9fc15be2-0d23-42fb-8eb3-6c5cc49bfe93', protocol='range'}
2022-11-20 20:49:53.432  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Successfully synced group in generation Generation{generationId=6, memberId='consumer-email-3-75cecbce-e1e9-4dd5-9327-34b248cbd4d8', protocol='range'}
2022-11-20 20:49:53.433  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Notifying assignor about the new Assignment(partitions=[order_topics-0])
2022-11-20 20:49:53.433  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Notifying assignor about the new Assignment(partitions=[payment_complete-0])
2022-11-20 20:49:53.433  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Notifying assignor about the new Assignment(partitions=[customer_topic-0])
2022-11-20 20:49:53.436  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Adding newly assigned partitions: payment_complete-0
2022-11-20 20:49:53.436  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Adding newly assigned partitions: order_topics-0
2022-11-20 20:49:53.436  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Adding newly assigned partitions: customer_topic-0
2022-11-20 20:49:53.452  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Found no committed offset for partition customer_topic-0
2022-11-20 20:49:53.453  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Setting offset for partition order_topics-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2022-11-20 20:49:53.453  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Setting offset for partition payment_complete-0 to the committed offset FetchPosition{offset=2, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2022-11-20 20:49:53.453  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions assigned: [order_topics-0]
2022-11-20 20:49:53.453  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions assigned: [payment_complete-0]
2022-11-20 20:49:53.468  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.SubscriptionState    : [Consumer clientId=consumer-email-2, groupId=email] Resetting offset for partition customer_topic-0 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}.
2022-11-20 20:49:53.468  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions assigned: [customer_topic-0]
2022-11-20 20:51:30.156  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node -1 disconnected.
2022-11-20 20:51:31.920  INFO [EMAIL-SERVICE,a59217b62ee3725e,4236dcf8249424c0] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => OrderEvent(status=PENDING, message=Complete the payment, customer=Customer(id=2, name=testuser, email=adebc@gamil.com, age=36), order=Order(id=dc2d58ee-684e-4148-af46-830979edb0c6, cid=2, pid=1, qty=2), product=Product(id=1, name=mobile, price=10000.0, qtyavail=10))
2022-11-20 20:51:52.791  INFO [PAYMENT-SERVICE,3fe39bd3c2c2f222,3fe39bd3c2c2f222] 97471 --- [http-nio-8086-exec-8] c.a.p.kafka.PaymentProducer              : Payment Event => Payment(transId=081bb0c5-933b-42b4-a9da-8655e6e0f43c, status=Transaction completed, orderId=dc2d58ee-684e-4148-af46-830979edb0c6, price=0.0)
2022-11-20 20:51:52.831  INFO [EMAIL-SERVICE,3fe39bd3c2c2f222,d14fe696fe06c2ef] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => Payment(transId=081bb0c5-933b-42b4-a9da-8655e6e0f43c, status=Transaction completed, orderId=dc2d58ee-684e-4148-af46-830979edb0c6, price=0.0)
2022-11-20 20:51:53.095  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Seeking to offset 2 for partition payment_complete-0
2022-11-20 20:51:53.097 ERROR [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: java.util.MissingFormatArgumentException: Format specifier '%s'
	at java.base/java.util.Formatter.format(Formatter.java:2780) ~[na:na]
	at java.base/java.util.Formatter.format(Formatter.java:2717) ~[na:na]
	at java.base/java.lang.String.format(String.java:4150) ~[na:na]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:54) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$3ec02161.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-20 20:51:53.333  INFO [EMAIL-SERVICE,3fe39bd3c2c2f222,d2536e887d748774] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => Payment(transId=081bb0c5-933b-42b4-a9da-8655e6e0f43c, status=Transaction completed, orderId=dc2d58ee-684e-4148-af46-830979edb0c6, price=0.0)
2022-11-20 20:51:53.382  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Seeking to offset 2 for partition payment_complete-0
2022-11-20 20:51:53.383 ERROR [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: java.util.MissingFormatArgumentException: Format specifier '%s'
	at java.base/java.util.Formatter.format(Formatter.java:2780) ~[na:na]
	at java.base/java.util.Formatter.format(Formatter.java:2717) ~[na:na]
	at java.base/java.lang.String.format(String.java:4150) ~[na:na]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:54) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$3ec02161.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-20 20:51:53.838  INFO [EMAIL-SERVICE,3fe39bd3c2c2f222,6aaf5fc251725c21] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => Payment(transId=081bb0c5-933b-42b4-a9da-8655e6e0f43c, status=Transaction completed, orderId=dc2d58ee-684e-4148-af46-830979edb0c6, price=0.0)
2022-11-20 20:51:53.880  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Seeking to offset 2 for partition payment_complete-0
2022-11-20 20:51:53.881 ERROR [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: java.util.MissingFormatArgumentException: Format specifier '%s'
	at java.base/java.util.Formatter.format(Formatter.java:2780) ~[na:na]
	at java.base/java.util.Formatter.format(Formatter.java:2717) ~[na:na]
	at java.base/java.lang.String.format(String.java:4150) ~[na:na]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:54) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$3ec02161.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-20 20:51:54.340  INFO [EMAIL-SERVICE,3fe39bd3c2c2f222,28cb1cac9df0bf7c] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => Payment(transId=081bb0c5-933b-42b4-a9da-8655e6e0f43c, status=Transaction completed, orderId=dc2d58ee-684e-4148-af46-830979edb0c6, price=0.0)
2022-11-20 20:51:54.371  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Seeking to offset 2 for partition payment_complete-0
2022-11-20 20:51:54.371 ERROR [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: java.util.MissingFormatArgumentException: Format specifier '%s'
	at java.base/java.util.Formatter.format(Formatter.java:2780) ~[na:na]
	at java.base/java.util.Formatter.format(Formatter.java:2717) ~[na:na]
	at java.base/java.lang.String.format(String.java:4150) ~[na:na]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:54) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$3ec02161.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-20 20:51:54.846  INFO [EMAIL-SERVICE,3fe39bd3c2c2f222,90f7479ed563735f] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => Payment(transId=081bb0c5-933b-42b4-a9da-8655e6e0f43c, status=Transaction completed, orderId=dc2d58ee-684e-4148-af46-830979edb0c6, price=0.0)
2022-11-20 20:51:54.887  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Seeking to offset 2 for partition payment_complete-0
2022-11-20 20:51:54.889 ERROR [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: java.util.MissingFormatArgumentException: Format specifier '%s'
	at java.base/java.util.Formatter.format(Formatter.java:2780) ~[na:na]
	at java.base/java.util.Formatter.format(Formatter.java:2717) ~[na:na]
	at java.base/java.lang.String.format(String.java:4150) ~[na:na]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:54) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$3ec02161.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-20 20:51:55.354  INFO [EMAIL-SERVICE,3fe39bd3c2c2f222,bc65e5eba8632360] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => Payment(transId=081bb0c5-933b-42b4-a9da-8655e6e0f43c, status=Transaction completed, orderId=dc2d58ee-684e-4148-af46-830979edb0c6, price=0.0)
2022-11-20 20:51:55.396  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Seeking to offset 2 for partition payment_complete-0
2022-11-20 20:51:55.396 ERROR [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: java.util.MissingFormatArgumentException: Format specifier '%s'
	at java.base/java.util.Formatter.format(Formatter.java:2780) ~[na:na]
	at java.base/java.util.Formatter.format(Formatter.java:2717) ~[na:na]
	at java.base/java.lang.String.format(String.java:4150) ~[na:na]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:54) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$3ec02161.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-20 20:51:55.859  INFO [EMAIL-SERVICE,3fe39bd3c2c2f222,339ffd1355922770] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => Payment(transId=081bb0c5-933b-42b4-a9da-8655e6e0f43c, status=Transaction completed, orderId=dc2d58ee-684e-4148-af46-830979edb0c6, price=0.0)
2022-11-20 20:51:55.921  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Seeking to offset 2 for partition payment_complete-0
2022-11-20 20:51:55.921 ERROR [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: java.util.MissingFormatArgumentException: Format specifier '%s'
	at java.base/java.util.Formatter.format(Formatter.java:2780) ~[na:na]
	at java.base/java.util.Formatter.format(Formatter.java:2717) ~[na:na]
	at java.base/java.lang.String.format(String.java:4150) ~[na:na]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:54) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$3ec02161.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-20 20:51:56.362  INFO [EMAIL-SERVICE,3fe39bd3c2c2f222,a7f103e2c66bd267] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => Payment(transId=081bb0c5-933b-42b4-a9da-8655e6e0f43c, status=Transaction completed, orderId=dc2d58ee-684e-4148-af46-830979edb0c6, price=0.0)
2022-11-20 20:51:56.389  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Seeking to offset 2 for partition payment_complete-0
2022-11-20 20:51:56.390 ERROR [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: java.util.MissingFormatArgumentException: Format specifier '%s'
	at java.base/java.util.Formatter.format(Formatter.java:2780) ~[na:na]
	at java.base/java.util.Formatter.format(Formatter.java:2717) ~[na:na]
	at java.base/java.lang.String.format(String.java:4150) ~[na:na]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:54) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$3ec02161.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-20 20:51:56.866  INFO [EMAIL-SERVICE,3fe39bd3c2c2f222,c87bc67e96fdcb4b] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => Payment(transId=081bb0c5-933b-42b4-a9da-8655e6e0f43c, status=Transaction completed, orderId=dc2d58ee-684e-4148-af46-830979edb0c6, price=0.0)
2022-11-20 20:51:56.890  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Seeking to offset 2 for partition payment_complete-0
2022-11-20 20:51:56.890 ERROR [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: java.util.MissingFormatArgumentException: Format specifier '%s'
	at java.base/java.util.Formatter.format(Formatter.java:2780) ~[na:na]
	at java.base/java.util.Formatter.format(Formatter.java:2717) ~[na:na]
	at java.base/java.lang.String.format(String.java:4150) ~[na:na]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:54) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$3ec02161.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-20 20:51:57.369  INFO [EMAIL-SERVICE,3fe39bd3c2c2f222,ecc7eb61a1e26cae] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => Payment(transId=081bb0c5-933b-42b4-a9da-8655e6e0f43c, status=Transaction completed, orderId=dc2d58ee-684e-4148-af46-830979edb0c6, price=0.0)
2022-11-20 20:51:57.382 ERROR [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.kafka.listener.DefaultErrorHandler   : Backoff FixedBackOff{interval=0, currentAttempts=10, maxAttempts=9} exhausted for payment_complete-0@2

org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'; nested exception is java.util.MissingFormatArgumentException: Format specifier '%s'
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: java.util.MissingFormatArgumentException: Format specifier '%s'
	at java.base/java.util.Formatter.format(Formatter.java:2780) ~[na:na]
	at java.base/java.util.Formatter.format(Formatter.java:2717) ~[na:na]
	at java.base/java.lang.String.format(String.java:4150) ~[na:na]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:54) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$3ec02161.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-20 20:52:56.122  INFO [EMAIL-SERVICE,,] 100084 --- [Thread-2] o.s.c.s.a.z.ZipkinAutoConfiguration      : Flushing remaining spans on shutdown
2022-11-20 20:52:56.148  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Revoke previously assigned partitions customer_topic-0
2022-11-20 20:52:56.148  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Revoke previously assigned partitions order_topics-0
2022-11-20 20:52:56.148  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Revoke previously assigned partitions payment_complete-0
2022-11-20 20:52:56.149  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions revoked: [order_topics-0]
2022-11-20 20:52:56.149  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions revoked: [payment_complete-0]
2022-11-20 20:52:56.149  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions revoked: [customer_topic-0]
2022-11-20 20:52:56.150  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Member consumer-email-1-e0546fc5-3e38-42ce-a2ee-54f33bd04a62 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2022-11-20 20:52:56.150  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Member consumer-email-3-75cecbce-e1e9-4dd5-9327-34b248cbd4d8 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2022-11-20 20:52:56.150  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Member consumer-email-2-9fc15be2-0d23-42fb-8eb3-6c5cc49bfe93 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2022-11-20 20:52:56.150  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-20 20:52:56.150  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-20 20:52:56.150  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-20 20:52:56.150  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-20 20:52:56.150  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-20 20:52:56.150  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-2, groupId=email] Unsubscribed all topics or patterns and assigned partitions
2022-11-20 20:52:56.150  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-20 20:52:56.150  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Unsubscribed all topics or patterns and assigned partitions
2022-11-20 20:52:56.150  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-1, groupId=email] Unsubscribed all topics or patterns and assigned partitions
2022-11-20 20:52:56.151  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-20 20:52:56.151  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-20 20:52:56.151  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-20 20:52:56.151  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-20 20:52:56.151  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-20 20:52:56.151  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-20 20:52:56.184  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-20 20:52:56.184  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-20 20:52:56.184  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-20 20:52:56.184  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-20 20:52:56.184  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-20 20:52:56.184  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-20 20:52:56.188  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-email-2 unregistered
2022-11-20 20:52:56.189  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-20 20:52:56.189  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-20 20:52:56.189  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: Consumer stopped
2022-11-20 20:52:56.189  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-20 20:52:56.189  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-email-3 unregistered
2022-11-20 20:52:56.190  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: Consumer stopped
2022-11-20 20:52:56.191  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-email-1 unregistered
2022-11-20 20:52:56.192  INFO [EMAIL-SERVICE,,] 100084 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: Consumer stopped
2022-11-20 20:53:00.978  INFO [EMAIL-SERVICE,,] 101246 --- [main] c.a.e.EmailServiceApplication            : Starting EmailServiceApplication using Java 19.0.1 on aditya-ASUS-TUF-Gaming-F15-FX506LI-FX566LI with PID 101246 (/home/aditya/Downloads/Ecommerce-ordering-service/email-service/target/classes started by aditya in /home/aditya/Downloads/Ecommerce-ordering-service)
2022-11-20 20:53:00.981  INFO [EMAIL-SERVICE,,] 101246 --- [main] c.a.e.EmailServiceApplication            : No active profile set, falling back to 1 default profile: "default"
2022-11-20 20:53:01.561  INFO [EMAIL-SERVICE,,] 101246 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data MongoDB repositories in DEFAULT mode.
2022-11-20 20:53:01.571  INFO [EMAIL-SERVICE,,] 101246 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 6 ms. Found 0 MongoDB repository interfaces.
2022-11-20 20:53:01.773  INFO [EMAIL-SERVICE,,] 101246 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=d620a4fc-e5f9-3ec2-ab20-28674c7b93cf
2022-11-20 20:53:02.276  INFO [EMAIL-SERVICE,,] 101246 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8084 (http)
2022-11-20 20:53:02.283  INFO [EMAIL-SERVICE,,] 101246 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-20 20:53:02.283  INFO [EMAIL-SERVICE,,] 101246 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.68]
2022-11-20 20:53:02.366  INFO [EMAIL-SERVICE,,] 101246 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-20 20:53:02.366  INFO [EMAIL-SERVICE,,] 101246 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1336 ms
2022-11-20 20:53:03.369  INFO [EMAIL-SERVICE,,] 101246 --- [cluster-ClusterId{value='637a465763f1740bc1179fc2', description='null'}-localhost:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server localhost:27017

com.mongodb.MongoSocketOpenException: Exception opening socket
	at com.mongodb.internal.connection.SocketStream.open(SocketStream.java:70) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.InternalStreamConnection.open(InternalStreamConnection.java:180) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:193) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:157) ~[mongodb-driver-core-4.6.1.jar:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:535) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:585) ~[na:na]
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:666) ~[na:na]
	at com.mongodb.internal.connection.SocketStreamHelper.initialize(SocketStreamHelper.java:107) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.SocketStream.initializeSocket(SocketStream.java:79) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.SocketStream.open(SocketStream.java:65) ~[mongodb-driver-core-4.6.1.jar:na]
	... 4 common frames omitted

2022-11-20 20:53:03.370  INFO [EMAIL-SERVICE,,] 101246 --- [main] org.mongodb.driver.client                : MongoClient with metadata {"driver": {"name": "mongo-java-driver|sync|spring-boot", "version": "4.6.1"}, "os": {"type": "Linux", "name": "Linux", "architecture": "amd64", "version": "5.15.0-53-generic"}, "platform": "Java/Oracle Corporation/19.0.1+10-21"} created with settings MongoClientSettings{readPreference=primary, writeConcern=WriteConcern{w=null, wTimeout=null ms, journal=null}, retryWrites=true, retryReads=true, readConcern=ReadConcern{level=null}, credential=null, streamFactoryFactory=null, commandListeners=[org.springframework.cloud.sleuth.instrument.mongodb.TraceMongoCommandListener@77cddc0c], codecRegistry=ProvidersCodecRegistry{codecProviders=[ValueCodecProvider{}, BsonValueCodecProvider{}, DBRefCodecProvider{}, DBObjectCodecProvider{}, DocumentCodecProvider{}, IterableCodecProvider{}, MapCodecProvider{}, GeoJsonCodecProvider{}, GridFSFileCodecProvider{}, Jsr310CodecProvider{}, JsonObjectCodecProvider{}, BsonCodecProvider{}, EnumCodecProvider{}, com.mongodb.Jep395RecordCodecProvider@671d97bc]}, clusterSettings={hosts=[localhost:27017], srvServiceName=mongodb, mode=SINGLE, requiredClusterType=UNKNOWN, requiredReplicaSetName='null', serverSelector='null', clusterListeners='[]', serverSelectionTimeout='30000 ms', localThreshold='30000 ms'}, socketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=0, receiveBufferSize=0, sendBufferSize=0}, heartbeatSocketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=10000, receiveBufferSize=0, sendBufferSize=0}, connectionPoolSettings=ConnectionPoolSettings{maxSize=100, minSize=0, maxWaitTimeMS=120000, maxConnectionLifeTimeMS=0, maxConnectionIdleTimeMS=0, maintenanceInitialDelayMS=0, maintenanceFrequencyMS=60000, connectionPoolListeners=[], maxConnecting=2}, serverSettings=ServerSettings{heartbeatFrequencyMS=10000, minHeartbeatFrequencyMS=500, serverListeners='[]', serverMonitorListeners='[]'}, sslSettings=SslSettings{enabled=false, invalidHostNameAllowed=false, context=null}, applicationName='null', compressorList=[], uuidRepresentation=JAVA_LEGACY, serverApi=null, autoEncryptionSettings=null, contextProvider=org.springframework.cloud.sleuth.instrument.mongodb.TraceSynchronousMongoClientSettingsBuilderCustomizer$$Lambda$836/0x00000008014a2000@774f2992}
2022-11-20 20:53:03.966  INFO [EMAIL-SERVICE,,] 101246 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-email-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = email
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2022-11-20 20:53:04.319  INFO [EMAIL-SERVICE,,] 101246 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-20 20:53:04.320  INFO [EMAIL-SERVICE,,] 101246 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-20 20:53:04.320  INFO [EMAIL-SERVICE,,] 101246 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1668957784318
2022-11-20 20:53:04.322  INFO [EMAIL-SERVICE,,] 101246 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-1, groupId=email] Subscribed to topic(s): order_topics
2022-11-20 20:53:04.328  INFO [EMAIL-SERVICE,,] 101246 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-email-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = email
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2022-11-20 20:53:04.333  INFO [EMAIL-SERVICE,,] 101246 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-20 20:53:04.333  INFO [EMAIL-SERVICE,,] 101246 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-20 20:53:04.333  INFO [EMAIL-SERVICE,,] 101246 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1668957784333
2022-11-20 20:53:04.333  INFO [EMAIL-SERVICE,,] 101246 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-2, groupId=email] Subscribed to topic(s): customer_topic
2022-11-20 20:53:04.335  INFO [EMAIL-SERVICE,,] 101246 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-email-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = email
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2022-11-20 20:53:04.340  INFO [EMAIL-SERVICE,,] 101246 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-20 20:53:04.340  INFO [EMAIL-SERVICE,,] 101246 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-20 20:53:04.340  INFO [EMAIL-SERVICE,,] 101246 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1668957784340
2022-11-20 20:53:04.340  INFO [EMAIL-SERVICE,,] 101246 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Subscribed to topic(s): payment_complete
2022-11-20 20:53:04.349  INFO [EMAIL-SERVICE,,] 101246 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8084 (http) with context path ''
2022-11-20 20:53:04.397  INFO [EMAIL-SERVICE,,] 101246 --- [main] c.a.e.EmailServiceApplication            : Started EmailServiceApplication in 3.851 seconds (JVM running for 4.194)
2022-11-20 20:53:04.685  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-1, groupId=email] Resetting the last seen epoch of partition order_topics-0 to 0 since the associated topicId changed from null to WFpyU0BqR5-w7pCovYKThg
2022-11-20 20:53:04.685  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-2, groupId=email] Resetting the last seen epoch of partition customer_topic-0 to 0 since the associated topicId changed from null to tKr50QVbTM2_exfwcWm5Og
2022-11-20 20:53:04.685  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-3, groupId=email] Resetting the last seen epoch of partition payment_complete-0 to 0 since the associated topicId changed from null to lXK061VOTzqVujfWi-KIWg
2022-11-20 20:53:04.687  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-2, groupId=email] Cluster ID: N6_RKQEzRKyebGgdHnjA8Q
2022-11-20 20:53:04.687  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-3, groupId=email] Cluster ID: N6_RKQEzRKyebGgdHnjA8Q
2022-11-20 20:53:04.687  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-1, groupId=email] Cluster ID: N6_RKQEzRKyebGgdHnjA8Q
2022-11-20 20:53:04.689  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-20 20:53:04.689  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-20 20:53:04.689  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-20 20:53:04.691  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] (Re-)joining group
2022-11-20 20:53:04.691  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] (Re-)joining group
2022-11-20 20:53:04.695  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] (Re-)joining group
2022-11-20 20:53:04.706  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Request joining group due to: need to re-join with the given member-id
2022-11-20 20:53:04.706  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] (Re-)joining group
2022-11-20 20:53:04.708  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Request joining group due to: need to re-join with the given member-id
2022-11-20 20:53:04.708  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Request joining group due to: need to re-join with the given member-id
2022-11-20 20:53:04.709  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] (Re-)joining group
2022-11-20 20:53:04.709  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] (Re-)joining group
2022-11-20 20:53:07.796  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Successfully joined group with generation Generation{generationId=8, memberId='consumer-email-3-bdb39bfa-844f-415f-ac1c-8308284738c0', protocol='range'}
2022-11-20 20:53:07.797  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Successfully joined group with generation Generation{generationId=8, memberId='consumer-email-1-7628a5aa-067b-41a0-a9f7-c358d0b821e2', protocol='range'}
2022-11-20 20:53:07.797  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Successfully joined group with generation Generation{generationId=8, memberId='consumer-email-2-0d84d758-34ec-4717-b14d-8c793e75b421', protocol='range'}
2022-11-20 20:53:07.848  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-1, groupId=email] Resetting the last seen epoch of partition payment_complete-0 to 0 since the associated topicId changed from null to lXK061VOTzqVujfWi-KIWg
2022-11-20 20:53:07.848  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-1, groupId=email] Resetting the last seen epoch of partition customer_topic-0 to 0 since the associated topicId changed from null to tKr50QVbTM2_exfwcWm5Og
2022-11-20 20:53:07.851  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Finished assignment for group at generation 8: {consumer-email-3-bdb39bfa-844f-415f-ac1c-8308284738c0=Assignment(partitions=[payment_complete-0]), consumer-email-1-7628a5aa-067b-41a0-a9f7-c358d0b821e2=Assignment(partitions=[order_topics-0]), consumer-email-2-0d84d758-34ec-4717-b14d-8c793e75b421=Assignment(partitions=[customer_topic-0])}
2022-11-20 20:53:07.932  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Successfully synced group in generation Generation{generationId=8, memberId='consumer-email-3-bdb39bfa-844f-415f-ac1c-8308284738c0', protocol='range'}
2022-11-20 20:53:07.932  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Successfully synced group in generation Generation{generationId=8, memberId='consumer-email-2-0d84d758-34ec-4717-b14d-8c793e75b421', protocol='range'}
2022-11-20 20:53:07.932  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Successfully synced group in generation Generation{generationId=8, memberId='consumer-email-1-7628a5aa-067b-41a0-a9f7-c358d0b821e2', protocol='range'}
2022-11-20 20:53:07.933  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Notifying assignor about the new Assignment(partitions=[order_topics-0])
2022-11-20 20:53:07.933  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Notifying assignor about the new Assignment(partitions=[customer_topic-0])
2022-11-20 20:53:07.933  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Notifying assignor about the new Assignment(partitions=[payment_complete-0])
2022-11-20 20:53:07.934  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Adding newly assigned partitions: payment_complete-0
2022-11-20 20:53:07.934  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Adding newly assigned partitions: order_topics-0
2022-11-20 20:53:07.934  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Adding newly assigned partitions: customer_topic-0
2022-11-20 20:53:08.052  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Setting offset for partition order_topics-0 to the committed offset FetchPosition{offset=5, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2022-11-20 20:53:08.052  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Found no committed offset for partition customer_topic-0
2022-11-20 20:53:08.052  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Setting offset for partition payment_complete-0 to the committed offset FetchPosition{offset=3, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2022-11-20 20:53:08.053  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions assigned: [order_topics-0]
2022-11-20 20:53:08.153  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions assigned: [payment_complete-0]
2022-11-20 20:53:08.325  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.SubscriptionState    : [Consumer clientId=consumer-email-2, groupId=email] Resetting offset for partition customer_topic-0 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}.
2022-11-20 20:53:08.326  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions assigned: [customer_topic-0]
2022-11-20 20:53:38.149  INFO [EMAIL-SERVICE,6d572f634cdb9cd7,333092cd513c8bfe] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => OrderEvent(status=PENDING, message=Complete the payment, customer=Customer(id=1, name=Aditya, email=abc@gamil.com, age=26), order=Order(id=22e8e78c-4890-4d89-9352-edcbbadb4660, cid=1, pid=3, qty=5), product=Product(id=3, name=speaker, price=100000.0, qtyavail=12))
2022-11-20 20:53:56.465  INFO [PAYMENT-SERVICE,67407ec8d4612d4f,67407ec8d4612d4f] 97471 --- [http-nio-8086-exec-1] c.a.p.kafka.PaymentProducer              : Payment Event => Payment(transId=3d3d7a06-04de-4383-b8a0-f81abbc12a19, status=Transaction completed, orderId=22e8e78c-4890-4d89-9352-edcbbadb4660, price=0.0)
2022-11-20 20:53:56.487  INFO [EMAIL-SERVICE,67407ec8d4612d4f,e642dabed5d5e94f] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => Payment(transId=3d3d7a06-04de-4383-b8a0-f81abbc12a19, status=Transaction completed, orderId=22e8e78c-4890-4d89-9352-edcbbadb4660, price=0.0)
2022-11-20 20:53:56.522  INFO [EMAIL-SERVICE,67407ec8d4612d4f,e642dabed5d5e94f] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Send reciept to customer => Customer(id=1, name=Aditya, email=abc@gamil.com, age=26)
2022-11-20 20:54:18.732  INFO [EMAIL-SERVICE,,] 101246 --- [Thread-2] o.s.c.s.a.z.ZipkinAutoConfiguration      : Flushing remaining spans on shutdown
2022-11-20 20:54:18.749  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Revoke previously assigned partitions payment_complete-0
2022-11-20 20:54:18.749  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Revoke previously assigned partitions order_topics-0
2022-11-20 20:54:18.749  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Revoke previously assigned partitions customer_topic-0
2022-11-20 20:54:18.749  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions revoked: [payment_complete-0]
2022-11-20 20:54:18.749  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions revoked: [customer_topic-0]
2022-11-20 20:54:18.749  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions revoked: [order_topics-0]
2022-11-20 20:54:18.750  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Member consumer-email-3-bdb39bfa-844f-415f-ac1c-8308284738c0 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2022-11-20 20:54:18.750  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Member consumer-email-2-0d84d758-34ec-4717-b14d-8c793e75b421 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2022-11-20 20:54:18.750  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Member consumer-email-1-7628a5aa-067b-41a0-a9f7-c358d0b821e2 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2022-11-20 20:54:18.750  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-20 20:54:18.750  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-20 20:54:18.750  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-1, groupId=email] Unsubscribed all topics or patterns and assigned partitions
2022-11-20 20:54:18.750  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-20 20:54:18.750  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-20 20:54:18.751  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Unsubscribed all topics or patterns and assigned partitions
2022-11-20 20:54:18.750  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-20 20:54:18.751  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-20 20:54:18.751  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-20 20:54:18.751  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-20 20:54:18.751  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-20 20:54:18.751  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-20 20:54:18.752  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-2, groupId=email] Unsubscribed all topics or patterns and assigned partitions
2022-11-20 20:54:18.752  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-20 20:54:18.752  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-20 20:54:18.753  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-20 20:54:18.754  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-20 20:54:18.754  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-20 20:54:18.755  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-20 20:54:18.755  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-20 20:54:18.756  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-20 20:54:18.753  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-20 20:54:18.756  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-20 20:54:18.756  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-20 20:54:18.759  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-email-2 unregistered
2022-11-20 20:54:18.760  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: Consumer stopped
2022-11-20 20:54:18.761  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-email-3 unregistered
2022-11-20 20:54:18.762  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: Consumer stopped
2022-11-20 20:54:18.762  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-email-1 unregistered
2022-11-20 20:54:18.762  INFO [EMAIL-SERVICE,,] 101246 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: Consumer stopped
2022-11-20 20:54:23.324  INFO [EMAIL-SERVICE,,] 101817 --- [main] c.a.e.EmailServiceApplication            : Starting EmailServiceApplication using Java 19.0.1 on aditya-ASUS-TUF-Gaming-F15-FX506LI-FX566LI with PID 101817 (/home/aditya/Downloads/Ecommerce-ordering-service/email-service/target/classes started by aditya in /home/aditya/Downloads/Ecommerce-ordering-service)
2022-11-20 20:54:23.327  INFO [EMAIL-SERVICE,,] 101817 --- [main] c.a.e.EmailServiceApplication            : No active profile set, falling back to 1 default profile: "default"
2022-11-20 20:54:23.970  INFO [EMAIL-SERVICE,,] 101817 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data MongoDB repositories in DEFAULT mode.
2022-11-20 20:54:23.979  INFO [EMAIL-SERVICE,,] 101817 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 4 ms. Found 0 MongoDB repository interfaces.
2022-11-20 20:54:24.171  INFO [EMAIL-SERVICE,,] 101817 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=d620a4fc-e5f9-3ec2-ab20-28674c7b93cf
2022-11-20 20:54:24.800  INFO [EMAIL-SERVICE,,] 101817 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8084 (http)
2022-11-20 20:54:24.808  INFO [EMAIL-SERVICE,,] 101817 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-20 20:54:24.808  INFO [EMAIL-SERVICE,,] 101817 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.68]
2022-11-20 20:54:24.887  INFO [EMAIL-SERVICE,,] 101817 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-20 20:54:24.887  INFO [EMAIL-SERVICE,,] 101817 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1510 ms
2022-11-20 20:54:25.959  INFO [EMAIL-SERVICE,,] 101817 --- [cluster-ClusterId{value='637a46a9232a01573a739567', description='null'}-localhost:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server localhost:27017

com.mongodb.MongoSocketOpenException: Exception opening socket
	at com.mongodb.internal.connection.SocketStream.open(SocketStream.java:70) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.InternalStreamConnection.open(InternalStreamConnection.java:180) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:193) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:157) ~[mongodb-driver-core-4.6.1.jar:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:535) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:585) ~[na:na]
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:666) ~[na:na]
	at com.mongodb.internal.connection.SocketStreamHelper.initialize(SocketStreamHelper.java:107) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.SocketStream.initializeSocket(SocketStream.java:79) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.SocketStream.open(SocketStream.java:65) ~[mongodb-driver-core-4.6.1.jar:na]
	... 4 common frames omitted

2022-11-20 20:54:25.961  INFO [EMAIL-SERVICE,,] 101817 --- [main] org.mongodb.driver.client                : MongoClient with metadata {"driver": {"name": "mongo-java-driver|sync|spring-boot", "version": "4.6.1"}, "os": {"type": "Linux", "name": "Linux", "architecture": "amd64", "version": "5.15.0-53-generic"}, "platform": "Java/Oracle Corporation/19.0.1+10-21"} created with settings MongoClientSettings{readPreference=primary, writeConcern=WriteConcern{w=null, wTimeout=null ms, journal=null}, retryWrites=true, retryReads=true, readConcern=ReadConcern{level=null}, credential=null, streamFactoryFactory=null, commandListeners=[org.springframework.cloud.sleuth.instrument.mongodb.TraceMongoCommandListener@58b97c15], codecRegistry=ProvidersCodecRegistry{codecProviders=[ValueCodecProvider{}, BsonValueCodecProvider{}, DBRefCodecProvider{}, DBObjectCodecProvider{}, DocumentCodecProvider{}, IterableCodecProvider{}, MapCodecProvider{}, GeoJsonCodecProvider{}, GridFSFileCodecProvider{}, Jsr310CodecProvider{}, JsonObjectCodecProvider{}, BsonCodecProvider{}, EnumCodecProvider{}, com.mongodb.Jep395RecordCodecProvider@26994c6a]}, clusterSettings={hosts=[localhost:27017], srvServiceName=mongodb, mode=SINGLE, requiredClusterType=UNKNOWN, requiredReplicaSetName='null', serverSelector='null', clusterListeners='[]', serverSelectionTimeout='30000 ms', localThreshold='30000 ms'}, socketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=0, receiveBufferSize=0, sendBufferSize=0}, heartbeatSocketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=10000, receiveBufferSize=0, sendBufferSize=0}, connectionPoolSettings=ConnectionPoolSettings{maxSize=100, minSize=0, maxWaitTimeMS=120000, maxConnectionLifeTimeMS=0, maxConnectionIdleTimeMS=0, maintenanceInitialDelayMS=0, maintenanceFrequencyMS=60000, connectionPoolListeners=[], maxConnecting=2}, serverSettings=ServerSettings{heartbeatFrequencyMS=10000, minHeartbeatFrequencyMS=500, serverListeners='[]', serverMonitorListeners='[]'}, sslSettings=SslSettings{enabled=false, invalidHostNameAllowed=false, context=null}, applicationName='null', compressorList=[], uuidRepresentation=JAVA_LEGACY, serverApi=null, autoEncryptionSettings=null, contextProvider=org.springframework.cloud.sleuth.instrument.mongodb.TraceSynchronousMongoClientSettingsBuilderCustomizer$$Lambda$836/0x00000008014a6c08@3cd46491}
2022-11-20 20:54:26.464  INFO [EMAIL-SERVICE,,] 101817 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-email-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = email
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2022-11-20 20:54:26.595  INFO [EMAIL-SERVICE,,] 101817 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-20 20:54:26.596  INFO [EMAIL-SERVICE,,] 101817 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-20 20:54:26.596  INFO [EMAIL-SERVICE,,] 101817 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1668957866595
2022-11-20 20:54:26.598  INFO [EMAIL-SERVICE,,] 101817 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-1, groupId=email] Subscribed to topic(s): order_topics
2022-11-20 20:54:26.606  INFO [EMAIL-SERVICE,,] 101817 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-email-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = email
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2022-11-20 20:54:26.614  INFO [EMAIL-SERVICE,,] 101817 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-20 20:54:26.614  INFO [EMAIL-SERVICE,,] 101817 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-20 20:54:26.614  INFO [EMAIL-SERVICE,,] 101817 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1668957866614
2022-11-20 20:54:26.614  INFO [EMAIL-SERVICE,,] 101817 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-2, groupId=email] Subscribed to topic(s): customer_topic
2022-11-20 20:54:26.616  INFO [EMAIL-SERVICE,,] 101817 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-email-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = email
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2022-11-20 20:54:26.623  INFO [EMAIL-SERVICE,,] 101817 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-20 20:54:26.624  INFO [EMAIL-SERVICE,,] 101817 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-20 20:54:26.624  INFO [EMAIL-SERVICE,,] 101817 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1668957866623
2022-11-20 20:54:26.624  INFO [EMAIL-SERVICE,,] 101817 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Subscribed to topic(s): payment_complete
2022-11-20 20:54:26.636  INFO [EMAIL-SERVICE,,] 101817 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8084 (http) with context path ''
2022-11-20 20:54:26.689  INFO [EMAIL-SERVICE,,] 101817 --- [main] c.a.e.EmailServiceApplication            : Started EmailServiceApplication in 3.802 seconds (JVM running for 4.184)
2022-11-20 20:54:26.792  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-3, groupId=email] Resetting the last seen epoch of partition payment_complete-0 to 0 since the associated topicId changed from null to lXK061VOTzqVujfWi-KIWg
2022-11-20 20:54:26.792  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-2, groupId=email] Resetting the last seen epoch of partition customer_topic-0 to 0 since the associated topicId changed from null to tKr50QVbTM2_exfwcWm5Og
2022-11-20 20:54:26.792  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-1, groupId=email] Resetting the last seen epoch of partition order_topics-0 to 0 since the associated topicId changed from null to WFpyU0BqR5-w7pCovYKThg
2022-11-20 20:54:26.793  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-2, groupId=email] Cluster ID: N6_RKQEzRKyebGgdHnjA8Q
2022-11-20 20:54:26.793  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-3, groupId=email] Cluster ID: N6_RKQEzRKyebGgdHnjA8Q
2022-11-20 20:54:26.793  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-1, groupId=email] Cluster ID: N6_RKQEzRKyebGgdHnjA8Q
2022-11-20 20:54:26.794  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-20 20:54:26.794  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-20 20:54:26.794  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-20 20:54:26.796  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] (Re-)joining group
2022-11-20 20:54:26.796  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] (Re-)joining group
2022-11-20 20:54:26.796  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] (Re-)joining group
2022-11-20 20:54:26.803  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Request joining group due to: need to re-join with the given member-id
2022-11-20 20:54:26.803  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Request joining group due to: need to re-join with the given member-id
2022-11-20 20:54:26.803  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Request joining group due to: need to re-join with the given member-id
2022-11-20 20:54:26.803  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] (Re-)joining group
2022-11-20 20:54:26.803  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] (Re-)joining group
2022-11-20 20:54:26.803  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] (Re-)joining group
2022-11-20 20:54:29.807  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Successfully joined group with generation Generation{generationId=10, memberId='consumer-email-2-30fbda04-1ff1-43cd-b3f3-313654c983c2', protocol='range'}
2022-11-20 20:54:29.807  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Successfully joined group with generation Generation{generationId=10, memberId='consumer-email-1-c949c454-179c-4ecb-837c-f72a20defd37', protocol='range'}
2022-11-20 20:54:29.807  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Successfully joined group with generation Generation{generationId=10, memberId='consumer-email-3-af1cf567-95e2-40cc-b27a-94edf2163193', protocol='range'}
2022-11-20 20:54:29.818  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-3, groupId=email] Resetting the last seen epoch of partition order_topics-0 to 0 since the associated topicId changed from null to WFpyU0BqR5-w7pCovYKThg
2022-11-20 20:54:29.819  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-3, groupId=email] Resetting the last seen epoch of partition customer_topic-0 to 0 since the associated topicId changed from null to tKr50QVbTM2_exfwcWm5Og
2022-11-20 20:54:29.823  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Finished assignment for group at generation 10: {consumer-email-2-30fbda04-1ff1-43cd-b3f3-313654c983c2=Assignment(partitions=[customer_topic-0]), consumer-email-1-c949c454-179c-4ecb-837c-f72a20defd37=Assignment(partitions=[order_topics-0]), consumer-email-3-af1cf567-95e2-40cc-b27a-94edf2163193=Assignment(partitions=[payment_complete-0])}
2022-11-20 20:54:29.833  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Successfully synced group in generation Generation{generationId=10, memberId='consumer-email-2-30fbda04-1ff1-43cd-b3f3-313654c983c2', protocol='range'}
2022-11-20 20:54:29.833  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Successfully synced group in generation Generation{generationId=10, memberId='consumer-email-3-af1cf567-95e2-40cc-b27a-94edf2163193', protocol='range'}
2022-11-20 20:54:29.833  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Successfully synced group in generation Generation{generationId=10, memberId='consumer-email-1-c949c454-179c-4ecb-837c-f72a20defd37', protocol='range'}
2022-11-20 20:54:29.834  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Notifying assignor about the new Assignment(partitions=[customer_topic-0])
2022-11-20 20:54:29.834  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Notifying assignor about the new Assignment(partitions=[order_topics-0])
2022-11-20 20:54:29.834  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Notifying assignor about the new Assignment(partitions=[payment_complete-0])
2022-11-20 20:54:29.839  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Adding newly assigned partitions: customer_topic-0
2022-11-20 20:54:29.839  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Adding newly assigned partitions: order_topics-0
2022-11-20 20:54:29.839  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Adding newly assigned partitions: payment_complete-0
2022-11-20 20:54:29.850  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Found no committed offset for partition customer_topic-0
2022-11-20 20:54:29.851  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Setting offset for partition order_topics-0 to the committed offset FetchPosition{offset=6, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2022-11-20 20:54:29.851  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Setting offset for partition payment_complete-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2022-11-20 20:54:29.852  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions assigned: [order_topics-0]
2022-11-20 20:54:29.852  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions assigned: [payment_complete-0]
2022-11-20 20:54:29.859  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.SubscriptionState    : [Consumer clientId=consumer-email-2, groupId=email] Resetting offset for partition customer_topic-0 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}.
2022-11-20 20:54:29.859  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions assigned: [customer_topic-0]
2022-11-20 21:03:26.846  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node -1 disconnected.
2022-11-20 21:03:26.916  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node -1 disconnected.
2022-11-20 21:03:26.964  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node -1 disconnected.
2022-11-20 21:08:15.421  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 2147483646 disconnected.
2022-11-20 21:08:15.423  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:15.470  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Cancelled in-flight FETCH request with correlation id 1931 due to node 1 being disconnected (elapsed time since creation: 90ms, elapsed time since send: 90ms, request timeout: 30000ms)
2022-11-20 21:08:15.472  INFO [EMAIL-SERVICE,,] 101817 --- [kafka-coordinator-heartbeat-thread | email] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Group coordinator localhost:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: true. Rediscovery will be attempted.
2022-11-20 21:08:15.500  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.clients.FetchSessionHandler    : [Consumer clientId=consumer-email-2, groupId=email] Error sending fetch request (sessionId=1763475135, epoch=1644) to node 1:

org.apache.kafka.common.errors.DisconnectException: null

2022-11-20 21:08:15.562  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:15.562  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1933 due to node 1 being disconnected (elapsed time since creation: 20ms, elapsed time since send: 20ms, request timeout: 30000ms)
2022-11-20 21:08:15.576  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.clients.FetchSessionHandler    : [Consumer clientId=consumer-email-2, groupId=email] Error sending fetch request (sessionId=1763475135, epoch=INITIAL) to node 1:

org.apache.kafka.common.errors.DisconnectException: null

2022-11-20 21:08:15.663  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:15.664  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1935 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:15.665  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.clients.FetchSessionHandler    : [Consumer clientId=consumer-email-2, groupId=email] Error sending fetch request (sessionId=1763475135, epoch=INITIAL) to node 1:

org.apache.kafka.common.errors.DisconnectException: null

2022-11-20 21:08:15.777  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:15.779  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1937 due to node 1 being disconnected (elapsed time since creation: 4ms, elapsed time since send: 4ms, request timeout: 30000ms)
2022-11-20 21:08:15.781  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.clients.FetchSessionHandler    : [Consumer clientId=consumer-email-2, groupId=email] Error sending fetch request (sessionId=1763475135, epoch=INITIAL) to node 1:

org.apache.kafka.common.errors.DisconnectException: null

2022-11-20 21:08:15.886  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:15.889  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1939 due to node 1 being disconnected (elapsed time since creation: 2ms, elapsed time since send: 2ms, request timeout: 30000ms)
2022-11-20 21:08:15.891  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.clients.FetchSessionHandler    : [Consumer clientId=consumer-email-2, groupId=email] Error sending fetch request (sessionId=1763475135, epoch=INITIAL) to node 1:

org.apache.kafka.common.errors.DisconnectException: null

2022-11-20 21:08:15.955  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:15.955  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 2147483646 disconnected.
2022-11-20 21:08:15.956  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Cancelled in-flight FETCH request with correlation id 1928 due to node 1 being disconnected (elapsed time since creation: 937ms, elapsed time since send: 937ms, request timeout: 30000ms)
2022-11-20 21:08:15.957  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Cancelled in-flight METADATA request with correlation id 1930 due to node 1 being disconnected (elapsed time since creation: 829ms, elapsed time since send: 829ms, request timeout: 30000ms)
2022-11-20 21:08:15.957  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:15.958  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Group coordinator localhost:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: true. Rediscovery will be attempted.
2022-11-20 21:08:15.958  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Cancelled in-flight FIND_COORDINATOR request with correlation id 1931 due to node 1 being disconnected (elapsed time since creation: 474ms, elapsed time since send: 474ms, request timeout: 30000ms)
2022-11-20 21:08:15.959  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Cancelled in-flight FIND_COORDINATOR request with correlation id 1932 due to node 1 being disconnected (elapsed time since creation: 474ms, elapsed time since send: 518ms, request timeout: 30000ms)
2022-11-20 21:08:15.959  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Cancelled in-flight FETCH request with correlation id 1930 due to node 1 being disconnected (elapsed time since creation: 820ms, elapsed time since send: 820ms, request timeout: 30000ms)
2022-11-20 21:08:15.961  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.kafka.clients.FetchSessionHandler    : [Consumer clientId=consumer-email-3, groupId=email] Error sending fetch request (sessionId=1082810437, epoch=1643) to node 1:

org.apache.kafka.common.errors.DisconnectException: null

2022-11-20 21:08:15.962  INFO [EMAIL-SERVICE,,] 101817 --- [kafka-coordinator-heartbeat-thread | email] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 2147483646 disconnected.
2022-11-20 21:08:15.966  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:15.968  INFO [EMAIL-SERVICE,,] 101817 --- [kafka-coordinator-heartbeat-thread | email] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Group coordinator localhost:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: true. Rediscovery will be attempted.
2022-11-20 21:08:15.962  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.kafka.clients.FetchSessionHandler    : [Consumer clientId=consumer-email-1, groupId=email] Error sending fetch request (sessionId=1514554524, epoch=1643) to node 1:

org.apache.kafka.common.errors.DisconnectException: null

2022-11-20 21:08:15.969  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1941 due to node 1 being disconnected (elapsed time since creation: 7ms, elapsed time since send: 7ms, request timeout: 30000ms)
2022-11-20 21:08:16.005  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.011  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1932 due to node 1 being disconnected (elapsed time since creation: 4ms, elapsed time since send: 4ms, request timeout: 30000ms)
2022-11-20 21:08:16.043  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.045  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1942 due to node 1 being disconnected (elapsed time since creation: 6ms, elapsed time since send: 6ms, request timeout: 30000ms)
2022-11-20 21:08:16.057  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.064  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.066  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1934 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:16.060  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1933 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:16.147  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.148  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1943 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:16.159  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.165  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.170  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1935 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:16.170  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1934 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:16.030  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:16.255  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.255  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1944 due to node 1 being disconnected (elapsed time since creation: 7ms, elapsed time since send: 7ms, request timeout: 30000ms)
2022-11-20 21:08:16.261  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.262  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1935 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:16.300  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.302  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1936 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:16.356  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.358  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1945 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:16.360  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:16.363  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.365  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Cancelled in-flight API_VERSIONS request with correlation id 15 due to node 1 being disconnected (elapsed time since creation: 6ms, elapsed time since send: 6ms, request timeout: 30000ms)
2022-11-20 21:08:16.364  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1936 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:16.402  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.403  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1937 due to node 1 being disconnected (elapsed time since creation: 2ms, elapsed time since send: 2ms, request timeout: 30000ms)
2022-11-20 21:08:16.460  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.462  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1946 due to node 1 being disconnected (elapsed time since creation: 4ms, elapsed time since send: 4ms, request timeout: 30000ms)
2022-11-20 21:08:16.465  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.467  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1937 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:16.503  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.503  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1938 due to node 1 being disconnected (elapsed time since creation: 0ms, elapsed time since send: 0ms, request timeout: 30000ms)
2022-11-20 21:08:16.562  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.563  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1947 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:16.565  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.566  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1938 due to node 1 being disconnected (elapsed time since creation: 0ms, elapsed time since send: 0ms, request timeout: 30000ms)
2022-11-20 21:08:16.584  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:16.585  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Cancelled in-flight API_VERSIONS request with correlation id 16 due to node 1 being disconnected (elapsed time since creation: 0ms, elapsed time since send: 0ms, request timeout: 30000ms)
2022-11-20 21:08:16.604  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.605  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1939 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:16.663  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.664  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1948 due to node 1 being disconnected (elapsed time since creation: 0ms, elapsed time since send: 0ms, request timeout: 30000ms)
2022-11-20 21:08:16.666  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.667  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1939 due to node 1 being disconnected (elapsed time since creation: 0ms, elapsed time since send: 0ms, request timeout: 30000ms)
2022-11-20 21:08:16.685  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:16.685  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Cancelled in-flight API_VERSIONS request with correlation id 17 due to node 1 being disconnected (elapsed time since creation: 0ms, elapsed time since send: 0ms, request timeout: 30000ms)
2022-11-20 21:08:16.707  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.709  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1940 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:16.764  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.765  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1949 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:16.767  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.767  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1940 due to node 1 being disconnected (elapsed time since creation: 0ms, elapsed time since send: 0ms, request timeout: 30000ms)
2022-11-20 21:08:16.809  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.810  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1941 due to node 1 being disconnected (elapsed time since creation: 2ms, elapsed time since send: 2ms, request timeout: 30000ms)
2022-11-20 21:08:16.822  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:16.823  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Cancelled in-flight API_VERSIONS request with correlation id 18 due to node 1 being disconnected (elapsed time since creation: 37ms, elapsed time since send: 37ms, request timeout: 30000ms)
2022-11-20 21:08:16.865  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.866  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1950 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:16.869  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.870  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1941 due to node 1 being disconnected (elapsed time since creation: 0ms, elapsed time since send: 0ms, request timeout: 30000ms)
2022-11-20 21:08:16.911  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.911  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1942 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:16.924  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:16.926  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Cancelled in-flight API_VERSIONS request with correlation id 19 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:16.967  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.970  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1951 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:16.971  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:16.975  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1942 due to node 1 being disconnected (elapsed time since creation: 2ms, elapsed time since send: 2ms, request timeout: 30000ms)
2022-11-20 21:08:17.013  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.014  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1943 due to node 1 being disconnected (elapsed time since creation: 2ms, elapsed time since send: 2ms, request timeout: 30000ms)
2022-11-20 21:08:17.026  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:17.029  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Cancelled in-flight API_VERSIONS request with correlation id 20 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:17.069  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.070  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1952 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:17.075  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.078  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1943 due to node 1 being disconnected (elapsed time since creation: 2ms, elapsed time since send: 2ms, request timeout: 30000ms)
2022-11-20 21:08:17.116  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.117  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1944 due to node 1 being disconnected (elapsed time since creation: 2ms, elapsed time since send: 2ms, request timeout: 30000ms)
2022-11-20 21:08:17.129  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:17.131  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Cancelled in-flight API_VERSIONS request with correlation id 21 due to node 1 being disconnected (elapsed time since creation: 2ms, elapsed time since send: 2ms, request timeout: 30000ms)
2022-11-20 21:08:17.171  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.172  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1953 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:17.176  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.177  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1944 due to node 1 being disconnected (elapsed time since creation: 0ms, elapsed time since send: 0ms, request timeout: 30000ms)
2022-11-20 21:08:17.218  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.218  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1945 due to node 1 being disconnected (elapsed time since creation: 0ms, elapsed time since send: 0ms, request timeout: 30000ms)
2022-11-20 21:08:17.231  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:17.231  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Cancelled in-flight API_VERSIONS request with correlation id 22 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:17.272  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.272  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1954 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:17.277  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.278  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1945 due to node 1 being disconnected (elapsed time since creation: 0ms, elapsed time since send: 0ms, request timeout: 30000ms)
2022-11-20 21:08:17.319  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.319  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1946 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:17.332  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:17.332  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Cancelled in-flight API_VERSIONS request with correlation id 23 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:17.373  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.375  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1955 due to node 1 being disconnected (elapsed time since creation: 0ms, elapsed time since send: 0ms, request timeout: 30000ms)
2022-11-20 21:08:17.379  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.379  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1946 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:17.420  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.421  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1947 due to node 1 being disconnected (elapsed time since creation: 0ms, elapsed time since send: 0ms, request timeout: 30000ms)
2022-11-20 21:08:17.433  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:17.434  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Cancelled in-flight API_VERSIONS request with correlation id 24 due to node 1 being disconnected (elapsed time since creation: 0ms, elapsed time since send: 0ms, request timeout: 30000ms)
2022-11-20 21:08:17.474  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.474  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1956 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:17.482  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.484  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1947 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:17.521  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.522  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1948 due to node 1 being disconnected (elapsed time since creation: 0ms, elapsed time since send: 0ms, request timeout: 30000ms)
2022-11-20 21:08:17.534  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:17.535  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Cancelled in-flight API_VERSIONS request with correlation id 25 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:17.576  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.577  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1957 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:17.583  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.584  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1948 due to node 1 being disconnected (elapsed time since creation: 0ms, elapsed time since send: 0ms, request timeout: 30000ms)
2022-11-20 21:08:17.622  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.625  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1949 due to node 1 being disconnected (elapsed time since creation: 0ms, elapsed time since send: 0ms, request timeout: 30000ms)
2022-11-20 21:08:17.636  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:17.636  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Cancelled in-flight API_VERSIONS request with correlation id 26 due to node 1 being disconnected (elapsed time since creation: 0ms, elapsed time since send: 0ms, request timeout: 30000ms)
2022-11-20 21:08:17.677  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.678  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1958 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:17.684  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.685  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1949 due to node 1 being disconnected (elapsed time since creation: 0ms, elapsed time since send: 0ms, request timeout: 30000ms)
2022-11-20 21:08:17.724  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.724  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1950 due to node 1 being disconnected (elapsed time since creation: 0ms, elapsed time since send: 0ms, request timeout: 30000ms)
2022-11-20 21:08:17.736  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:17.737  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Cancelled in-flight API_VERSIONS request with correlation id 27 due to node 1 being disconnected (elapsed time since creation: 0ms, elapsed time since send: 0ms, request timeout: 30000ms)
2022-11-20 21:08:17.778  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.778  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1959 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, request timeout: 30000ms)
2022-11-20 21:08:17.784  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.785  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1950 due to node 1 being disconnected (elapsed time since creation: 0ms, elapsed time since send: 0ms, request timeout: 30000ms)
2022-11-20 21:08:17.825  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.825  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Cancelled in-flight API_VERSIONS request with correlation id 1951 due to node 1 being disconnected (elapsed time since creation: 0ms, elapsed time since send: 0ms, request timeout: 30000ms)
2022-11-20 21:08:17.837  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:17.837  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Cancelled in-flight API_VERSIONS request with correlation id 28 due to node 1 being disconnected (elapsed time since creation: 0ms, elapsed time since send: 0ms, request timeout: 30000ms)
2022-11-20 21:08:17.880  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.880  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:17.885  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.885  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:17.925  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.925  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:17.966  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:17.968  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:17.981  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:17.982  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:18.036  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:18.037  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:18.078  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:18.079  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:18.118  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:18.118  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:18.233  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:18.234  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:18.288  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:18.290  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:18.329  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:18.329  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:18.371  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:18.375  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:18.585  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:18.585  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:18.740  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:18.740  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:18.774  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:18.774  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:18.781  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:18.781  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:19.289  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:19.290  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:19.543  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:19.544  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:19.633  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:19.633  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:19.635  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:19.636  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:20.194  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:20.194  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:20.589  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:20.589  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:20.740  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:20.741  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:20.748  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:20.750  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:21.348  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:21.348  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:21.652  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:21.652  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:21.744  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:21.745  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:21.747  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:21.747  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:22.200  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:22.201  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:22.705  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:22.706  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:22.907  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:22.908  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:22.948  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:22.948  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:23.205  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:23.205  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:23.760  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:23.760  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:24.003  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:24.004  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:24.018  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:24.019  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:24.310  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:24.310  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:24.615  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:24.616  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:25.210  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:25.210  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:25.232  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:25.233  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:25.417  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:25.417  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:25.821  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:25.821  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:26.114  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:26.115  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:26.343  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:26.344  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:26.623  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:26.624  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:26.877  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:26.877  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:27.202  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:27.203  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:27.220  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:27.220  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:27.731  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:27.731  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:28.086  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:28.087  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:28.162  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:28.163  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:28.276  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:28.277  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:28.636  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:28.636  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:28.991  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:28.992  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:29.230  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:29.231  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:29.371  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:29.372  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:29.792  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:29.793  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:30.147  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:30.147  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:30.281  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:30.283  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:30.286  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:30.286  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:30.797  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:30.798  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:31.204  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:31.204  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:31.243  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:31.244  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:31.292  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:31.293  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:31.954  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:31.955  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:32.211  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:32.212  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:32.249  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:32.249  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:32.405  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:32.406  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:32.809  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:32.810  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:33.356  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:33.357  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:33.365  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:33.366  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:33.417  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:33.417  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:33.715  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:33.716  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:34.262  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:34.263  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:34.327  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:34.329  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:34.421  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:34.422  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:34.821  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:34.822  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:35.119  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:35.119  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:35.339  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:35.340  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:35.375  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:35.376  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:35.928  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:35.929  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:35.974  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:35.974  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:36.449  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:36.450  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:36.532  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:36.532  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:36.982  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:36.982  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:37.085  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:37.086  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:37.386  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:37.387  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:37.609  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:37.609  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:37.938  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:37.938  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:38.141  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:38.141  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:38.191  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:38.192  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:38.515  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:38.516  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:38.942  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:38.942  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:39.043  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:39.044  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:39.143  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:39.144  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:39.368  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:39.368  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:39.795  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:39.795  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:40.045  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:40.045  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:40.246  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:40.246  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:40.371  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:40.371  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:40.798  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:40.798  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:40.948  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:40.948  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:41.275  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:41.276  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:41.349  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:41.349  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:41.700  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:41.700  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:41.851  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:41.852  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:42.329  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:42.329  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:42.452  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:42.452  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:42.602  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:42.602  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:42.703  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:42.703  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:43.385  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:43.386  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:43.505  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:43.506  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:43.556  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:43.557  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:43.757  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:43.758  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:44.544  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:44.545  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:44.661  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:44.662  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:44.711  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:44.711  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:44.811  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:44.812  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:45.322  INFO [EMAIL-SERVICE,,] 101817 --- [Thread-2] o.s.c.s.a.z.ZipkinAutoConfiguration      : Flushing remaining spans on shutdown
2022-11-20 21:08:45.399  INFO [PAYMENT-SERVICE,,] 97471 --- [Thread-2] o.s.c.s.a.z.ZipkinAutoConfiguration      : Flushing remaining spans on shutdown
2022-11-20 21:08:45.564  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node 1 disconnected.
2022-11-20 21:08:45.565  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:45.701  INFO [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node 1 disconnected.
2022-11-20 21:08:45.702  WARN [PAYMENT-SERVICE,,] 97471 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:45.815  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node 1 disconnected.
2022-11-20 21:08:45.816  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:45.866  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node 1 disconnected.
2022-11-20 21:08:45.866  WARN [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-11-20 21:08:46.001  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Revoke previously assigned partitions payment_complete-0
2022-11-20 21:08:46.000  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Revoke previously assigned partitions order_topics-0
2022-11-20 21:08:46.001  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Revoke previously assigned partitions customer_topic-0
2022-11-20 21:08:46.007  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions revoked: [order_topics-0]
2022-11-20 21:08:46.008  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions revoked: [payment_complete-0]
2022-11-20 21:08:46.009  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions revoked: [customer_topic-0]
2022-11-20 21:08:46.039  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-20 21:08:46.039  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-20 21:08:46.039  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-20 21:08:46.039  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-2, groupId=email] Unsubscribed all topics or patterns and assigned partitions
2022-11-20 21:08:46.039  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-20 21:08:46.040  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-20 21:08:46.040  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Unsubscribed all topics or patterns and assigned partitions
2022-11-20 21:08:46.039  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-20 21:08:46.040  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-1, groupId=email] Unsubscribed all topics or patterns and assigned partitions
2022-11-20 21:08:46.052  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-20 21:08:46.058  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-20 21:08:46.058  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-20 21:08:46.058  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-20 21:08:46.059  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-20 21:08:46.059  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-20 21:08:46.071  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-20 21:08:46.071  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-20 21:08:46.071  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-20 21:08:46.071  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-20 21:08:46.071  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-20 21:08:46.072  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-20 21:08:46.082  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-20 21:08:46.082  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-20 21:08:46.082  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-20 21:08:46.103  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-email-1 unregistered
2022-11-20 21:08:46.107  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-email-2 unregistered
2022-11-20 21:08:46.109  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: Consumer stopped
2022-11-20 21:08:46.111  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-email-3 unregistered
2022-11-20 21:08:46.111  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: Consumer stopped
2022-11-20 21:08:46.122  INFO [EMAIL-SERVICE,,] 101817 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: Consumer stopped
2022-11-20 21:08:46.428  INFO [PAYMENT-SERVICE,,] 97471 --- [SpringApplicationShutdownHook] o.a.k.clients.producer.KafkaProducer     : [Producer clientId=producer-1] Closing the Kafka producer with timeoutMillis = 30000 ms.
2022-11-20 21:08:46.468  INFO [PAYMENT-SERVICE,,] 97471 --- [SpringApplicationShutdownHook] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-20 21:08:46.468  INFO [PAYMENT-SERVICE,,] 97471 --- [SpringApplicationShutdownHook] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-20 21:08:46.468  INFO [PAYMENT-SERVICE,,] 97471 --- [SpringApplicationShutdownHook] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-20 21:08:46.473  INFO [PAYMENT-SERVICE,,] 97471 --- [SpringApplicationShutdownHook] o.a.kafka.common.utils.AppInfoParser     : App info kafka.producer for producer-1 unregistered
2022-11-21 20:17:03.163  INFO [PAYMENT-SERVICE,,] 26018 --- [main] c.a.p.PaymentServiceApplication          : Starting PaymentServiceApplication using Java 19.0.1 on aditya-ASUS-TUF-Gaming-F15-FX506LI-FX566LI with PID 26018 (/home/aditya/Downloads/Ecommerce-ordering-service/payment-service/target/classes started by aditya in /home/aditya/Downloads/Ecommerce-ordering-service)
2022-11-21 20:17:03.164  INFO [PAYMENT-SERVICE,,] 26018 --- [main] c.a.p.PaymentServiceApplication          : No active profile set, falling back to 1 default profile: "default"
2022-11-21 20:17:04.048  INFO [PAYMENT-SERVICE,,] 26018 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data MongoDB repositories in DEFAULT mode.
2022-11-21 20:17:04.100  INFO [PAYMENT-SERVICE,,] 26018 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 45 ms. Found 1 MongoDB repository interfaces.
2022-11-21 20:17:04.299  INFO [PAYMENT-SERVICE,,] 26018 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=b1b13a09-739e-3717-ab4d-988ae38aef0f
2022-11-21 20:17:04.935  INFO [PAYMENT-SERVICE,,] 26018 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8086 (http)
2022-11-21 20:17:04.950  INFO [PAYMENT-SERVICE,,] 26018 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-21 20:17:04.951  INFO [PAYMENT-SERVICE,,] 26018 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.68]
2022-11-21 20:17:05.059  INFO [PAYMENT-SERVICE,,] 26018 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-21 20:17:05.060  INFO [PAYMENT-SERVICE,,] 26018 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1865 ms
2022-11-21 20:17:05.676  INFO [PAYMENT-SERVICE,,] 26018 --- [cluster-ClusterId{value='637b8f691a3a0529e3275c65', description='null'}-srv-cluster0.rckqz.mongodb.net] org.mongodb.driver.cluster               : Adding discovered server cluster0-shard-00-02.rckqz.mongodb.net:27017 to client view of cluster
2022-11-21 20:17:05.681  INFO [PAYMENT-SERVICE,,] 26018 --- [main] org.mongodb.driver.client                : MongoClient with metadata {"driver": {"name": "mongo-java-driver|sync|spring-boot", "version": "4.6.1"}, "os": {"type": "Linux", "name": "Linux", "architecture": "amd64", "version": "5.15.0-53-generic"}, "platform": "Java/Oracle Corporation/19.0.1+10-21"} created with settings MongoClientSettings{readPreference=primary, writeConcern=WriteConcern{w=majority, wTimeout=null ms, journal=null}, retryWrites=true, retryReads=true, readConcern=ReadConcern{level=null}, credential=MongoCredential{mechanism=null, userName='user1', source='admin', password=<hidden>, mechanismProperties=<hidden>}, streamFactoryFactory=null, commandListeners=[org.springframework.cloud.sleuth.instrument.mongodb.TraceMongoCommandListener@6b1321b7], codecRegistry=ProvidersCodecRegistry{codecProviders=[ValueCodecProvider{}, BsonValueCodecProvider{}, DBRefCodecProvider{}, DBObjectCodecProvider{}, DocumentCodecProvider{}, IterableCodecProvider{}, MapCodecProvider{}, GeoJsonCodecProvider{}, GridFSFileCodecProvider{}, Jsr310CodecProvider{}, JsonObjectCodecProvider{}, BsonCodecProvider{}, EnumCodecProvider{}, com.mongodb.Jep395RecordCodecProvider@342ee097]}, clusterSettings={hosts=[127.0.0.1:27017], srvHost=cluster0.rckqz.mongodb.net, srvServiceName=mongodb, mode=MULTIPLE, requiredClusterType=REPLICA_SET, requiredReplicaSetName='atlas-tp1paz-shard-0', serverSelector='null', clusterListeners='[]', serverSelectionTimeout='30000 ms', localThreshold='30000 ms'}, socketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=0, receiveBufferSize=0, sendBufferSize=0}, heartbeatSocketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=10000, receiveBufferSize=0, sendBufferSize=0}, connectionPoolSettings=ConnectionPoolSettings{maxSize=100, minSize=0, maxWaitTimeMS=120000, maxConnectionLifeTimeMS=0, maxConnectionIdleTimeMS=0, maintenanceInitialDelayMS=0, maintenanceFrequencyMS=60000, connectionPoolListeners=[], maxConnecting=2}, serverSettings=ServerSettings{heartbeatFrequencyMS=10000, minHeartbeatFrequencyMS=500, serverListeners='[]', serverMonitorListeners='[]'}, sslSettings=SslSettings{enabled=true, invalidHostNameAllowed=false, context=null}, applicationName='null', compressorList=[], uuidRepresentation=JAVA_LEGACY, serverApi=null, autoEncryptionSettings=null, contextProvider=org.springframework.cloud.sleuth.instrument.mongodb.TraceSynchronousMongoClientSettingsBuilderCustomizer$$Lambda$687/0x000000080145c630@6ac45c0c}
2022-11-21 20:17:05.698  INFO [PAYMENT-SERVICE,,] 26018 --- [cluster-ClusterId{value='637b8f691a3a0529e3275c65', description='null'}-srv-cluster0.rckqz.mongodb.net] org.mongodb.driver.cluster               : Adding discovered server cluster0-shard-00-01.rckqz.mongodb.net:27017 to client view of cluster
2022-11-21 20:17:05.699  INFO [PAYMENT-SERVICE,,] 26018 --- [cluster-ClusterId{value='637b8f691a3a0529e3275c65', description='null'}-srv-cluster0.rckqz.mongodb.net] org.mongodb.driver.cluster               : Adding discovered server cluster0-shard-00-00.rckqz.mongodb.net:27017 to client view of cluster
2022-11-21 20:17:06.168  INFO [PAYMENT-SERVICE,,] 26018 --- [cluster-rtt-ClusterId{value='637b8f691a3a0529e3275c65', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:4, serverValue:3962}] to cluster0-shard-00-01.rckqz.mongodb.net:27017
2022-11-21 20:17:06.168  INFO [PAYMENT-SERVICE,,] 26018 --- [cluster-ClusterId{value='637b8f691a3a0529e3275c65', description='null'}-cluster0-shard-00-02.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:5, serverValue:3156}] to cluster0-shard-00-02.rckqz.mongodb.net:27017
2022-11-21 20:17:06.168  INFO [PAYMENT-SERVICE,,] 26018 --- [cluster-ClusterId{value='637b8f691a3a0529e3275c65', description='null'}-cluster0-shard-00-00.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:2, serverValue:3912}] to cluster0-shard-00-00.rckqz.mongodb.net:27017
2022-11-21 20:17:06.168  INFO [PAYMENT-SERVICE,,] 26018 --- [cluster-ClusterId{value='637b8f691a3a0529e3275c65', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:3, serverValue:3894}] to cluster0-shard-00-01.rckqz.mongodb.net:27017
2022-11-21 20:17:06.168  INFO [PAYMENT-SERVICE,,] 26018 --- [cluster-rtt-ClusterId{value='637b8f691a3a0529e3275c65', description='null'}-cluster0-shard-00-00.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:6, serverValue:3912}] to cluster0-shard-00-00.rckqz.mongodb.net:27017
2022-11-21 20:17:06.169  INFO [PAYMENT-SERVICE,,] 26018 --- [cluster-ClusterId{value='637b8f691a3a0529e3275c65', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=cluster0-shard-00-01.rckqz.mongodb.net:27017, type=REPLICA_SET_PRIMARY, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=13, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=256359554, setName='atlas-tp1paz-shard-0', canonicalAddress=cluster0-shard-00-01.rckqz.mongodb.net:27017, hosts=[cluster0-shard-00-02.rckqz.mongodb.net:27017, cluster0-shard-00-01.rckqz.mongodb.net:27017, cluster0-shard-00-00.rckqz.mongodb.net:27017], passives=[], arbiters=[], primary='cluster0-shard-00-01.rckqz.mongodb.net:27017', tagSet=TagSet{[Tag{name='nodeType', value='ELECTABLE'}, Tag{name='provider', value='AWS'}, Tag{name='region', value='AP_SOUTH_1'}, Tag{name='workloadType', value='OPERATIONAL'}]}, electionId=7fffffff0000000000000143, setVersion=7, topologyVersion=TopologyVersion{processId=637b74cc1a363b602e2fc62e, counter=6}, lastWriteDate=Mon Nov 21 20:17:06 IST 2022, lastUpdateTimeNanos=3722641095196}
2022-11-21 20:17:06.168  INFO [PAYMENT-SERVICE,,] 26018 --- [cluster-rtt-ClusterId{value='637b8f691a3a0529e3275c65', description='null'}-cluster0-shard-00-02.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:1, serverValue:3156}] to cluster0-shard-00-02.rckqz.mongodb.net:27017
2022-11-21 20:17:06.169  INFO [PAYMENT-SERVICE,,] 26018 --- [cluster-ClusterId{value='637b8f691a3a0529e3275c65', description='null'}-cluster0-shard-00-00.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=cluster0-shard-00-00.rckqz.mongodb.net:27017, type=REPLICA_SET_SECONDARY, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=13, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=264288619, setName='atlas-tp1paz-shard-0', canonicalAddress=cluster0-shard-00-00.rckqz.mongodb.net:27017, hosts=[cluster0-shard-00-02.rckqz.mongodb.net:27017, cluster0-shard-00-01.rckqz.mongodb.net:27017, cluster0-shard-00-00.rckqz.mongodb.net:27017], passives=[], arbiters=[], primary='cluster0-shard-00-01.rckqz.mongodb.net:27017', tagSet=TagSet{[Tag{name='nodeType', value='ELECTABLE'}, Tag{name='provider', value='AWS'}, Tag{name='region', value='AP_SOUTH_1'}, Tag{name='workloadType', value='OPERATIONAL'}]}, electionId=null, setVersion=7, topologyVersion=TopologyVersion{processId=637b73da0126232d3ea0b1ce, counter=4}, lastWriteDate=Mon Nov 21 20:17:06 IST 2022, lastUpdateTimeNanos=3722641095194}
2022-11-21 20:17:06.169  INFO [PAYMENT-SERVICE,,] 26018 --- [cluster-ClusterId{value='637b8f691a3a0529e3275c65', description='null'}-cluster0-shard-00-02.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=cluster0-shard-00-02.rckqz.mongodb.net:27017, type=REPLICA_SET_SECONDARY, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=13, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=259654384, setName='atlas-tp1paz-shard-0', canonicalAddress=cluster0-shard-00-02.rckqz.mongodb.net:27017, hosts=[cluster0-shard-00-02.rckqz.mongodb.net:27017, cluster0-shard-00-01.rckqz.mongodb.net:27017, cluster0-shard-00-00.rckqz.mongodb.net:27017], passives=[], arbiters=[], primary='cluster0-shard-00-01.rckqz.mongodb.net:27017', tagSet=TagSet{[Tag{name='nodeType', value='ELECTABLE'}, Tag{name='provider', value='AWS'}, Tag{name='region', value='AP_SOUTH_1'}, Tag{name='workloadType', value='OPERATIONAL'}]}, electionId=null, setVersion=7, topologyVersion=TopologyVersion{processId=637b75e1c106e2311860ce01, counter=3}, lastWriteDate=Mon Nov 21 20:17:06 IST 2022, lastUpdateTimeNanos=3722641133947}
2022-11-21 20:17:06.172  INFO [PAYMENT-SERVICE,,] 26018 --- [cluster-ClusterId{value='637b8f691a3a0529e3275c65', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Setting max election id to 7fffffff0000000000000143 from replica set primary cluster0-shard-00-01.rckqz.mongodb.net:27017
2022-11-21 20:17:06.172  INFO [PAYMENT-SERVICE,,] 26018 --- [cluster-ClusterId{value='637b8f691a3a0529e3275c65', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Setting max set version to 7 from replica set primary cluster0-shard-00-01.rckqz.mongodb.net:27017
2022-11-21 20:17:06.172  INFO [PAYMENT-SERVICE,,] 26018 --- [cluster-ClusterId{value='637b8f691a3a0529e3275c65', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Discovered replica set primary cluster0-shard-00-01.rckqz.mongodb.net:27017
2022-11-21 20:17:06.898  INFO [PAYMENT-SERVICE,,] 26018 --- [main] o.a.k.clients.admin.AdminClientConfig    : AdminClientConfig values: 
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	client.id = 
	connections.max.idle.ms = 300000
	default.api.timeout.ms = 60000
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS

2022-11-21 20:17:07.033  INFO [PAYMENT-SERVICE,,] 26018 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-21 20:17:07.034  INFO [PAYMENT-SERVICE,,] 26018 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-21 20:17:07.034  INFO [PAYMENT-SERVICE,,] 26018 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1669042027032
2022-11-21 20:17:07.372  INFO [PAYMENT-SERVICE,,] 26018 --- [kafka-admin-client-thread | adminclient-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.admin.client for adminclient-1 unregistered
2022-11-21 20:17:07.377  INFO [PAYMENT-SERVICE,,] 26018 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-21 20:17:07.377  INFO [PAYMENT-SERVICE,,] 26018 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-21 20:17:07.377  INFO [PAYMENT-SERVICE,,] 26018 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-21 20:17:07.396  INFO [PAYMENT-SERVICE,,] 26018 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8086 (http) with context path ''
2022-11-21 20:17:07.421  INFO [PAYMENT-SERVICE,,] 26018 --- [main] c.a.p.PaymentServiceApplication          : Started PaymentServiceApplication in 4.681 seconds (JVM running for 4.962)
2022-11-21 20:17:23.937  INFO [EMAIL-SERVICE,,] 26218 --- [main] c.a.e.EmailServiceApplication            : Starting EmailServiceApplication using Java 19.0.1 on aditya-ASUS-TUF-Gaming-F15-FX506LI-FX566LI with PID 26218 (/home/aditya/Downloads/Ecommerce-ordering-service/email-service/target/classes started by aditya in /home/aditya/Downloads/Ecommerce-ordering-service)
2022-11-21 20:17:23.941  INFO [EMAIL-SERVICE,,] 26218 --- [main] c.a.e.EmailServiceApplication            : No active profile set, falling back to 1 default profile: "default"
2022-11-21 20:17:24.531  INFO [EMAIL-SERVICE,,] 26218 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data MongoDB repositories in DEFAULT mode.
2022-11-21 20:17:24.538  INFO [EMAIL-SERVICE,,] 26218 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 3 ms. Found 0 MongoDB repository interfaces.
2022-11-21 20:17:24.691  INFO [EMAIL-SERVICE,,] 26218 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=d620a4fc-e5f9-3ec2-ab20-28674c7b93cf
2022-11-21 20:17:25.252  INFO [EMAIL-SERVICE,,] 26218 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8084 (http)
2022-11-21 20:17:25.268  INFO [EMAIL-SERVICE,,] 26218 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-21 20:17:25.270  INFO [EMAIL-SERVICE,,] 26218 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.68]
2022-11-21 20:17:25.435  INFO [EMAIL-SERVICE,,] 26218 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-21 20:17:25.436  INFO [EMAIL-SERVICE,,] 26218 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1426 ms
2022-11-21 20:17:26.557  INFO [EMAIL-SERVICE,,] 26218 --- [cluster-ClusterId{value='637b8f7e5125004661977eeb', description='null'}-localhost:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server localhost:27017

com.mongodb.MongoSocketOpenException: Exception opening socket
	at com.mongodb.internal.connection.SocketStream.open(SocketStream.java:70) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.InternalStreamConnection.open(InternalStreamConnection.java:180) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:193) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:157) ~[mongodb-driver-core-4.6.1.jar:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:535) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:585) ~[na:na]
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:666) ~[na:na]
	at com.mongodb.internal.connection.SocketStreamHelper.initialize(SocketStreamHelper.java:107) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.SocketStream.initializeSocket(SocketStream.java:79) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.SocketStream.open(SocketStream.java:65) ~[mongodb-driver-core-4.6.1.jar:na]
	... 4 common frames omitted

2022-11-21 20:17:26.560  INFO [EMAIL-SERVICE,,] 26218 --- [main] org.mongodb.driver.client                : MongoClient with metadata {"driver": {"name": "mongo-java-driver|sync|spring-boot", "version": "4.6.1"}, "os": {"type": "Linux", "name": "Linux", "architecture": "amd64", "version": "5.15.0-53-generic"}, "platform": "Java/Oracle Corporation/19.0.1+10-21"} created with settings MongoClientSettings{readPreference=primary, writeConcern=WriteConcern{w=null, wTimeout=null ms, journal=null}, retryWrites=true, retryReads=true, readConcern=ReadConcern{level=null}, credential=null, streamFactoryFactory=null, commandListeners=[org.springframework.cloud.sleuth.instrument.mongodb.TraceMongoCommandListener@58b97c15], codecRegistry=ProvidersCodecRegistry{codecProviders=[ValueCodecProvider{}, BsonValueCodecProvider{}, DBRefCodecProvider{}, DBObjectCodecProvider{}, DocumentCodecProvider{}, IterableCodecProvider{}, MapCodecProvider{}, GeoJsonCodecProvider{}, GridFSFileCodecProvider{}, Jsr310CodecProvider{}, JsonObjectCodecProvider{}, BsonCodecProvider{}, EnumCodecProvider{}, com.mongodb.Jep395RecordCodecProvider@26994c6a]}, clusterSettings={hosts=[localhost:27017], srvServiceName=mongodb, mode=SINGLE, requiredClusterType=UNKNOWN, requiredReplicaSetName='null', serverSelector='null', clusterListeners='[]', serverSelectionTimeout='30000 ms', localThreshold='30000 ms'}, socketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=0, receiveBufferSize=0, sendBufferSize=0}, heartbeatSocketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=10000, receiveBufferSize=0, sendBufferSize=0}, connectionPoolSettings=ConnectionPoolSettings{maxSize=100, minSize=0, maxWaitTimeMS=120000, maxConnectionLifeTimeMS=0, maxConnectionIdleTimeMS=0, maintenanceInitialDelayMS=0, maintenanceFrequencyMS=60000, connectionPoolListeners=[], maxConnecting=2}, serverSettings=ServerSettings{heartbeatFrequencyMS=10000, minHeartbeatFrequencyMS=500, serverListeners='[]', serverMonitorListeners='[]'}, sslSettings=SslSettings{enabled=false, invalidHostNameAllowed=false, context=null}, applicationName='null', compressorList=[], uuidRepresentation=JAVA_LEGACY, serverApi=null, autoEncryptionSettings=null, contextProvider=org.springframework.cloud.sleuth.instrument.mongodb.TraceSynchronousMongoClientSettingsBuilderCustomizer$$Lambda$836/0x00000008014a5220@3cd46491}
2022-11-21 20:17:27.203  INFO [EMAIL-SERVICE,,] 26218 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-email-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = email
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2022-11-21 20:17:27.322  INFO [EMAIL-SERVICE,,] 26218 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-21 20:17:27.323  INFO [EMAIL-SERVICE,,] 26218 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-21 20:17:27.323  INFO [EMAIL-SERVICE,,] 26218 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1669042047322
2022-11-21 20:17:27.326  INFO [EMAIL-SERVICE,,] 26218 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-1, groupId=email] Subscribed to topic(s): order_topics
2022-11-21 20:17:27.331  INFO [EMAIL-SERVICE,,] 26218 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-email-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = email
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2022-11-21 20:17:27.336  INFO [EMAIL-SERVICE,,] 26218 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-21 20:17:27.337  INFO [EMAIL-SERVICE,,] 26218 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-21 20:17:27.337  INFO [EMAIL-SERVICE,,] 26218 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1669042047336
2022-11-21 20:17:27.337  INFO [EMAIL-SERVICE,,] 26218 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-2, groupId=email] Subscribed to topic(s): customer_topic
2022-11-21 20:17:27.339  INFO [EMAIL-SERVICE,,] 26218 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-email-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = email
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2022-11-21 20:17:27.344  INFO [EMAIL-SERVICE,,] 26218 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-21 20:17:27.345  INFO [EMAIL-SERVICE,,] 26218 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-21 20:17:27.345  INFO [EMAIL-SERVICE,,] 26218 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1669042047344
2022-11-21 20:17:27.345  INFO [EMAIL-SERVICE,,] 26218 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Subscribed to topic(s): payment_complete
2022-11-21 20:17:27.357  INFO [EMAIL-SERVICE,,] 26218 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8084 (http) with context path ''
2022-11-21 20:17:27.395  INFO [EMAIL-SERVICE,,] 26218 --- [main] c.a.e.EmailServiceApplication            : Started EmailServiceApplication in 3.901 seconds (JVM running for 4.278)
2022-11-21 20:17:27.638  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-2, groupId=email] Resetting the last seen epoch of partition customer_topic-0 to 0 since the associated topicId changed from null to tKr50QVbTM2_exfwcWm5Og
2022-11-21 20:17:27.638  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-1, groupId=email] Resetting the last seen epoch of partition order_topics-0 to 0 since the associated topicId changed from null to WFpyU0BqR5-w7pCovYKThg
2022-11-21 20:17:27.640  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-3, groupId=email] Resetting the last seen epoch of partition payment_complete-0 to 0 since the associated topicId changed from null to lXK061VOTzqVujfWi-KIWg
2022-11-21 20:17:27.643  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-2, groupId=email] Cluster ID: N6_RKQEzRKyebGgdHnjA8Q
2022-11-21 20:17:27.643  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-1, groupId=email] Cluster ID: N6_RKQEzRKyebGgdHnjA8Q
2022-11-21 20:17:27.643  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-3, groupId=email] Cluster ID: N6_RKQEzRKyebGgdHnjA8Q
2022-11-21 20:17:27.649  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-21 20:17:27.649  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-21 20:17:27.649  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-21 20:17:27.652  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] (Re-)joining group
2022-11-21 20:17:27.653  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] (Re-)joining group
2022-11-21 20:17:27.652  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] (Re-)joining group
2022-11-21 20:17:27.729  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Request joining group due to: need to re-join with the given member-id
2022-11-21 20:17:27.730  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] (Re-)joining group
2022-11-21 20:17:27.731  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Request joining group due to: need to re-join with the given member-id
2022-11-21 20:17:27.731  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] (Re-)joining group
2022-11-21 20:17:27.733  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Request joining group due to: need to re-join with the given member-id
2022-11-21 20:17:27.734  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] (Re-)joining group
2022-11-21 20:17:30.772  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Successfully joined group with generation Generation{generationId=12, memberId='consumer-email-2-2f1c4228-2dd6-42c7-b673-14b3a28c0bc6', protocol='range'}
2022-11-21 20:17:30.780  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Successfully joined group with generation Generation{generationId=12, memberId='consumer-email-3-67fe0f1c-769e-4dbf-b102-33d6c60be30d', protocol='range'}
2022-11-21 20:17:30.786  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Successfully joined group with generation Generation{generationId=12, memberId='consumer-email-1-bd9b05dd-f216-4d1d-ae04-60a3e53bc1f8', protocol='range'}
2022-11-21 20:17:30.859  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-3, groupId=email] Resetting the last seen epoch of partition order_topics-0 to 0 since the associated topicId changed from null to WFpyU0BqR5-w7pCovYKThg
2022-11-21 20:17:30.859  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-email-3, groupId=email] Resetting the last seen epoch of partition customer_topic-0 to 0 since the associated topicId changed from null to tKr50QVbTM2_exfwcWm5Og
2022-11-21 20:17:30.861  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Finished assignment for group at generation 12: {consumer-email-2-2f1c4228-2dd6-42c7-b673-14b3a28c0bc6=Assignment(partitions=[customer_topic-0]), consumer-email-3-67fe0f1c-769e-4dbf-b102-33d6c60be30d=Assignment(partitions=[payment_complete-0]), consumer-email-1-bd9b05dd-f216-4d1d-ae04-60a3e53bc1f8=Assignment(partitions=[order_topics-0])}
2022-11-21 20:17:30.929  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Successfully synced group in generation Generation{generationId=12, memberId='consumer-email-2-2f1c4228-2dd6-42c7-b673-14b3a28c0bc6', protocol='range'}
2022-11-21 20:17:30.930  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Notifying assignor about the new Assignment(partitions=[customer_topic-0])
2022-11-21 20:17:30.931  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Successfully synced group in generation Generation{generationId=12, memberId='consumer-email-1-bd9b05dd-f216-4d1d-ae04-60a3e53bc1f8', protocol='range'}
2022-11-21 20:17:30.932  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Notifying assignor about the new Assignment(partitions=[order_topics-0])
2022-11-21 20:17:30.932  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Successfully synced group in generation Generation{generationId=12, memberId='consumer-email-3-67fe0f1c-769e-4dbf-b102-33d6c60be30d', protocol='range'}
2022-11-21 20:17:30.933  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Notifying assignor about the new Assignment(partitions=[payment_complete-0])
2022-11-21 20:17:30.933  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Adding newly assigned partitions: order_topics-0
2022-11-21 20:17:30.934  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Adding newly assigned partitions: payment_complete-0
2022-11-21 20:17:30.934  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Adding newly assigned partitions: customer_topic-0
2022-11-21 20:17:30.947  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Found no committed offset for partition customer_topic-0
2022-11-21 20:17:30.951  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Setting offset for partition order_topics-0 to the committed offset FetchPosition{offset=6, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2022-11-21 20:17:30.953  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions assigned: [order_topics-0]
2022-11-21 20:17:30.954  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Setting offset for partition payment_complete-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2022-11-21 20:17:30.954  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions assigned: [payment_complete-0]
2022-11-21 20:17:30.968  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.SubscriptionState    : [Consumer clientId=consumer-email-2, groupId=email] Resetting offset for partition customer_topic-0 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}.
2022-11-21 20:17:30.969  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions assigned: [customer_topic-0]
2022-11-21 20:17:34.619  INFO [ELASTIC-SERVICE,,] 26391 --- [main] c.adirn.esservice.EsServiceApplication   : Starting EsServiceApplication using Java 19.0.1 on aditya-ASUS-TUF-Gaming-F15-FX506LI-FX566LI with PID 26391 (/home/aditya/Downloads/Ecommerce-ordering-service/es-service/target/classes started by aditya in /home/aditya/Downloads/Ecommerce-ordering-service)
2022-11-21 20:17:34.623  INFO [ELASTIC-SERVICE,,] 26391 --- [main] c.adirn.esservice.EsServiceApplication   : No active profile set, falling back to 1 default profile: "default"
2022-11-21 20:17:35.209  INFO [ELASTIC-SERVICE,,] 26391 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2022-11-21 20:17:35.210  INFO [ELASTIC-SERVICE,,] 26391 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Elasticsearch repositories in DEFAULT mode.
2022-11-21 20:17:35.255  INFO [ELASTIC-SERVICE,,] 26391 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 41 ms. Found 2 Elasticsearch repository interfaces.
2022-11-21 20:17:35.356  INFO [ELASTIC-SERVICE,,] 26391 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2022-11-21 20:17:35.357  INFO [ELASTIC-SERVICE,,] 26391 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Reactive Elasticsearch repositories in DEFAULT mode.
2022-11-21 20:17:35.361  INFO [ELASTIC-SERVICE,,] 26391 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 4 ms. Found 0 Reactive Elasticsearch repository interfaces.
2022-11-21 20:17:35.476  INFO [ELASTIC-SERVICE,,] 26391 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2022-11-21 20:17:35.477  INFO [ELASTIC-SERVICE,,] 26391 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data MongoDB repositories in DEFAULT mode.
2022-11-21 20:17:35.479  INFO [ELASTIC-SERVICE,,] 26391 --- [main] .RepositoryConfigurationExtensionSupport : Spring Data MongoDB - Could not safely identify store assignment for repository candidate interface com.adirn.esservice.repository.CustomerRepo; If you want this repository to be a MongoDB repository, consider annotating your entities with one of these annotations: org.springframework.data.mongodb.core.mapping.Document (preferred), or consider extending one of the following types with your repository: org.springframework.data.mongodb.repository.MongoRepository
2022-11-21 20:17:35.480  INFO [ELASTIC-SERVICE,,] 26391 --- [main] .RepositoryConfigurationExtensionSupport : Spring Data MongoDB - Could not safely identify store assignment for repository candidate interface com.adirn.esservice.repository.OrderEventRepo; If you want this repository to be a MongoDB repository, consider annotating your entities with one of these annotations: org.springframework.data.mongodb.core.mapping.Document (preferred), or consider extending one of the following types with your repository: org.springframework.data.mongodb.repository.MongoRepository
2022-11-21 20:17:35.480  INFO [ELASTIC-SERVICE,,] 26391 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 3 ms. Found 0 MongoDB repository interfaces.
2022-11-21 20:17:35.682  INFO [ELASTIC-SERVICE,,] 26391 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=3c423339-7521-328d-a021-050b8e90d4ce
2022-11-21 20:17:36.214  INFO [ELASTIC-SERVICE,,] 26391 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8085 (http)
2022-11-21 20:17:36.226  INFO [ELASTIC-SERVICE,,] 26391 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-21 20:17:36.226  INFO [ELASTIC-SERVICE,,] 26391 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.68]
2022-11-21 20:17:36.317  INFO [ELASTIC-SERVICE,,] 26391 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-21 20:17:36.317  INFO [ELASTIC-SERVICE,,] 26391 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1629 ms
2022-11-21 20:17:37.278  WARN [ELASTIC-SERVICE,,] 26391 --- [I/O dispatcher 1] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:17:37.294  WARN [ELASTIC-SERVICE,,] 26391 --- [main] org.elasticsearch.client.RestClient      : request [HEAD http://localhost:9200/customer] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:17:37.376  WARN [ELASTIC-SERVICE,,] 26391 --- [main] org.elasticsearch.client.RestClient      : request [HEAD http://localhost:9200/order] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:17:38.218  INFO [ELASTIC-SERVICE,,] 26391 --- [cluster-ClusterId{value='637b8f8a31c03d5dd1a79c6e', description='null'}-localhost:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server localhost:27017

com.mongodb.MongoSocketOpenException: Exception opening socket
	at com.mongodb.internal.connection.SocketStream.open(SocketStream.java:70) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.InternalStreamConnection.open(InternalStreamConnection.java:180) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:193) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:157) ~[mongodb-driver-core-4.6.1.jar:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:535) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:585) ~[na:na]
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:666) ~[na:na]
	at com.mongodb.internal.connection.SocketStreamHelper.initialize(SocketStreamHelper.java:107) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.SocketStream.initializeSocket(SocketStream.java:79) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.SocketStream.open(SocketStream.java:65) ~[mongodb-driver-core-4.6.1.jar:na]
	... 4 common frames omitted

2022-11-21 20:17:38.222  INFO [ELASTIC-SERVICE,,] 26391 --- [main] org.mongodb.driver.client                : MongoClient with metadata {"driver": {"name": "mongo-java-driver|sync|spring-boot", "version": "4.6.1"}, "os": {"type": "Linux", "name": "Linux", "architecture": "amd64", "version": "5.15.0-53-generic"}, "platform": "Java/Oracle Corporation/19.0.1+10-21"} created with settings MongoClientSettings{readPreference=primary, writeConcern=WriteConcern{w=null, wTimeout=null ms, journal=null}, retryWrites=true, retryReads=true, readConcern=ReadConcern{level=null}, credential=null, streamFactoryFactory=null, commandListeners=[org.springframework.cloud.sleuth.instrument.mongodb.TraceMongoCommandListener@10a064bd], codecRegistry=ProvidersCodecRegistry{codecProviders=[ValueCodecProvider{}, BsonValueCodecProvider{}, DBRefCodecProvider{}, DBObjectCodecProvider{}, DocumentCodecProvider{}, IterableCodecProvider{}, MapCodecProvider{}, GeoJsonCodecProvider{}, GridFSFileCodecProvider{}, Jsr310CodecProvider{}, JsonObjectCodecProvider{}, BsonCodecProvider{}, EnumCodecProvider{}, com.mongodb.Jep395RecordCodecProvider@2de7fe0e]}, clusterSettings={hosts=[localhost:27017], srvServiceName=mongodb, mode=SINGLE, requiredClusterType=UNKNOWN, requiredReplicaSetName='null', serverSelector='null', clusterListeners='[]', serverSelectionTimeout='30000 ms', localThreshold='30000 ms'}, socketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=0, receiveBufferSize=0, sendBufferSize=0}, heartbeatSocketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=10000, receiveBufferSize=0, sendBufferSize=0}, connectionPoolSettings=ConnectionPoolSettings{maxSize=100, minSize=0, maxWaitTimeMS=120000, maxConnectionLifeTimeMS=0, maxConnectionIdleTimeMS=0, maintenanceInitialDelayMS=0, maintenanceFrequencyMS=60000, connectionPoolListeners=[], maxConnecting=2}, serverSettings=ServerSettings{heartbeatFrequencyMS=10000, minHeartbeatFrequencyMS=500, serverListeners='[]', serverMonitorListeners='[]'}, sslSettings=SslSettings{enabled=false, invalidHostNameAllowed=false, context=null}, applicationName='null', compressorList=[], uuidRepresentation=JAVA_LEGACY, serverApi=null, autoEncryptionSettings=null, contextProvider=org.springframework.cloud.sleuth.instrument.mongodb.TraceSynchronousMongoClientSettingsBuilderCustomizer$$Lambda$1293/0x0000000801629020@2ff8d39b}
2022-11-21 20:17:38.289  WARN [ELASTIC-SERVICE,,] 26391 --- [main] o.s.data.convert.CustomConversions       : Registering converter from class java.time.LocalDateTime to class org.joda.time.LocalDateTime as reading converter although it doesn't convert from a store-supported type; You might want to check your annotation setup at the converter implementation
2022-11-21 20:17:38.325  WARN [ELASTIC-SERVICE,,] 26391 --- [main] o.s.data.convert.CustomConversions       : Registering converter from class java.time.LocalDateTime to class org.joda.time.LocalDateTime as reading converter although it doesn't convert from a store-supported type; You might want to check your annotation setup at the converter implementation
2022-11-21 20:17:38.797  INFO [ELASTIC-SERVICE,,] 26391 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = latest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-esconsumer-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = esconsumer
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2022-11-21 20:17:38.935  INFO [ELASTIC-SERVICE,,] 26391 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-21 20:17:38.939  INFO [ELASTIC-SERVICE,,] 26391 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-21 20:17:38.939  INFO [ELASTIC-SERVICE,,] 26391 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1669042058932
2022-11-21 20:17:38.942  INFO [ELASTIC-SERVICE,,] 26391 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Subscribed to topic(s): payment_complete
2022-11-21 20:17:38.978  INFO [ELASTIC-SERVICE,,] 26391 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = latest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-esconsumer-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = esconsumer
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2022-11-21 20:17:38.986  INFO [ELASTIC-SERVICE,,] 26391 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-21 20:17:38.987  INFO [ELASTIC-SERVICE,,] 26391 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-21 20:17:38.987  INFO [ELASTIC-SERVICE,,] 26391 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1669042058986
2022-11-21 20:17:38.988  INFO [ELASTIC-SERVICE,,] 26391 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Subscribed to topic(s): customer_topic
2022-11-21 20:17:38.990  INFO [ELASTIC-SERVICE,,] 26391 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = latest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-esconsumer-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = esconsumer
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2022-11-21 20:17:39.003  INFO [ELASTIC-SERVICE,,] 26391 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-21 20:17:39.003  INFO [ELASTIC-SERVICE,,] 26391 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-21 20:17:39.003  INFO [ELASTIC-SERVICE,,] 26391 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1669042059003
2022-11-21 20:17:39.004  INFO [ELASTIC-SERVICE,,] 26391 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Subscribed to topic(s): order_topics
2022-11-21 20:17:39.033  INFO [ELASTIC-SERVICE,,] 26391 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8085 (http) with context path ''
2022-11-21 20:17:39.090  INFO [ELASTIC-SERVICE,,] 26391 --- [main] c.adirn.esservice.EsServiceApplication   : Started EsServiceApplication in 4.951 seconds (JVM running for 5.262)
2022-11-21 20:17:39.392  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Resetting the last seen epoch of partition payment_complete-0 to 0 since the associated topicId changed from null to lXK061VOTzqVujfWi-KIWg
2022-11-21 20:17:39.392  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Resetting the last seen epoch of partition customer_topic-0 to 0 since the associated topicId changed from null to tKr50QVbTM2_exfwcWm5Og
2022-11-21 20:17:39.392  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Resetting the last seen epoch of partition order_topics-0 to 0 since the associated topicId changed from null to WFpyU0BqR5-w7pCovYKThg
2022-11-21 20:17:39.393  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Cluster ID: N6_RKQEzRKyebGgdHnjA8Q
2022-11-21 20:17:39.393  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Cluster ID: N6_RKQEzRKyebGgdHnjA8Q
2022-11-21 20:17:39.393  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Cluster ID: N6_RKQEzRKyebGgdHnjA8Q
2022-11-21 20:17:39.394  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-21 20:17:39.394  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-21 20:17:39.394  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-21 20:17:39.397  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] (Re-)joining group
2022-11-21 20:17:39.397  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] (Re-)joining group
2022-11-21 20:17:39.397  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] (Re-)joining group
2022-11-21 20:17:39.409  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Request joining group due to: need to re-join with the given member-id
2022-11-21 20:17:39.409  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Request joining group due to: need to re-join with the given member-id
2022-11-21 20:17:39.409  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Request joining group due to: need to re-join with the given member-id
2022-11-21 20:17:39.409  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] (Re-)joining group
2022-11-21 20:17:39.409  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] (Re-)joining group
2022-11-21 20:17:39.409  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] (Re-)joining group
2022-11-21 20:17:42.376  INFO [ORDER-SERVICE,,] 26524 --- [main] c.a.o.OrderServiceApplication            : Starting OrderServiceApplication using Java 19.0.1 on aditya-ASUS-TUF-Gaming-F15-FX506LI-FX566LI with PID 26524 (/home/aditya/Downloads/Ecommerce-ordering-service/order-service/target/classes started by aditya in /home/aditya/Downloads/Ecommerce-ordering-service)
2022-11-21 20:17:42.379  INFO [ORDER-SERVICE,,] 26524 --- [main] c.a.o.OrderServiceApplication            : No active profile set, falling back to 1 default profile: "default"
2022-11-21 20:17:42.417  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Successfully joined group with generation Generation{generationId=7, memberId='consumer-esconsumer-1-fb17f7af-8e3e-4cd2-9c4b-6605d6ca2573', protocol='range'}
2022-11-21 20:17:42.417  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Successfully joined group with generation Generation{generationId=7, memberId='consumer-esconsumer-3-fa8b9e0b-15bd-4ba1-b93d-4d3d94351775', protocol='range'}
2022-11-21 20:17:42.418  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Successfully joined group with generation Generation{generationId=7, memberId='consumer-esconsumer-2-88e1018f-46ff-4c95-b258-e406fe3d01a4', protocol='range'}
2022-11-21 20:17:42.467  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Resetting the last seen epoch of partition payment_complete-0 to 0 since the associated topicId changed from null to lXK061VOTzqVujfWi-KIWg
2022-11-21 20:17:42.469  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Resetting the last seen epoch of partition customer_topic-0 to 0 since the associated topicId changed from null to tKr50QVbTM2_exfwcWm5Og
2022-11-21 20:17:42.473  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Finished assignment for group at generation 7: {consumer-esconsumer-2-88e1018f-46ff-4c95-b258-e406fe3d01a4=Assignment(partitions=[customer_topic-0]), consumer-esconsumer-3-fa8b9e0b-15bd-4ba1-b93d-4d3d94351775=Assignment(partitions=[order_topics-0]), consumer-esconsumer-1-fb17f7af-8e3e-4cd2-9c4b-6605d6ca2573=Assignment(partitions=[payment_complete-0])}
2022-11-21 20:17:42.503  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Successfully synced group in generation Generation{generationId=7, memberId='consumer-esconsumer-1-fb17f7af-8e3e-4cd2-9c4b-6605d6ca2573', protocol='range'}
2022-11-21 20:17:42.503  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Notifying assignor about the new Assignment(partitions=[payment_complete-0])
2022-11-21 20:17:42.504  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Successfully synced group in generation Generation{generationId=7, memberId='consumer-esconsumer-2-88e1018f-46ff-4c95-b258-e406fe3d01a4', protocol='range'}
2022-11-21 20:17:42.504  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Notifying assignor about the new Assignment(partitions=[customer_topic-0])
2022-11-21 20:17:42.505  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Successfully synced group in generation Generation{generationId=7, memberId='consumer-esconsumer-3-fa8b9e0b-15bd-4ba1-b93d-4d3d94351775', protocol='range'}
2022-11-21 20:17:42.506  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Notifying assignor about the new Assignment(partitions=[order_topics-0])
2022-11-21 20:17:42.509  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Adding newly assigned partitions: customer_topic-0
2022-11-21 20:17:42.512  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Adding newly assigned partitions: order_topics-0
2022-11-21 20:17:42.509  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Adding newly assigned partitions: payment_complete-0
2022-11-21 20:17:42.537  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Setting offset for partition customer_topic-0 to the committed offset FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2022-11-21 20:17:42.537  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Setting offset for partition order_topics-0 to the committed offset FetchPosition{offset=6, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2022-11-21 20:17:42.539  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : esconsumer: partitions assigned: [customer_topic-0]
2022-11-21 20:17:42.539  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : esconsumer: partitions assigned: [order_topics-0]
2022-11-21 20:17:42.544  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Setting offset for partition payment_complete-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2022-11-21 20:17:42.545  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : esconsumer: partitions assigned: [payment_complete-0]
2022-11-21 20:17:43.217  INFO [ORDER-SERVICE,,] 26524 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data MongoDB repositories in DEFAULT mode.
2022-11-21 20:17:43.228  INFO [ORDER-SERVICE,,] 26524 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 6 ms. Found 0 MongoDB repository interfaces.
2022-11-21 20:17:43.392  INFO [ORDER-SERVICE,,] 26524 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=e37e6be0-5b3d-3953-8305-d6569d4665c4
2022-11-21 20:17:43.914  INFO [ORDER-SERVICE,,] 26524 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8082 (http)
2022-11-21 20:17:43.927  INFO [ORDER-SERVICE,,] 26524 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-21 20:17:43.927  INFO [ORDER-SERVICE,,] 26524 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.68]
2022-11-21 20:17:44.049  INFO [ORDER-SERVICE,,] 26524 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-21 20:17:44.050  INFO [ORDER-SERVICE,,] 26524 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1600 ms
2022-11-21 20:17:45.215  INFO [ORDER-SERVICE,,] 26524 --- [cluster-ClusterId{value='637b8f916415a071a92a0d4f', description='null'}-localhost:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server localhost:27017

com.mongodb.MongoSocketOpenException: Exception opening socket
	at com.mongodb.internal.connection.SocketStream.open(SocketStream.java:70) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.InternalStreamConnection.open(InternalStreamConnection.java:180) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:193) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:157) ~[mongodb-driver-core-4.6.1.jar:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:535) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:585) ~[na:na]
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:666) ~[na:na]
	at com.mongodb.internal.connection.SocketStreamHelper.initialize(SocketStreamHelper.java:107) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.SocketStream.initializeSocket(SocketStream.java:79) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.SocketStream.open(SocketStream.java:65) ~[mongodb-driver-core-4.6.1.jar:na]
	... 4 common frames omitted

2022-11-21 20:17:45.218  INFO [ORDER-SERVICE,,] 26524 --- [main] org.mongodb.driver.client                : MongoClient with metadata {"driver": {"name": "mongo-java-driver|sync|spring-boot", "version": "4.6.1"}, "os": {"type": "Linux", "name": "Linux", "architecture": "amd64", "version": "5.15.0-53-generic"}, "platform": "Java/Oracle Corporation/19.0.1+10-21"} created with settings MongoClientSettings{readPreference=primary, writeConcern=WriteConcern{w=null, wTimeout=null ms, journal=null}, retryWrites=true, retryReads=true, readConcern=ReadConcern{level=null}, credential=null, streamFactoryFactory=null, commandListeners=[org.springframework.cloud.sleuth.instrument.mongodb.TraceMongoCommandListener@438aaa9f], codecRegistry=ProvidersCodecRegistry{codecProviders=[ValueCodecProvider{}, BsonValueCodecProvider{}, DBRefCodecProvider{}, DBObjectCodecProvider{}, DocumentCodecProvider{}, IterableCodecProvider{}, MapCodecProvider{}, GeoJsonCodecProvider{}, GridFSFileCodecProvider{}, Jsr310CodecProvider{}, JsonObjectCodecProvider{}, BsonCodecProvider{}, EnumCodecProvider{}, com.mongodb.Jep395RecordCodecProvider@3f06ebe0]}, clusterSettings={hosts=[localhost:27017], srvServiceName=mongodb, mode=SINGLE, requiredClusterType=UNKNOWN, requiredReplicaSetName='null', serverSelector='null', clusterListeners='[]', serverSelectionTimeout='30000 ms', localThreshold='30000 ms'}, socketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=0, receiveBufferSize=0, sendBufferSize=0}, heartbeatSocketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=10000, receiveBufferSize=0, sendBufferSize=0}, connectionPoolSettings=ConnectionPoolSettings{maxSize=100, minSize=0, maxWaitTimeMS=120000, maxConnectionLifeTimeMS=0, maxConnectionIdleTimeMS=0, maintenanceInitialDelayMS=0, maintenanceFrequencyMS=60000, connectionPoolListeners=[], maxConnecting=2}, serverSettings=ServerSettings{heartbeatFrequencyMS=10000, minHeartbeatFrequencyMS=500, serverListeners='[]', serverMonitorListeners='[]'}, sslSettings=SslSettings{enabled=false, invalidHostNameAllowed=false, context=null}, applicationName='null', compressorList=[], uuidRepresentation=JAVA_LEGACY, serverApi=null, autoEncryptionSettings=null, contextProvider=org.springframework.cloud.sleuth.instrument.mongodb.TraceSynchronousMongoClientSettingsBuilderCustomizer$$Lambda$848/0x00000008014dec08@1752e45c}
2022-11-21 20:17:45.707  INFO [ORDER-SERVICE,,] 26524 --- [main] o.a.k.clients.admin.AdminClientConfig    : AdminClientConfig values: 
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	client.id = 
	connections.max.idle.ms = 300000
	default.api.timeout.ms = 60000
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS

2022-11-21 20:17:45.820  INFO [ORDER-SERVICE,,] 26524 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-21 20:17:45.821  INFO [ORDER-SERVICE,,] 26524 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-21 20:17:45.822  INFO [ORDER-SERVICE,,] 26524 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1669042065820
2022-11-21 20:17:46.178  INFO [ORDER-SERVICE,,] 26524 --- [kafka-admin-client-thread | adminclient-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.admin.client for adminclient-1 unregistered
2022-11-21 20:17:46.182  INFO [ORDER-SERVICE,,] 26524 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-21 20:17:46.182  INFO [ORDER-SERVICE,,] 26524 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-21 20:17:46.183  INFO [ORDER-SERVICE,,] 26524 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-21 20:17:46.201  INFO [ORDER-SERVICE,,] 26524 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8082 (http) with context path ''
2022-11-21 20:17:46.233  INFO [ORDER-SERVICE,,] 26524 --- [main] c.a.o.OrderServiceApplication            : Started OrderServiceApplication in 4.307 seconds (JVM running for 4.738)
2022-11-21 20:17:48.710  INFO [PRODUCT-SERVICE,,] 26680 --- [main] c.a.s.StockServiceApplication            : Starting StockServiceApplication using Java 19.0.1 on aditya-ASUS-TUF-Gaming-F15-FX506LI-FX566LI with PID 26680 (/home/aditya/Downloads/Ecommerce-ordering-service/stock-service/target/classes started by aditya in /home/aditya/Downloads/Ecommerce-ordering-service)
2022-11-21 20:17:48.712  INFO [PRODUCT-SERVICE,,] 26680 --- [main] c.a.s.StockServiceApplication            : No active profile set, falling back to 1 default profile: "default"
2022-11-21 20:17:49.462  INFO [PRODUCT-SERVICE,,] 26680 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2022-11-21 20:17:49.462  INFO [PRODUCT-SERVICE,,] 26680 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data MongoDB repositories in DEFAULT mode.
2022-11-21 20:17:49.547  INFO [PRODUCT-SERVICE,,] 26680 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 82 ms. Found 1 MongoDB repository interfaces.
2022-11-21 20:17:49.560  INFO [PRODUCT-SERVICE,,] 26680 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2022-11-21 20:17:49.561  INFO [PRODUCT-SERVICE,,] 26680 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-11-21 20:17:49.571  INFO [PRODUCT-SERVICE,,] 26680 --- [main] .RepositoryConfigurationExtensionSupport : Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.adirn.stockservice.repository.ProductRepo; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2022-11-21 20:17:49.571  INFO [PRODUCT-SERVICE,,] 26680 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2022-11-21 20:17:49.732  INFO [PRODUCT-SERVICE,,] 26680 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ff81fbc2-a2aa-38b6-b05b-6cc72c7a987e
2022-11-21 20:17:50.449  INFO [PRODUCT-SERVICE,,] 26680 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8083 (http)
2022-11-21 20:17:50.457  INFO [PRODUCT-SERVICE,,] 26680 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-21 20:17:50.458  INFO [PRODUCT-SERVICE,,] 26680 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.68]
2022-11-21 20:17:50.571  INFO [PRODUCT-SERVICE,,] 26680 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-21 20:17:50.571  INFO [PRODUCT-SERVICE,,] 26680 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1776 ms
2022-11-21 20:17:51.161  INFO [PRODUCT-SERVICE,,] 26680 --- [cluster-ClusterId{value='637b8f97c7eaca5f692d58a0', description='null'}-srv-cluster0.rckqz.mongodb.net] org.mongodb.driver.cluster               : Adding discovered server cluster0-shard-00-02.rckqz.mongodb.net:27017 to client view of cluster
2022-11-21 20:17:51.172  INFO [PRODUCT-SERVICE,,] 26680 --- [main] org.mongodb.driver.client                : MongoClient with metadata {"driver": {"name": "mongo-java-driver|sync|spring-boot", "version": "4.6.1"}, "os": {"type": "Linux", "name": "Linux", "architecture": "amd64", "version": "5.15.0-53-generic"}, "platform": "Java/Oracle Corporation/19.0.1+10-21"} created with settings MongoClientSettings{readPreference=primary, writeConcern=WriteConcern{w=majority, wTimeout=null ms, journal=null}, retryWrites=true, retryReads=true, readConcern=ReadConcern{level=null}, credential=MongoCredential{mechanism=null, userName='user1', source='admin', password=<hidden>, mechanismProperties=<hidden>}, streamFactoryFactory=null, commandListeners=[org.springframework.cloud.sleuth.instrument.mongodb.TraceMongoCommandListener@baa227e], codecRegistry=ProvidersCodecRegistry{codecProviders=[ValueCodecProvider{}, BsonValueCodecProvider{}, DBRefCodecProvider{}, DBObjectCodecProvider{}, DocumentCodecProvider{}, IterableCodecProvider{}, MapCodecProvider{}, GeoJsonCodecProvider{}, GridFSFileCodecProvider{}, Jsr310CodecProvider{}, JsonObjectCodecProvider{}, BsonCodecProvider{}, EnumCodecProvider{}, com.mongodb.Jep395RecordCodecProvider@351e89fc]}, clusterSettings={hosts=[127.0.0.1:27017], srvHost=cluster0.rckqz.mongodb.net, srvServiceName=mongodb, mode=MULTIPLE, requiredClusterType=REPLICA_SET, requiredReplicaSetName='atlas-tp1paz-shard-0', serverSelector='null', clusterListeners='[]', serverSelectionTimeout='30000 ms', localThreshold='30000 ms'}, socketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=0, receiveBufferSize=0, sendBufferSize=0}, heartbeatSocketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=10000, receiveBufferSize=0, sendBufferSize=0}, connectionPoolSettings=ConnectionPoolSettings{maxSize=100, minSize=0, maxWaitTimeMS=120000, maxConnectionLifeTimeMS=0, maxConnectionIdleTimeMS=0, maintenanceInitialDelayMS=0, maintenanceFrequencyMS=60000, connectionPoolListeners=[], maxConnecting=2}, serverSettings=ServerSettings{heartbeatFrequencyMS=10000, minHeartbeatFrequencyMS=500, serverListeners='[]', serverMonitorListeners='[]'}, sslSettings=SslSettings{enabled=true, invalidHostNameAllowed=false, context=null}, applicationName='null', compressorList=[], uuidRepresentation=JAVA_LEGACY, serverApi=null, autoEncryptionSettings=null, contextProvider=org.springframework.cloud.sleuth.instrument.mongodb.TraceSynchronousMongoClientSettingsBuilderCustomizer$$Lambda$767/0x00000008014c2a20@2b682e9}
2022-11-21 20:17:51.177  INFO [PRODUCT-SERVICE,,] 26680 --- [cluster-ClusterId{value='637b8f97c7eaca5f692d58a0', description='null'}-srv-cluster0.rckqz.mongodb.net] org.mongodb.driver.cluster               : Adding discovered server cluster0-shard-00-01.rckqz.mongodb.net:27017 to client view of cluster
2022-11-21 20:17:51.179  INFO [PRODUCT-SERVICE,,] 26680 --- [cluster-ClusterId{value='637b8f97c7eaca5f692d58a0', description='null'}-srv-cluster0.rckqz.mongodb.net] org.mongodb.driver.cluster               : Adding discovered server cluster0-shard-00-00.rckqz.mongodb.net:27017 to client view of cluster
2022-11-21 20:17:51.633  INFO [PRODUCT-SERVICE,,] 26680 --- [cluster-ClusterId{value='637b8f97c7eaca5f692d58a0', description='null'}-cluster0-shard-00-00.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:4, serverValue:3932}] to cluster0-shard-00-00.rckqz.mongodb.net:27017
2022-11-21 20:17:51.633  INFO [PRODUCT-SERVICE,,] 26680 --- [cluster-ClusterId{value='637b8f97c7eaca5f692d58a0', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:2, serverValue:3959}] to cluster0-shard-00-01.rckqz.mongodb.net:27017
2022-11-21 20:17:51.633  INFO [PRODUCT-SERVICE,,] 26680 --- [cluster-ClusterId{value='637b8f97c7eaca5f692d58a0', description='null'}-cluster0-shard-00-00.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=cluster0-shard-00-00.rckqz.mongodb.net:27017, type=REPLICA_SET_SECONDARY, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=13, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=249745678, setName='atlas-tp1paz-shard-0', canonicalAddress=cluster0-shard-00-00.rckqz.mongodb.net:27017, hosts=[cluster0-shard-00-02.rckqz.mongodb.net:27017, cluster0-shard-00-01.rckqz.mongodb.net:27017, cluster0-shard-00-00.rckqz.mongodb.net:27017], passives=[], arbiters=[], primary='cluster0-shard-00-01.rckqz.mongodb.net:27017', tagSet=TagSet{[Tag{name='nodeType', value='ELECTABLE'}, Tag{name='provider', value='AWS'}, Tag{name='region', value='AP_SOUTH_1'}, Tag{name='workloadType', value='OPERATIONAL'}]}, electionId=null, setVersion=7, topologyVersion=TopologyVersion{processId=637b73da0126232d3ea0b1ce, counter=4}, lastWriteDate=Mon Nov 21 20:17:51 IST 2022, lastUpdateTimeNanos=3768106149300}
2022-11-21 20:17:51.633  INFO [PRODUCT-SERVICE,,] 26680 --- [cluster-ClusterId{value='637b8f97c7eaca5f692d58a0', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=cluster0-shard-00-01.rckqz.mongodb.net:27017, type=REPLICA_SET_PRIMARY, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=13, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=258172922, setName='atlas-tp1paz-shard-0', canonicalAddress=cluster0-shard-00-01.rckqz.mongodb.net:27017, hosts=[cluster0-shard-00-02.rckqz.mongodb.net:27017, cluster0-shard-00-01.rckqz.mongodb.net:27017, cluster0-shard-00-00.rckqz.mongodb.net:27017], passives=[], arbiters=[], primary='cluster0-shard-00-01.rckqz.mongodb.net:27017', tagSet=TagSet{[Tag{name='nodeType', value='ELECTABLE'}, Tag{name='provider', value='AWS'}, Tag{name='region', value='AP_SOUTH_1'}, Tag{name='workloadType', value='OPERATIONAL'}]}, electionId=7fffffff0000000000000143, setVersion=7, topologyVersion=TopologyVersion{processId=637b74cc1a363b602e2fc62e, counter=6}, lastWriteDate=Mon Nov 21 20:17:51 IST 2022, lastUpdateTimeNanos=3768105422335}
2022-11-21 20:17:51.633  INFO [PRODUCT-SERVICE,,] 26680 --- [cluster-ClusterId{value='637b8f97c7eaca5f692d58a0', description='null'}-cluster0-shard-00-02.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:3, serverValue:3227}] to cluster0-shard-00-02.rckqz.mongodb.net:27017
2022-11-21 20:17:51.633  INFO [PRODUCT-SERVICE,,] 26680 --- [cluster-rtt-ClusterId{value='637b8f97c7eaca5f692d58a0', description='null'}-cluster0-shard-00-00.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:6, serverValue:3932}] to cluster0-shard-00-00.rckqz.mongodb.net:27017
2022-11-21 20:17:51.633  INFO [PRODUCT-SERVICE,,] 26680 --- [cluster-rtt-ClusterId{value='637b8f97c7eaca5f692d58a0', description='null'}-cluster0-shard-00-02.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:1, serverValue:3167}] to cluster0-shard-00-02.rckqz.mongodb.net:27017
2022-11-21 20:17:51.633  INFO [PRODUCT-SERVICE,,] 26680 --- [cluster-rtt-ClusterId{value='637b8f97c7eaca5f692d58a0', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:5, serverValue:3959}] to cluster0-shard-00-01.rckqz.mongodb.net:27017
2022-11-21 20:17:51.635  INFO [PRODUCT-SERVICE,,] 26680 --- [cluster-ClusterId{value='637b8f97c7eaca5f692d58a0', description='null'}-cluster0-shard-00-02.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=cluster0-shard-00-02.rckqz.mongodb.net:27017, type=REPLICA_SET_SECONDARY, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=13, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=252934744, setName='atlas-tp1paz-shard-0', canonicalAddress=cluster0-shard-00-02.rckqz.mongodb.net:27017, hosts=[cluster0-shard-00-02.rckqz.mongodb.net:27017, cluster0-shard-00-01.rckqz.mongodb.net:27017, cluster0-shard-00-00.rckqz.mongodb.net:27017], passives=[], arbiters=[], primary='cluster0-shard-00-01.rckqz.mongodb.net:27017', tagSet=TagSet{[Tag{name='nodeType', value='ELECTABLE'}, Tag{name='provider', value='AWS'}, Tag{name='region', value='AP_SOUTH_1'}, Tag{name='workloadType', value='OPERATIONAL'}]}, electionId=null, setVersion=7, topologyVersion=TopologyVersion{processId=637b75e1c106e2311860ce01, counter=3}, lastWriteDate=Mon Nov 21 20:17:51 IST 2022, lastUpdateTimeNanos=3768105422293}
2022-11-21 20:17:51.636  INFO [PRODUCT-SERVICE,,] 26680 --- [cluster-ClusterId{value='637b8f97c7eaca5f692d58a0', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Setting max election id to 7fffffff0000000000000143 from replica set primary cluster0-shard-00-01.rckqz.mongodb.net:27017
2022-11-21 20:17:51.637  INFO [PRODUCT-SERVICE,,] 26680 --- [cluster-ClusterId{value='637b8f97c7eaca5f692d58a0', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Setting max set version to 7 from replica set primary cluster0-shard-00-01.rckqz.mongodb.net:27017
2022-11-21 20:17:51.637  INFO [PRODUCT-SERVICE,,] 26680 --- [cluster-ClusterId{value='637b8f97c7eaca5f692d58a0', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Discovered replica set primary cluster0-shard-00-01.rckqz.mongodb.net:27017
2022-11-21 20:17:52.742  INFO [PRODUCT-SERVICE,,] 26680 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8083 (http) with context path ''
2022-11-21 20:17:52.811  INFO [PRODUCT-SERVICE,,] 26680 --- [main] c.a.s.StockServiceApplication            : Started StockServiceApplication in 4.558 seconds (JVM running for 4.978)
2022-11-21 20:18:13.385  INFO [CUSTOMER-SERVICE,,] 26885 --- [main] c.a.c.CustomerServiceApplication         : Starting CustomerServiceApplication using Java 19.0.1 on aditya-ASUS-TUF-Gaming-F15-FX506LI-FX566LI with PID 26885 (/home/aditya/Downloads/Ecommerce-ordering-service/customer-service/target/classes started by aditya in /home/aditya/Downloads/Ecommerce-ordering-service)
2022-11-21 20:18:13.387  INFO [CUSTOMER-SERVICE,,] 26885 --- [main] c.a.c.CustomerServiceApplication         : No active profile set, falling back to 1 default profile: "default"
2022-11-21 20:18:14.064  INFO [CUSTOMER-SERVICE,,] 26885 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2022-11-21 20:18:14.065  INFO [CUSTOMER-SERVICE,,] 26885 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data MongoDB repositories in DEFAULT mode.
2022-11-21 20:18:14.162  INFO [CUSTOMER-SERVICE,,] 26885 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 94 ms. Found 1 MongoDB repository interfaces.
2022-11-21 20:18:14.174  INFO [CUSTOMER-SERVICE,,] 26885 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2022-11-21 20:18:14.175  INFO [CUSTOMER-SERVICE,,] 26885 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-11-21 20:18:14.183  INFO [CUSTOMER-SERVICE,,] 26885 --- [main] .RepositoryConfigurationExtensionSupport : Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.adirn.customerservice.repository.CustomerRepo; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2022-11-21 20:18:14.183  INFO [CUSTOMER-SERVICE,,] 26885 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2022-11-21 20:18:14.352  INFO [CUSTOMER-SERVICE,,] 26885 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=6d958173-e1b0-3488-b64c-2716ebd0c529
2022-11-21 20:18:14.899  INFO [CUSTOMER-SERVICE,,] 26885 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8081 (http)
2022-11-21 20:18:14.906  INFO [CUSTOMER-SERVICE,,] 26885 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-21 20:18:14.906  INFO [CUSTOMER-SERVICE,,] 26885 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.68]
2022-11-21 20:18:14.977  INFO [CUSTOMER-SERVICE,,] 26885 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-21 20:18:14.977  INFO [CUSTOMER-SERVICE,,] 26885 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1541 ms
2022-11-21 20:18:15.560  INFO [CUSTOMER-SERVICE,,] 26885 --- [cluster-ClusterId{value='637b8fafc87d9951f8f68a3f', description='null'}-srv-cluster0.rckqz.mongodb.net] org.mongodb.driver.cluster               : Adding discovered server cluster0-shard-00-02.rckqz.mongodb.net:27017 to client view of cluster
2022-11-21 20:18:15.635  INFO [CUSTOMER-SERVICE,,] 26885 --- [main] org.mongodb.driver.client                : MongoClient with metadata {"driver": {"name": "mongo-java-driver|sync|spring-boot", "version": "4.6.1"}, "os": {"type": "Linux", "name": "Linux", "architecture": "amd64", "version": "5.15.0-53-generic"}, "platform": "Java/Oracle Corporation/19.0.1+10-21"} created with settings MongoClientSettings{readPreference=primary, writeConcern=WriteConcern{w=majority, wTimeout=null ms, journal=null}, retryWrites=true, retryReads=true, readConcern=ReadConcern{level=null}, credential=MongoCredential{mechanism=null, userName='user1', source='admin', password=<hidden>, mechanismProperties=<hidden>}, streamFactoryFactory=null, commandListeners=[org.springframework.cloud.sleuth.instrument.mongodb.TraceMongoCommandListener@5f883d90], codecRegistry=ProvidersCodecRegistry{codecProviders=[ValueCodecProvider{}, BsonValueCodecProvider{}, DBRefCodecProvider{}, DBObjectCodecProvider{}, DocumentCodecProvider{}, IterableCodecProvider{}, MapCodecProvider{}, GeoJsonCodecProvider{}, GridFSFileCodecProvider{}, Jsr310CodecProvider{}, JsonObjectCodecProvider{}, BsonCodecProvider{}, EnumCodecProvider{}, com.mongodb.Jep395RecordCodecProvider@7e58f697]}, clusterSettings={hosts=[127.0.0.1:27017], srvHost=cluster0.rckqz.mongodb.net, srvServiceName=mongodb, mode=MULTIPLE, requiredClusterType=REPLICA_SET, requiredReplicaSetName='atlas-tp1paz-shard-0', serverSelector='null', clusterListeners='[]', serverSelectionTimeout='30000 ms', localThreshold='30000 ms'}, socketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=0, receiveBufferSize=0, sendBufferSize=0}, heartbeatSocketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=10000, receiveBufferSize=0, sendBufferSize=0}, connectionPoolSettings=ConnectionPoolSettings{maxSize=100, minSize=0, maxWaitTimeMS=120000, maxConnectionLifeTimeMS=0, maxConnectionIdleTimeMS=0, maintenanceInitialDelayMS=0, maintenanceFrequencyMS=60000, connectionPoolListeners=[], maxConnecting=2}, serverSettings=ServerSettings{heartbeatFrequencyMS=10000, minHeartbeatFrequencyMS=500, serverListeners='[]', serverMonitorListeners='[]'}, sslSettings=SslSettings{enabled=true, invalidHostNameAllowed=false, context=null}, applicationName='null', compressorList=[], uuidRepresentation=JAVA_LEGACY, serverApi=null, autoEncryptionSettings=null, contextProvider=org.springframework.cloud.sleuth.instrument.mongodb.TraceSynchronousMongoClientSettingsBuilderCustomizer$$Lambda$770/0x00000008014c3d78@44384b4a}
2022-11-21 20:18:15.661  INFO [CUSTOMER-SERVICE,,] 26885 --- [cluster-ClusterId{value='637b8fafc87d9951f8f68a3f', description='null'}-srv-cluster0.rckqz.mongodb.net] org.mongodb.driver.cluster               : Adding discovered server cluster0-shard-00-01.rckqz.mongodb.net:27017 to client view of cluster
2022-11-21 20:18:15.662  INFO [CUSTOMER-SERVICE,,] 26885 --- [cluster-ClusterId{value='637b8fafc87d9951f8f68a3f', description='null'}-srv-cluster0.rckqz.mongodb.net] org.mongodb.driver.cluster               : Adding discovered server cluster0-shard-00-00.rckqz.mongodb.net:27017 to client view of cluster
2022-11-21 20:18:15.985  INFO [CUSTOMER-SERVICE,,] 26885 --- [cluster-ClusterId{value='637b8fafc87d9951f8f68a3f', description='null'}-cluster0-shard-00-02.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:3, serverValue:3217}] to cluster0-shard-00-02.rckqz.mongodb.net:27017
2022-11-21 20:18:15.986  INFO [CUSTOMER-SERVICE,,] 26885 --- [cluster-ClusterId{value='637b8fafc87d9951f8f68a3f', description='null'}-cluster0-shard-00-00.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:5, serverValue:3925}] to cluster0-shard-00-00.rckqz.mongodb.net:27017
2022-11-21 20:18:15.986  INFO [CUSTOMER-SERVICE,,] 26885 --- [cluster-ClusterId{value='637b8fafc87d9951f8f68a3f', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:2, serverValue:4008}] to cluster0-shard-00-01.rckqz.mongodb.net:27017
2022-11-21 20:18:15.986  INFO [CUSTOMER-SERVICE,,] 26885 --- [cluster-rtt-ClusterId{value='637b8fafc87d9951f8f68a3f', description='null'}-cluster0-shard-00-02.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:4, serverValue:3217}] to cluster0-shard-00-02.rckqz.mongodb.net:27017
2022-11-21 20:18:15.986  INFO [CUSTOMER-SERVICE,,] 26885 --- [cluster-rtt-ClusterId{value='637b8fafc87d9951f8f68a3f', description='null'}-cluster0-shard-00-00.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:6, serverValue:3925}] to cluster0-shard-00-00.rckqz.mongodb.net:27017
2022-11-21 20:18:15.986  INFO [CUSTOMER-SERVICE,,] 26885 --- [cluster-ClusterId{value='637b8fafc87d9951f8f68a3f', description='null'}-cluster0-shard-00-02.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=cluster0-shard-00-02.rckqz.mongodb.net:27017, type=REPLICA_SET_SECONDARY, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=13, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=187260402, setName='atlas-tp1paz-shard-0', canonicalAddress=cluster0-shard-00-02.rckqz.mongodb.net:27017, hosts=[cluster0-shard-00-02.rckqz.mongodb.net:27017, cluster0-shard-00-01.rckqz.mongodb.net:27017, cluster0-shard-00-00.rckqz.mongodb.net:27017], passives=[], arbiters=[], primary='cluster0-shard-00-01.rckqz.mongodb.net:27017', tagSet=TagSet{[Tag{name='nodeType', value='ELECTABLE'}, Tag{name='provider', value='AWS'}, Tag{name='region', value='AP_SOUTH_1'}, Tag{name='workloadType', value='OPERATIONAL'}]}, electionId=null, setVersion=7, topologyVersion=TopologyVersion{processId=637b75e1c106e2311860ce01, counter=3}, lastWriteDate=Mon Nov 21 20:18:16 IST 2022, lastUpdateTimeNanos=3792458122201}
2022-11-21 20:18:15.986  INFO [CUSTOMER-SERVICE,,] 26885 --- [cluster-rtt-ClusterId{value='637b8fafc87d9951f8f68a3f', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:1, serverValue:3952}] to cluster0-shard-00-01.rckqz.mongodb.net:27017
2022-11-21 20:18:15.986  INFO [CUSTOMER-SERVICE,,] 26885 --- [cluster-ClusterId{value='637b8fafc87d9951f8f68a3f', description='null'}-cluster0-shard-00-00.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=cluster0-shard-00-00.rckqz.mongodb.net:27017, type=REPLICA_SET_SECONDARY, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=13, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=184592471, setName='atlas-tp1paz-shard-0', canonicalAddress=cluster0-shard-00-00.rckqz.mongodb.net:27017, hosts=[cluster0-shard-00-02.rckqz.mongodb.net:27017, cluster0-shard-00-01.rckqz.mongodb.net:27017, cluster0-shard-00-00.rckqz.mongodb.net:27017], passives=[], arbiters=[], primary='cluster0-shard-00-01.rckqz.mongodb.net:27017', tagSet=TagSet{[Tag{name='nodeType', value='ELECTABLE'}, Tag{name='provider', value='AWS'}, Tag{name='region', value='AP_SOUTH_1'}, Tag{name='workloadType', value='OPERATIONAL'}]}, electionId=null, setVersion=7, topologyVersion=TopologyVersion{processId=637b73da0126232d3ea0b1ce, counter=4}, lastWriteDate=Mon Nov 21 20:18:16 IST 2022, lastUpdateTimeNanos=3792459176609}
2022-11-21 20:18:15.986  INFO [CUSTOMER-SERVICE,,] 26885 --- [cluster-ClusterId{value='637b8fafc87d9951f8f68a3f', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=cluster0-shard-00-01.rckqz.mongodb.net:27017, type=REPLICA_SET_PRIMARY, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=13, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=184616798, setName='atlas-tp1paz-shard-0', canonicalAddress=cluster0-shard-00-01.rckqz.mongodb.net:27017, hosts=[cluster0-shard-00-02.rckqz.mongodb.net:27017, cluster0-shard-00-01.rckqz.mongodb.net:27017, cluster0-shard-00-00.rckqz.mongodb.net:27017], passives=[], arbiters=[], primary='cluster0-shard-00-01.rckqz.mongodb.net:27017', tagSet=TagSet{[Tag{name='nodeType', value='ELECTABLE'}, Tag{name='provider', value='AWS'}, Tag{name='region', value='AP_SOUTH_1'}, Tag{name='workloadType', value='OPERATIONAL'}]}, electionId=7fffffff0000000000000143, setVersion=7, topologyVersion=TopologyVersion{processId=637b74cc1a363b602e2fc62e, counter=6}, lastWriteDate=Mon Nov 21 20:18:16 IST 2022, lastUpdateTimeNanos=3792459242386}
2022-11-21 20:18:15.989  INFO [CUSTOMER-SERVICE,,] 26885 --- [cluster-ClusterId{value='637b8fafc87d9951f8f68a3f', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Setting max election id to 7fffffff0000000000000143 from replica set primary cluster0-shard-00-01.rckqz.mongodb.net:27017
2022-11-21 20:18:15.989  INFO [CUSTOMER-SERVICE,,] 26885 --- [cluster-ClusterId{value='637b8fafc87d9951f8f68a3f', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Setting max set version to 7 from replica set primary cluster0-shard-00-01.rckqz.mongodb.net:27017
2022-11-21 20:18:15.989  INFO [CUSTOMER-SERVICE,,] 26885 --- [cluster-ClusterId{value='637b8fafc87d9951f8f68a3f', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Discovered replica set primary cluster0-shard-00-01.rckqz.mongodb.net:27017
2022-11-21 20:18:17.067  INFO [CUSTOMER-SERVICE,,] 26885 --- [main] o.a.k.clients.admin.AdminClientConfig    : AdminClientConfig values: 
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	client.id = 
	connections.max.idle.ms = 300000
	default.api.timeout.ms = 60000
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS

2022-11-21 20:18:17.187  INFO [CUSTOMER-SERVICE,,] 26885 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-21 20:18:17.188  INFO [CUSTOMER-SERVICE,,] 26885 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-21 20:18:17.188  INFO [CUSTOMER-SERVICE,,] 26885 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1669042097186
2022-11-21 20:18:17.547  INFO [CUSTOMER-SERVICE,,] 26885 --- [kafka-admin-client-thread | adminclient-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.admin.client for adminclient-1 unregistered
2022-11-21 20:18:17.550  INFO [CUSTOMER-SERVICE,,] 26885 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-21 20:18:17.550  INFO [CUSTOMER-SERVICE,,] 26885 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-21 20:18:17.551  INFO [CUSTOMER-SERVICE,,] 26885 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-21 20:18:17.631  INFO [CUSTOMER-SERVICE,,] 26885 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8081 (http) with context path ''
2022-11-21 20:18:17.649  INFO [CUSTOMER-SERVICE,,] 26885 --- [main] c.a.c.CustomerServiceApplication         : Started CustomerServiceApplication in 4.689 seconds (JVM running for 5.077)
2022-11-21 20:18:52.479  INFO [ORDER-SERVICE,057553cbf96a218a,057553cbf96a218a] 26524 --- [http-nio-8082-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-11-21 20:18:52.480  INFO [ORDER-SERVICE,057553cbf96a218a,057553cbf96a218a] 26524 --- [http-nio-8082-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-11-21 20:18:52.481  INFO [ORDER-SERVICE,057553cbf96a218a,057553cbf96a218a] 26524 --- [http-nio-8082-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2022-11-21 20:20:04.671  INFO [ELASTIC-SERVICE,f2a12fb9869ca449,f2a12fb9869ca449] 26391 --- [http-nio-8085-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-11-21 20:20:04.678  INFO [ELASTIC-SERVICE,f2a12fb9869ca449,f2a12fb9869ca449] 26391 --- [http-nio-8085-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-11-21 20:20:04.688  INFO [ELASTIC-SERVICE,f2a12fb9869ca449,f2a12fb9869ca449] 26391 --- [http-nio-8085-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 9 ms
2022-11-21 20:20:04.815  WARN [ELASTIC-SERVICE,f2a12fb9869ca449,f2a12fb9869ca449] 26391 --- [http-nio-8085-exec-2] org.elasticsearch.client.RestClient      : request [DELETE http://localhost:9200/order/_doc/554cc88d-3473-4c55-9d2f-f030e854af5d?timeout=1m] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:20:04.850  WARN [ELASTIC-SERVICE,f2a12fb9869ca449,f2a12fb9869ca449] 26391 --- [http-nio-8085-exec-2] org.elasticsearch.client.RestClient      : request [POST http://localhost:9200/order/_refresh] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:21:13.039  INFO [ELASTIC-SERVICE,,] 26391 --- [Thread-2] o.s.c.s.a.z.ZipkinAutoConfiguration      : Flushing remaining spans on shutdown
2022-11-21 20:21:13.107  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Revoke previously assigned partitions customer_topic-0
2022-11-21 20:21:13.116  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Revoke previously assigned partitions order_topics-0
2022-11-21 20:21:13.116  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Revoke previously assigned partitions payment_complete-0
2022-11-21 20:21:13.117  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : esconsumer: partitions revoked: [customer_topic-0]
2022-11-21 20:21:13.124  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : esconsumer: partitions revoked: [order_topics-0]
2022-11-21 20:21:13.124  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : esconsumer: partitions revoked: [payment_complete-0]
2022-11-21 20:21:13.125  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Member consumer-esconsumer-1-fb17f7af-8e3e-4cd2-9c4b-6605d6ca2573 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2022-11-21 20:21:13.125  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Member consumer-esconsumer-2-88e1018f-46ff-4c95-b258-e406fe3d01a4 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2022-11-21 20:21:13.125  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Member consumer-esconsumer-3-fa8b9e0b-15bd-4ba1-b93d-4d3d94351775 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2022-11-21 20:21:13.127  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Resetting generation due to: consumer pro-actively leaving the group
2022-11-21 20:21:13.128  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Request joining group due to: consumer pro-actively leaving the group
2022-11-21 20:21:13.128  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Unsubscribed all topics or patterns and assigned partitions
2022-11-21 20:21:13.133  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Resetting generation due to: consumer pro-actively leaving the group
2022-11-21 20:21:13.133  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Resetting generation due to: consumer pro-actively leaving the group
2022-11-21 20:21:13.132  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Resetting generation due to: consumer pro-actively leaving the group
2022-11-21 20:21:13.133  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Request joining group due to: consumer pro-actively leaving the group
2022-11-21 20:21:13.133  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Request joining group due to: consumer pro-actively leaving the group
2022-11-21 20:21:13.133  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Request joining group due to: consumer pro-actively leaving the group
2022-11-21 20:21:13.133  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Unsubscribed all topics or patterns and assigned partitions
2022-11-21 20:21:13.133  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Unsubscribed all topics or patterns and assigned partitions
2022-11-21 20:21:13.134  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Resetting generation due to: consumer pro-actively leaving the group
2022-11-21 20:21:13.134  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Resetting generation due to: consumer pro-actively leaving the group
2022-11-21 20:21:13.134  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Request joining group due to: consumer pro-actively leaving the group
2022-11-21 20:21:13.134  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Request joining group due to: consumer pro-actively leaving the group
2022-11-21 20:21:13.175  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-21 20:21:13.175  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-21 20:21:13.175  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-21 20:21:13.175  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-21 20:21:13.175  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-21 20:21:13.175  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-21 20:21:13.176  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-21 20:21:13.177  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-21 20:21:13.178  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-21 20:21:13.192  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-esconsumer-2 unregistered
2022-11-21 20:21:13.193  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-esconsumer-1 unregistered
2022-11-21 20:21:13.193  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-esconsumer-3 unregistered
2022-11-21 20:21:13.202  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : esconsumer: Consumer stopped
2022-11-21 20:21:13.212  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : esconsumer: Consumer stopped
2022-11-21 20:21:13.207  INFO [ELASTIC-SERVICE,,] 26391 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : esconsumer: Consumer stopped
2022-11-21 20:21:18.251  INFO [ELASTIC-SERVICE,,] 27919 --- [main] c.adirn.esservice.EsServiceApplication   : Starting EsServiceApplication using Java 19.0.1 on aditya-ASUS-TUF-Gaming-F15-FX506LI-FX566LI with PID 27919 (/home/aditya/Downloads/Ecommerce-ordering-service/es-service/target/classes started by aditya in /home/aditya/Downloads/Ecommerce-ordering-service)
2022-11-21 20:21:18.253  INFO [ELASTIC-SERVICE,,] 27919 --- [main] c.adirn.esservice.EsServiceApplication   : No active profile set, falling back to 1 default profile: "default"
2022-11-21 20:21:18.756  INFO [ELASTIC-SERVICE,,] 27919 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2022-11-21 20:21:18.757  INFO [ELASTIC-SERVICE,,] 27919 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Elasticsearch repositories in DEFAULT mode.
2022-11-21 20:21:18.787  INFO [ELASTIC-SERVICE,,] 27919 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 26 ms. Found 2 Elasticsearch repository interfaces.
2022-11-21 20:21:18.889  INFO [ELASTIC-SERVICE,,] 27919 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2022-11-21 20:21:18.889  INFO [ELASTIC-SERVICE,,] 27919 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Reactive Elasticsearch repositories in DEFAULT mode.
2022-11-21 20:21:18.893  INFO [ELASTIC-SERVICE,,] 27919 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 3 ms. Found 0 Reactive Elasticsearch repository interfaces.
2022-11-21 20:21:19.014  INFO [ELASTIC-SERVICE,,] 27919 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2022-11-21 20:21:19.014  INFO [ELASTIC-SERVICE,,] 27919 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data MongoDB repositories in DEFAULT mode.
2022-11-21 20:21:19.017  INFO [ELASTIC-SERVICE,,] 27919 --- [main] .RepositoryConfigurationExtensionSupport : Spring Data MongoDB - Could not safely identify store assignment for repository candidate interface com.adirn.esservice.repository.CustomerRepo; If you want this repository to be a MongoDB repository, consider annotating your entities with one of these annotations: org.springframework.data.mongodb.core.mapping.Document (preferred), or consider extending one of the following types with your repository: org.springframework.data.mongodb.repository.MongoRepository
2022-11-21 20:21:19.018  INFO [ELASTIC-SERVICE,,] 27919 --- [main] .RepositoryConfigurationExtensionSupport : Spring Data MongoDB - Could not safely identify store assignment for repository candidate interface com.adirn.esservice.repository.OrderEventRepo; If you want this repository to be a MongoDB repository, consider annotating your entities with one of these annotations: org.springframework.data.mongodb.core.mapping.Document (preferred), or consider extending one of the following types with your repository: org.springframework.data.mongodb.repository.MongoRepository
2022-11-21 20:21:19.018  INFO [ELASTIC-SERVICE,,] 27919 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 3 ms. Found 0 MongoDB repository interfaces.
2022-11-21 20:21:19.174  INFO [ELASTIC-SERVICE,,] 27919 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=3c423339-7521-328d-a021-050b8e90d4ce
2022-11-21 20:21:19.796  INFO [ELASTIC-SERVICE,,] 27919 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8085 (http)
2022-11-21 20:21:19.831  INFO [ELASTIC-SERVICE,,] 27919 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-21 20:21:19.831  INFO [ELASTIC-SERVICE,,] 27919 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.68]
2022-11-21 20:21:20.507  INFO [ELASTIC-SERVICE,,] 27919 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-21 20:21:20.507  INFO [ELASTIC-SERVICE,,] 27919 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2210 ms
2022-11-21 20:21:23.081  WARN [ELASTIC-SERVICE,,] 27919 --- [I/O dispatcher 1] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:21:23.212  WARN [ELASTIC-SERVICE,,] 27919 --- [main] org.elasticsearch.client.RestClient      : request [HEAD http://localhost:9200/customer] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:21:23.291  WARN [ELASTIC-SERVICE,,] 27919 --- [main] org.elasticsearch.client.RestClient      : request [HEAD http://localhost:9200/order] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:21:25.178  INFO [ELASTIC-SERVICE,,] 27919 --- [main] org.mongodb.driver.client                : MongoClient with metadata {"driver": {"name": "mongo-java-driver|sync|spring-boot", "version": "4.6.1"}, "os": {"type": "Linux", "name": "Linux", "architecture": "amd64", "version": "5.15.0-53-generic"}, "platform": "Java/Oracle Corporation/19.0.1+10-21"} created with settings MongoClientSettings{readPreference=primary, writeConcern=WriteConcern{w=null, wTimeout=null ms, journal=null}, retryWrites=true, retryReads=true, readConcern=ReadConcern{level=null}, credential=null, streamFactoryFactory=null, commandListeners=[org.springframework.cloud.sleuth.instrument.mongodb.TraceMongoCommandListener@7be859de], codecRegistry=ProvidersCodecRegistry{codecProviders=[ValueCodecProvider{}, BsonValueCodecProvider{}, DBRefCodecProvider{}, DBObjectCodecProvider{}, DocumentCodecProvider{}, IterableCodecProvider{}, MapCodecProvider{}, GeoJsonCodecProvider{}, GridFSFileCodecProvider{}, Jsr310CodecProvider{}, JsonObjectCodecProvider{}, BsonCodecProvider{}, EnumCodecProvider{}, com.mongodb.Jep395RecordCodecProvider@40fcaae7]}, clusterSettings={hosts=[localhost:27017], srvServiceName=mongodb, mode=SINGLE, requiredClusterType=UNKNOWN, requiredReplicaSetName='null', serverSelector='null', clusterListeners='[]', serverSelectionTimeout='30000 ms', localThreshold='30000 ms'}, socketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=0, receiveBufferSize=0, sendBufferSize=0}, heartbeatSocketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=10000, receiveBufferSize=0, sendBufferSize=0}, connectionPoolSettings=ConnectionPoolSettings{maxSize=100, minSize=0, maxWaitTimeMS=120000, maxConnectionLifeTimeMS=0, maxConnectionIdleTimeMS=0, maintenanceInitialDelayMS=0, maintenanceFrequencyMS=60000, connectionPoolListeners=[], maxConnecting=2}, serverSettings=ServerSettings{heartbeatFrequencyMS=10000, minHeartbeatFrequencyMS=500, serverListeners='[]', serverMonitorListeners='[]'}, sslSettings=SslSettings{enabled=false, invalidHostNameAllowed=false, context=null}, applicationName='null', compressorList=[], uuidRepresentation=JAVA_LEGACY, serverApi=null, autoEncryptionSettings=null, contextProvider=org.springframework.cloud.sleuth.instrument.mongodb.TraceSynchronousMongoClientSettingsBuilderCustomizer$$Lambda$1293/0x000000080162de40@7fa85a55}
2022-11-21 20:21:25.192  INFO [ELASTIC-SERVICE,,] 27919 --- [cluster-ClusterId{value='637b906c2046f94c2ac5fcea', description='null'}-localhost:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server localhost:27017

com.mongodb.MongoSocketOpenException: Exception opening socket
	at com.mongodb.internal.connection.SocketStream.open(SocketStream.java:70) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.InternalStreamConnection.open(InternalStreamConnection.java:180) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:193) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:157) ~[mongodb-driver-core-4.6.1.jar:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:535) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:585) ~[na:na]
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:666) ~[na:na]
	at com.mongodb.internal.connection.SocketStreamHelper.initialize(SocketStreamHelper.java:107) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.SocketStream.initializeSocket(SocketStream.java:79) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.SocketStream.open(SocketStream.java:65) ~[mongodb-driver-core-4.6.1.jar:na]
	... 4 common frames omitted

2022-11-21 20:21:25.703  WARN [ELASTIC-SERVICE,,] 27919 --- [main] o.s.data.convert.CustomConversions       : Registering converter from class java.time.LocalDateTime to class org.joda.time.LocalDateTime as reading converter although it doesn't convert from a store-supported type; You might want to check your annotation setup at the converter implementation
2022-11-21 20:21:25.813  WARN [ELASTIC-SERVICE,,] 27919 --- [main] o.s.data.convert.CustomConversions       : Registering converter from class java.time.LocalDateTime to class org.joda.time.LocalDateTime as reading converter although it doesn't convert from a store-supported type; You might want to check your annotation setup at the converter implementation
2022-11-21 20:21:27.439  INFO [ELASTIC-SERVICE,,] 27919 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = latest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-esconsumer-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = esconsumer
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2022-11-21 20:21:28.553  INFO [ELASTIC-SERVICE,,] 27919 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-21 20:21:28.554  INFO [ELASTIC-SERVICE,,] 27919 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-21 20:21:28.554  INFO [ELASTIC-SERVICE,,] 27919 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1669042288552
2022-11-21 20:21:28.557  INFO [ELASTIC-SERVICE,,] 27919 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Subscribed to topic(s): payment_complete
2022-11-21 20:21:28.609  INFO [ELASTIC-SERVICE,,] 27919 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = latest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-esconsumer-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = esconsumer
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2022-11-21 20:21:28.623  INFO [ELASTIC-SERVICE,,] 27919 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-21 20:21:28.623  INFO [ELASTIC-SERVICE,,] 27919 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-21 20:21:28.623  INFO [ELASTIC-SERVICE,,] 27919 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1669042288623
2022-11-21 20:21:28.624  INFO [ELASTIC-SERVICE,,] 27919 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Subscribed to topic(s): customer_topic
2022-11-21 20:21:28.626  INFO [ELASTIC-SERVICE,,] 27919 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = latest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-esconsumer-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = esconsumer
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2022-11-21 20:21:28.636  INFO [ELASTIC-SERVICE,,] 27919 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-21 20:21:28.636  INFO [ELASTIC-SERVICE,,] 27919 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-21 20:21:28.636  INFO [ELASTIC-SERVICE,,] 27919 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1669042288636
2022-11-21 20:21:28.636  INFO [ELASTIC-SERVICE,,] 27919 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Subscribed to topic(s): order_topics
2022-11-21 20:21:28.771  INFO [ELASTIC-SERVICE,,] 27919 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8085 (http) with context path ''
2022-11-21 20:21:28.940  INFO [ELASTIC-SERVICE,,] 27919 --- [main] c.adirn.esservice.EsServiceApplication   : Started EsServiceApplication in 11.124 seconds (JVM running for 11.516)
2022-11-21 20:21:30.635  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Resetting the last seen epoch of partition payment_complete-0 to 0 since the associated topicId changed from null to lXK061VOTzqVujfWi-KIWg
2022-11-21 20:21:30.635  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Resetting the last seen epoch of partition customer_topic-0 to 0 since the associated topicId changed from null to tKr50QVbTM2_exfwcWm5Og
2022-11-21 20:21:30.635  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Resetting the last seen epoch of partition order_topics-0 to 0 since the associated topicId changed from null to WFpyU0BqR5-w7pCovYKThg
2022-11-21 20:21:30.643  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Cluster ID: N6_RKQEzRKyebGgdHnjA8Q
2022-11-21 20:21:30.643  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Cluster ID: N6_RKQEzRKyebGgdHnjA8Q
2022-11-21 20:21:30.643  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Cluster ID: N6_RKQEzRKyebGgdHnjA8Q
2022-11-21 20:21:30.700  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-21 20:21:30.701  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-21 20:21:30.705  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] (Re-)joining group
2022-11-21 20:21:30.705  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] (Re-)joining group
2022-11-21 20:21:30.717  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-21 20:21:30.719  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] (Re-)joining group
2022-11-21 20:21:30.940  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Request joining group due to: need to re-join with the given member-id
2022-11-21 20:21:30.940  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] (Re-)joining group
2022-11-21 20:21:30.940  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Request joining group due to: need to re-join with the given member-id
2022-11-21 20:21:30.941  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] (Re-)joining group
2022-11-21 20:21:30.946  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Request joining group due to: need to re-join with the given member-id
2022-11-21 20:21:30.947  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] (Re-)joining group
2022-11-21 20:21:34.082  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Successfully joined group with generation Generation{generationId=9, memberId='consumer-esconsumer-1-c1f962c7-5587-4c35-9694-7e848cfd96c3', protocol='range'}
2022-11-21 20:21:34.083  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Successfully joined group with generation Generation{generationId=9, memberId='consumer-esconsumer-3-659997c9-5499-4730-b203-e3725363a2e0', protocol='range'}
2022-11-21 20:21:34.083  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Successfully joined group with generation Generation{generationId=9, memberId='consumer-esconsumer-2-6bfe6157-6e3d-4166-8f5b-601a517e53db', protocol='range'}
2022-11-21 20:21:34.098  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Resetting the last seen epoch of partition payment_complete-0 to 0 since the associated topicId changed from null to lXK061VOTzqVujfWi-KIWg
2022-11-21 20:21:34.098  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Resetting the last seen epoch of partition customer_topic-0 to 0 since the associated topicId changed from null to tKr50QVbTM2_exfwcWm5Og
2022-11-21 20:21:34.100  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Finished assignment for group at generation 9: {consumer-esconsumer-1-c1f962c7-5587-4c35-9694-7e848cfd96c3=Assignment(partitions=[payment_complete-0]), consumer-esconsumer-3-659997c9-5499-4730-b203-e3725363a2e0=Assignment(partitions=[order_topics-0]), consumer-esconsumer-2-6bfe6157-6e3d-4166-8f5b-601a517e53db=Assignment(partitions=[customer_topic-0])}
2022-11-21 20:21:34.105  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Successfully synced group in generation Generation{generationId=9, memberId='consumer-esconsumer-3-659997c9-5499-4730-b203-e3725363a2e0', protocol='range'}
2022-11-21 20:21:34.105  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Successfully synced group in generation Generation{generationId=9, memberId='consumer-esconsumer-1-c1f962c7-5587-4c35-9694-7e848cfd96c3', protocol='range'}
2022-11-21 20:21:34.105  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Successfully synced group in generation Generation{generationId=9, memberId='consumer-esconsumer-2-6bfe6157-6e3d-4166-8f5b-601a517e53db', protocol='range'}
2022-11-21 20:21:34.106  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Notifying assignor about the new Assignment(partitions=[order_topics-0])
2022-11-21 20:21:34.106  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Notifying assignor about the new Assignment(partitions=[payment_complete-0])
2022-11-21 20:21:34.106  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Notifying assignor about the new Assignment(partitions=[customer_topic-0])
2022-11-21 20:21:34.107  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Adding newly assigned partitions: customer_topic-0
2022-11-21 20:21:34.107  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Adding newly assigned partitions: order_topics-0
2022-11-21 20:21:34.107  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Adding newly assigned partitions: payment_complete-0
2022-11-21 20:21:34.117  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Setting offset for partition payment_complete-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2022-11-21 20:21:34.118  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : esconsumer: partitions assigned: [payment_complete-0]
2022-11-21 20:21:34.122  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Setting offset for partition order_topics-0 to the committed offset FetchPosition{offset=6, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2022-11-21 20:21:34.122  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Setting offset for partition customer_topic-0 to the committed offset FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2022-11-21 20:21:34.122  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : esconsumer: partitions assigned: [order_topics-0]
2022-11-21 20:21:34.122  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : esconsumer: partitions assigned: [customer_topic-0]
2022-11-21 20:21:56.868  INFO [ELASTIC-SERVICE,4772ff528e33b15b,4772ff528e33b15b] 27919 --- [http-nio-8085-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-11-21 20:21:56.869  INFO [ELASTIC-SERVICE,4772ff528e33b15b,4772ff528e33b15b] 27919 --- [http-nio-8085-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-11-21 20:21:56.870  INFO [ELASTIC-SERVICE,4772ff528e33b15b,4772ff528e33b15b] 27919 --- [http-nio-8085-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2022-11-21 20:21:57.019  WARN [ELASTIC-SERVICE,4772ff528e33b15b,4772ff528e33b15b] 27919 --- [http-nio-8085-exec-2] org.elasticsearch.client.RestClient      : request [POST http://localhost:9200/order/_delete_by_query?slices=1&refresh=true&conflicts=proceed&requests_per_second=-1&wait_for_completion=true&timeout=1m] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:21:57.037  WARN [ELASTIC-SERVICE,4772ff528e33b15b,4772ff528e33b15b] 27919 --- [http-nio-8085-exec-2] org.elasticsearch.client.RestClient      : request [POST http://localhost:9200/order/_refresh] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:22:33.219 ERROR [ORDER-SERVICE,18e573a810b1c942,18e573a810b1c942] 26524 --- [http-nio-8082-exec-5] c.a.o.advice.MyControllerAdvice          : Request method 'DELETE' not supported
2022-11-21 20:22:44.039  INFO [CUSTOMER-SERVICE,7bd669154eabd0ff,15d886886e8e95ce] 26885 --- [http-nio-8081-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-11-21 20:22:44.052  INFO [CUSTOMER-SERVICE,7bd669154eabd0ff,15d886886e8e95ce] 26885 --- [http-nio-8081-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-11-21 20:22:44.065  INFO [CUSTOMER-SERVICE,7bd669154eabd0ff,15d886886e8e95ce] 26885 --- [http-nio-8081-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 12 ms
2022-11-21 20:22:45.120  INFO [CUSTOMER-SERVICE,7bd669154eabd0ff,15d886886e8e95ce] 26885 --- [http-nio-8081-exec-1] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:7, serverValue:3967}] to cluster0-shard-00-01.rckqz.mongodb.net:27017
2022-11-21 20:22:45.250  INFO [CUSTOMER-SERVICE,7bd669154eabd0ff,15d886886e8e95ce] 26885 --- [http-nio-8081-exec-1] c.a.c.controller.CustomerController      : Customer(id=1, name=Aditya, email=abc@gamil.com, age=26)
2022-11-21 20:22:46.232  INFO [PRODUCT-SERVICE,7bd669154eabd0ff,63c999855173dc87] 26680 --- [http-nio-8083-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-11-21 20:22:46.243  INFO [PRODUCT-SERVICE,7bd669154eabd0ff,63c999855173dc87] 26680 --- [http-nio-8083-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-11-21 20:22:46.254  INFO [PRODUCT-SERVICE,7bd669154eabd0ff,63c999855173dc87] 26680 --- [http-nio-8083-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 11 ms
2022-11-21 20:22:47.910  INFO [PRODUCT-SERVICE,7bd669154eabd0ff,63c999855173dc87] 26680 --- [http-nio-8083-exec-1] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:7, serverValue:4092}] to cluster0-shard-00-01.rckqz.mongodb.net:27017
2022-11-21 20:22:48.053  INFO [ORDER-SERVICE,7bd669154eabd0ff,7bd669154eabd0ff] 26524 --- [http-nio-8082-exec-7] c.a.orderservice.kafka.OrderProducer     : Order Event => OrderEvent(status=PENDING, message=Complete the payment, customer=Customer(id=1, name=Aditya, email=abc@gamil.com, age=26), order=Order(id=fb39758a-859f-4f63-b5ec-d01b67857b7d, cid=1, pid=3, qty=5), product=Product(id=3, name=speaker, price=100000.0, qtyavail=12))
2022-11-21 20:22:48.085  INFO [ORDER-SERVICE,7bd669154eabd0ff,7bd669154eabd0ff] 26524 --- [http-nio-8082-exec-7] o.a.k.clients.producer.ProducerConfig    : ProducerConfig values: 
	acks = -1
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-1
	compression.type = none
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.class = class org.apache.kafka.clients.producer.internals.DefaultPartitioner
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2022-11-21 20:22:48.123  INFO [ORDER-SERVICE,7bd669154eabd0ff,7bd669154eabd0ff] 26524 --- [http-nio-8082-exec-7] o.a.k.clients.producer.KafkaProducer     : [Producer clientId=producer-1] Instantiated an idempotent producer.
2022-11-21 20:22:48.163  INFO [ORDER-SERVICE,7bd669154eabd0ff,7bd669154eabd0ff] 26524 --- [http-nio-8082-exec-7] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-21 20:22:48.164  INFO [ORDER-SERVICE,7bd669154eabd0ff,7bd669154eabd0ff] 26524 --- [http-nio-8082-exec-7] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-21 20:22:48.164  INFO [ORDER-SERVICE,7bd669154eabd0ff,7bd669154eabd0ff] 26524 --- [http-nio-8082-exec-7] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1669042368163
2022-11-21 20:22:48.187  INFO [ORDER-SERVICE,,] 26524 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.Metadata        : [Producer clientId=producer-1] Cluster ID: N6_RKQEzRKyebGgdHnjA8Q
2022-11-21 20:22:48.195  INFO [ORDER-SERVICE,,] 26524 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.Metadata        : [Producer clientId=producer-1] Resetting the last seen epoch of partition order_topics-0 to 0 since the associated topicId changed from null to WFpyU0BqR5-w7pCovYKThg
2022-11-21 20:22:48.512  INFO [ORDER-SERVICE,,] 26524 --- [kafka-producer-network-thread | producer-1] o.a.k.c.p.internals.TransactionManager   : [Producer clientId=producer-1] ProducerId set to 3000 with epoch 0
2022-11-21 20:22:48.751  INFO [ELASTIC-SERVICE,7bd669154eabd0ff,77c5a04633169dde] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] com.adirn.esservice.kafka.EsConsumer     : Order event received in ES service => OrderEvent(status=PENDING, message=Complete the payment, customer=Customer(id=1, name=Aditya, email=abc@gamil.com, age=26), order=Order(id=fb39758a-859f-4f63-b5ec-d01b67857b7d, cid=1, pid=3, qty=5), product=Product(id=3, name=speaker, price=100000.0, qtyavail=12))
2022-11-21 20:22:48.865  WARN [ELASTIC-SERVICE,7bd669154eabd0ff,77c5a04633169dde] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.elasticsearch.client.RestClient      : request [PUT http://localhost:9200/order/_doc/fb39758a-859f-4f63-b5ec-d01b67857b7d?timeout=1m] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:22:48.932  WARN [ELASTIC-SERVICE,7bd669154eabd0ff,77c5a04633169dde] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.elasticsearch.client.RestClient      : request [POST http://localhost:9200/order/_refresh] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:22:48.932  INFO [ELASTIC-SERVICE,7bd669154eabd0ff,77c5a04633169dde] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] com.adirn.esservice.kafka.EsConsumer     : Saved Order event to es DB
2022-11-21 20:22:49.430  INFO [EMAIL-SERVICE,7bd669154eabd0ff,dc58cf119d1f5ae8] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => OrderEvent(status=PENDING, message=Complete the payment, customer=Customer(id=1, name=Aditya, email=abc@gamil.com, age=26), order=Order(id=fb39758a-859f-4f63-b5ec-d01b67857b7d, cid=1, pid=3, qty=5), product=Product(id=3, name=speaker, price=100000.0, qtyavail=12))
2022-11-21 20:24:28.354  INFO [ELASTIC-SERVICE,,] 27919 --- [Thread-2] o.s.c.s.a.z.ZipkinAutoConfiguration      : Flushing remaining spans on shutdown
2022-11-21 20:24:28.386  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Revoke previously assigned partitions customer_topic-0
2022-11-21 20:24:28.386  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Revoke previously assigned partitions order_topics-0
2022-11-21 20:24:28.386  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Revoke previously assigned partitions payment_complete-0
2022-11-21 20:24:28.387  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : esconsumer: partitions revoked: [customer_topic-0]
2022-11-21 20:24:28.387  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : esconsumer: partitions revoked: [order_topics-0]
2022-11-21 20:24:28.387  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : esconsumer: partitions revoked: [payment_complete-0]
2022-11-21 20:24:28.387  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Member consumer-esconsumer-2-6bfe6157-6e3d-4166-8f5b-601a517e53db sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2022-11-21 20:24:28.387  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Member consumer-esconsumer-1-c1f962c7-5587-4c35-9694-7e848cfd96c3 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2022-11-21 20:24:28.387  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Member consumer-esconsumer-3-659997c9-5499-4730-b203-e3725363a2e0 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2022-11-21 20:24:28.388  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Resetting generation due to: consumer pro-actively leaving the group
2022-11-21 20:24:28.388  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Resetting generation due to: consumer pro-actively leaving the group
2022-11-21 20:24:28.388  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Resetting generation due to: consumer pro-actively leaving the group
2022-11-21 20:24:28.388  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Request joining group due to: consumer pro-actively leaving the group
2022-11-21 20:24:28.388  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Request joining group due to: consumer pro-actively leaving the group
2022-11-21 20:24:28.388  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Request joining group due to: consumer pro-actively leaving the group
2022-11-21 20:24:28.388  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Unsubscribed all topics or patterns and assigned partitions
2022-11-21 20:24:28.388  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Unsubscribed all topics or patterns and assigned partitions
2022-11-21 20:24:28.388  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Unsubscribed all topics or patterns and assigned partitions
2022-11-21 20:24:28.400  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Resetting generation due to: consumer pro-actively leaving the group
2022-11-21 20:24:28.400  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Resetting generation due to: consumer pro-actively leaving the group
2022-11-21 20:24:28.400  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Resetting generation due to: consumer pro-actively leaving the group
2022-11-21 20:24:28.400  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Request joining group due to: consumer pro-actively leaving the group
2022-11-21 20:24:28.400  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Request joining group due to: consumer pro-actively leaving the group
2022-11-21 20:24:28.400  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Request joining group due to: consumer pro-actively leaving the group
2022-11-21 20:24:28.401  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-21 20:24:28.401  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-21 20:24:28.401  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-21 20:24:28.401  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-21 20:24:28.402  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-21 20:24:28.402  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-21 20:24:28.402  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-21 20:24:28.402  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-21 20:24:28.402  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-21 20:24:28.408  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-esconsumer-2 unregistered
2022-11-21 20:24:28.409  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-esconsumer-3 unregistered
2022-11-21 20:24:28.409  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-esconsumer-1 unregistered
2022-11-21 20:24:28.409  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : esconsumer: Consumer stopped
2022-11-21 20:24:28.409  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : esconsumer: Consumer stopped
2022-11-21 20:24:28.409  INFO [ELASTIC-SERVICE,,] 27919 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : esconsumer: Consumer stopped
2022-11-21 20:24:33.309  INFO [ELASTIC-SERVICE,,] 29062 --- [main] c.adirn.esservice.EsServiceApplication   : Starting EsServiceApplication using Java 19.0.1 on aditya-ASUS-TUF-Gaming-F15-FX506LI-FX566LI with PID 29062 (/home/aditya/Downloads/Ecommerce-ordering-service/es-service/target/classes started by aditya in /home/aditya/Downloads/Ecommerce-ordering-service)
2022-11-21 20:24:33.313  INFO [ELASTIC-SERVICE,,] 29062 --- [main] c.adirn.esservice.EsServiceApplication   : No active profile set, falling back to 1 default profile: "default"
2022-11-21 20:24:34.072  INFO [ELASTIC-SERVICE,,] 29062 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2022-11-21 20:24:34.073  INFO [ELASTIC-SERVICE,,] 29062 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Elasticsearch repositories in DEFAULT mode.
2022-11-21 20:24:34.107  INFO [ELASTIC-SERVICE,,] 29062 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 30 ms. Found 2 Elasticsearch repository interfaces.
2022-11-21 20:24:34.217  INFO [ELASTIC-SERVICE,,] 29062 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2022-11-21 20:24:34.217  INFO [ELASTIC-SERVICE,,] 29062 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Reactive Elasticsearch repositories in DEFAULT mode.
2022-11-21 20:24:34.222  INFO [ELASTIC-SERVICE,,] 29062 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 4 ms. Found 0 Reactive Elasticsearch repository interfaces.
2022-11-21 20:24:34.391  INFO [ELASTIC-SERVICE,,] 29062 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2022-11-21 20:24:34.391  INFO [ELASTIC-SERVICE,,] 29062 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data MongoDB repositories in DEFAULT mode.
2022-11-21 20:24:34.394  INFO [ELASTIC-SERVICE,,] 29062 --- [main] .RepositoryConfigurationExtensionSupport : Spring Data MongoDB - Could not safely identify store assignment for repository candidate interface com.adirn.esservice.repository.CustomerRepo; If you want this repository to be a MongoDB repository, consider annotating your entities with one of these annotations: org.springframework.data.mongodb.core.mapping.Document (preferred), or consider extending one of the following types with your repository: org.springframework.data.mongodb.repository.MongoRepository
2022-11-21 20:24:34.395  INFO [ELASTIC-SERVICE,,] 29062 --- [main] .RepositoryConfigurationExtensionSupport : Spring Data MongoDB - Could not safely identify store assignment for repository candidate interface com.adirn.esservice.repository.OrderEventRepo; If you want this repository to be a MongoDB repository, consider annotating your entities with one of these annotations: org.springframework.data.mongodb.core.mapping.Document (preferred), or consider extending one of the following types with your repository: org.springframework.data.mongodb.repository.MongoRepository
2022-11-21 20:24:34.395  INFO [ELASTIC-SERVICE,,] 29062 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 4 ms. Found 0 MongoDB repository interfaces.
2022-11-21 20:24:34.566  INFO [ELASTIC-SERVICE,,] 29062 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=3c423339-7521-328d-a021-050b8e90d4ce
2022-11-21 20:24:35.788  INFO [ELASTIC-SERVICE,,] 29062 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8085 (http)
2022-11-21 20:24:35.795  INFO [ELASTIC-SERVICE,,] 29062 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-21 20:24:35.796  INFO [ELASTIC-SERVICE,,] 29062 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.68]
2022-11-21 20:24:35.886  INFO [ELASTIC-SERVICE,,] 29062 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-21 20:24:35.886  INFO [ELASTIC-SERVICE,,] 29062 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2473 ms
2022-11-21 20:24:37.928  WARN [ELASTIC-SERVICE,,] 29062 --- [I/O dispatcher 1] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:24:37.965  WARN [ELASTIC-SERVICE,,] 29062 --- [main] org.elasticsearch.client.RestClient      : request [HEAD http://localhost:9200/customer] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:24:38.125  WARN [ELASTIC-SERVICE,,] 29062 --- [main] org.elasticsearch.client.RestClient      : request [HEAD http://localhost:9200/order] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:24:39.367  INFO [ELASTIC-SERVICE,,] 29062 --- [cluster-ClusterId{value='637b912fdc0bf327a8dcf358', description='null'}-localhost:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server localhost:27017

com.mongodb.MongoSocketOpenException: Exception opening socket
	at com.mongodb.internal.connection.SocketStream.open(SocketStream.java:70) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.InternalStreamConnection.open(InternalStreamConnection.java:180) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:193) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:157) ~[mongodb-driver-core-4.6.1.jar:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:535) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:585) ~[na:na]
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:666) ~[na:na]
	at com.mongodb.internal.connection.SocketStreamHelper.initialize(SocketStreamHelper.java:107) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.SocketStream.initializeSocket(SocketStream.java:79) ~[mongodb-driver-core-4.6.1.jar:na]
	at com.mongodb.internal.connection.SocketStream.open(SocketStream.java:65) ~[mongodb-driver-core-4.6.1.jar:na]
	... 4 common frames omitted

2022-11-21 20:24:39.374  INFO [ELASTIC-SERVICE,,] 29062 --- [main] org.mongodb.driver.client                : MongoClient with metadata {"driver": {"name": "mongo-java-driver|sync|spring-boot", "version": "4.6.1"}, "os": {"type": "Linux", "name": "Linux", "architecture": "amd64", "version": "5.15.0-53-generic"}, "platform": "Java/Oracle Corporation/19.0.1+10-21"} created with settings MongoClientSettings{readPreference=primary, writeConcern=WriteConcern{w=null, wTimeout=null ms, journal=null}, retryWrites=true, retryReads=true, readConcern=ReadConcern{level=null}, credential=null, streamFactoryFactory=null, commandListeners=[org.springframework.cloud.sleuth.instrument.mongodb.TraceMongoCommandListener@7fa85a55], codecRegistry=ProvidersCodecRegistry{codecProviders=[ValueCodecProvider{}, BsonValueCodecProvider{}, DBRefCodecProvider{}, DBObjectCodecProvider{}, DocumentCodecProvider{}, IterableCodecProvider{}, MapCodecProvider{}, GeoJsonCodecProvider{}, GridFSFileCodecProvider{}, Jsr310CodecProvider{}, JsonObjectCodecProvider{}, BsonCodecProvider{}, EnumCodecProvider{}, com.mongodb.Jep395RecordCodecProvider@cb1c58c]}, clusterSettings={hosts=[localhost:27017], srvServiceName=mongodb, mode=SINGLE, requiredClusterType=UNKNOWN, requiredReplicaSetName='null', serverSelector='null', clusterListeners='[]', serverSelectionTimeout='30000 ms', localThreshold='30000 ms'}, socketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=0, receiveBufferSize=0, sendBufferSize=0}, heartbeatSocketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=10000, receiveBufferSize=0, sendBufferSize=0}, connectionPoolSettings=ConnectionPoolSettings{maxSize=100, minSize=0, maxWaitTimeMS=120000, maxConnectionLifeTimeMS=0, maxConnectionIdleTimeMS=0, maintenanceInitialDelayMS=0, maintenanceFrequencyMS=60000, connectionPoolListeners=[], maxConnecting=2}, serverSettings=ServerSettings{heartbeatFrequencyMS=10000, minHeartbeatFrequencyMS=500, serverListeners='[]', serverMonitorListeners='[]'}, sslSettings=SslSettings{enabled=false, invalidHostNameAllowed=false, context=null}, applicationName='null', compressorList=[], uuidRepresentation=JAVA_LEGACY, serverApi=null, autoEncryptionSettings=null, contextProvider=org.springframework.cloud.sleuth.instrument.mongodb.TraceSynchronousMongoClientSettingsBuilderCustomizer$$Lambda$1293/0x000000080162e408@352e4b6d}
2022-11-21 20:24:39.434  WARN [ELASTIC-SERVICE,,] 29062 --- [main] o.s.data.convert.CustomConversions       : Registering converter from class java.time.LocalDateTime to class org.joda.time.LocalDateTime as reading converter although it doesn't convert from a store-supported type; You might want to check your annotation setup at the converter implementation
2022-11-21 20:24:39.497  WARN [ELASTIC-SERVICE,,] 29062 --- [main] o.s.data.convert.CustomConversions       : Registering converter from class java.time.LocalDateTime to class org.joda.time.LocalDateTime as reading converter although it doesn't convert from a store-supported type; You might want to check your annotation setup at the converter implementation
2022-11-21 20:24:40.084  INFO [ELASTIC-SERVICE,,] 29062 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = latest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-esconsumer-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = esconsumer
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2022-11-21 20:24:40.238  INFO [ELASTIC-SERVICE,,] 29062 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-21 20:24:40.239  INFO [ELASTIC-SERVICE,,] 29062 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-21 20:24:40.239  INFO [ELASTIC-SERVICE,,] 29062 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1669042480237
2022-11-21 20:24:40.242  INFO [ELASTIC-SERVICE,,] 29062 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Subscribed to topic(s): payment_complete
2022-11-21 20:24:40.250  INFO [ELASTIC-SERVICE,,] 29062 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = latest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-esconsumer-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = esconsumer
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2022-11-21 20:24:40.260  INFO [ELASTIC-SERVICE,,] 29062 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-21 20:24:40.260  INFO [ELASTIC-SERVICE,,] 29062 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-21 20:24:40.260  INFO [ELASTIC-SERVICE,,] 29062 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1669042480260
2022-11-21 20:24:40.261  INFO [ELASTIC-SERVICE,,] 29062 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Subscribed to topic(s): customer_topic
2022-11-21 20:24:40.263  INFO [ELASTIC-SERVICE,,] 29062 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = latest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-esconsumer-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = esconsumer
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2022-11-21 20:24:40.269  INFO [ELASTIC-SERVICE,,] 29062 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-21 20:24:40.269  INFO [ELASTIC-SERVICE,,] 29062 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-21 20:24:40.269  INFO [ELASTIC-SERVICE,,] 29062 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1669042480269
2022-11-21 20:24:40.270  INFO [ELASTIC-SERVICE,,] 29062 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Subscribed to topic(s): order_topics
2022-11-21 20:24:40.286  INFO [ELASTIC-SERVICE,,] 29062 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8085 (http) with context path ''
2022-11-21 20:24:40.328  INFO [ELASTIC-SERVICE,,] 29062 --- [main] c.adirn.esservice.EsServiceApplication   : Started EsServiceApplication in 7.546 seconds (JVM running for 7.915)
2022-11-21 20:24:40.560  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Resetting the last seen epoch of partition customer_topic-0 to 0 since the associated topicId changed from null to tKr50QVbTM2_exfwcWm5Og
2022-11-21 20:24:40.560  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Resetting the last seen epoch of partition payment_complete-0 to 0 since the associated topicId changed from null to lXK061VOTzqVujfWi-KIWg
2022-11-21 20:24:40.560  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Resetting the last seen epoch of partition order_topics-0 to 0 since the associated topicId changed from null to WFpyU0BqR5-w7pCovYKThg
2022-11-21 20:24:40.562  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Cluster ID: N6_RKQEzRKyebGgdHnjA8Q
2022-11-21 20:24:40.562  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Cluster ID: N6_RKQEzRKyebGgdHnjA8Q
2022-11-21 20:24:40.562  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Cluster ID: N6_RKQEzRKyebGgdHnjA8Q
2022-11-21 20:24:40.563  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-21 20:24:40.565  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] (Re-)joining group
2022-11-21 20:24:40.565  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-21 20:24:40.565  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2022-11-21 20:24:40.565  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] (Re-)joining group
2022-11-21 20:24:40.565  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] (Re-)joining group
2022-11-21 20:24:40.574  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Request joining group due to: need to re-join with the given member-id
2022-11-21 20:24:40.574  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Request joining group due to: need to re-join with the given member-id
2022-11-21 20:24:40.574  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Request joining group due to: need to re-join with the given member-id
2022-11-21 20:24:40.575  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] (Re-)joining group
2022-11-21 20:24:40.575  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] (Re-)joining group
2022-11-21 20:24:40.575  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] (Re-)joining group
2022-11-21 20:24:43.579  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Successfully joined group with generation Generation{generationId=11, memberId='consumer-esconsumer-2-25477664-ed9d-4e3d-8704-d1e6f5a644f5', protocol='range'}
2022-11-21 20:24:43.579  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Successfully joined group with generation Generation{generationId=11, memberId='consumer-esconsumer-3-4695e67b-78a5-4d10-bb66-54d24d38766f', protocol='range'}
2022-11-21 20:24:43.579  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Successfully joined group with generation Generation{generationId=11, memberId='consumer-esconsumer-1-f9928859-ec32-4e82-8c2f-fe797490759c', protocol='range'}
2022-11-21 20:24:43.584  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Resetting the last seen epoch of partition order_topics-0 to 0 since the associated topicId changed from null to WFpyU0BqR5-w7pCovYKThg
2022-11-21 20:24:43.584  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Resetting the last seen epoch of partition customer_topic-0 to 0 since the associated topicId changed from null to tKr50QVbTM2_exfwcWm5Og
2022-11-21 20:24:43.585  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Finished assignment for group at generation 11: {consumer-esconsumer-1-f9928859-ec32-4e82-8c2f-fe797490759c=Assignment(partitions=[payment_complete-0]), consumer-esconsumer-2-25477664-ed9d-4e3d-8704-d1e6f5a644f5=Assignment(partitions=[customer_topic-0]), consumer-esconsumer-3-4695e67b-78a5-4d10-bb66-54d24d38766f=Assignment(partitions=[order_topics-0])}
2022-11-21 20:24:43.590  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Successfully synced group in generation Generation{generationId=11, memberId='consumer-esconsumer-3-4695e67b-78a5-4d10-bb66-54d24d38766f', protocol='range'}
2022-11-21 20:24:43.590  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Successfully synced group in generation Generation{generationId=11, memberId='consumer-esconsumer-1-f9928859-ec32-4e82-8c2f-fe797490759c', protocol='range'}
2022-11-21 20:24:43.590  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Successfully synced group in generation Generation{generationId=11, memberId='consumer-esconsumer-2-25477664-ed9d-4e3d-8704-d1e6f5a644f5', protocol='range'}
2022-11-21 20:24:43.591  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Notifying assignor about the new Assignment(partitions=[payment_complete-0])
2022-11-21 20:24:43.591  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Notifying assignor about the new Assignment(partitions=[order_topics-0])
2022-11-21 20:24:43.591  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Notifying assignor about the new Assignment(partitions=[customer_topic-0])
2022-11-21 20:24:43.592  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Adding newly assigned partitions: customer_topic-0
2022-11-21 20:24:43.592  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Adding newly assigned partitions: payment_complete-0
2022-11-21 20:24:43.592  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Adding newly assigned partitions: order_topics-0
2022-11-21 20:24:43.603  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Setting offset for partition order_topics-0 to the committed offset FetchPosition{offset=7, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2022-11-21 20:24:43.603  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Setting offset for partition customer_topic-0 to the committed offset FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2022-11-21 20:24:43.603  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Setting offset for partition payment_complete-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2022-11-21 20:24:43.604  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : esconsumer: partitions assigned: [order_topics-0]
2022-11-21 20:24:43.604  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : esconsumer: partitions assigned: [customer_topic-0]
2022-11-21 20:24:43.604  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : esconsumer: partitions assigned: [payment_complete-0]
2022-11-21 20:26:01.324  INFO [ELASTIC-SERVICE,3ea497a3665a06d2,3ea497a3665a06d2] 29062 --- [http-nio-8085-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-11-21 20:26:01.325  INFO [ELASTIC-SERVICE,3ea497a3665a06d2,3ea497a3665a06d2] 29062 --- [http-nio-8085-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-11-21 20:26:01.327  INFO [ELASTIC-SERVICE,3ea497a3665a06d2,3ea497a3665a06d2] 29062 --- [http-nio-8085-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 2 ms
2022-11-21 20:26:01.360  WARN [ELASTIC-SERVICE,3ea497a3665a06d2,3ea497a3665a06d2] 29062 --- [http-nio-8085-exec-2] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/fb39758a-859f-4f63-b5ec-d01b67857b7d] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:26:27.746  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-2, groupId=email] Node -1 disconnected.
2022-11-21 20:26:27.887  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-3, groupId=email] Node -1 disconnected.
2022-11-21 20:26:27.904  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-email-1, groupId=email] Node -1 disconnected.
2022-11-21 20:26:31.199  INFO [PAYMENT-SERVICE,576af23b13f3ff25,576af23b13f3ff25] 26018 --- [http-nio-8086-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-11-21 20:26:31.213  INFO [PAYMENT-SERVICE,576af23b13f3ff25,576af23b13f3ff25] 26018 --- [http-nio-8086-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-11-21 20:26:31.233  INFO [PAYMENT-SERVICE,576af23b13f3ff25,576af23b13f3ff25] 26018 --- [http-nio-8086-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 19 ms
2022-11-21 20:26:32.777  INFO [PAYMENT-SERVICE,576af23b13f3ff25,576af23b13f3ff25] 26018 --- [http-nio-8086-exec-2] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:7, serverValue:4175}] to cluster0-shard-00-01.rckqz.mongodb.net:27017
2022-11-21 20:26:32.935  INFO [PAYMENT-SERVICE,576af23b13f3ff25,576af23b13f3ff25] 26018 --- [http-nio-8086-exec-2] c.a.p.kafka.PaymentProducer              : Payment Event => Payment(transId=73abbfdf-f8e6-49f5-b5f0-49268fbd52d8, status=Transaction completed, orderId=fb39758a-859f-4f63-b5ec-d01b67857b7d, price=0.0)
2022-11-21 20:26:32.958  INFO [PAYMENT-SERVICE,576af23b13f3ff25,576af23b13f3ff25] 26018 --- [http-nio-8086-exec-2] o.a.k.clients.producer.ProducerConfig    : ProducerConfig values: 
	acks = -1
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-1
	compression.type = none
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.class = class org.apache.kafka.clients.producer.internals.DefaultPartitioner
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2022-11-21 20:26:32.985  INFO [PAYMENT-SERVICE,576af23b13f3ff25,576af23b13f3ff25] 26018 --- [http-nio-8086-exec-2] o.a.k.clients.producer.KafkaProducer     : [Producer clientId=producer-1] Instantiated an idempotent producer.
2022-11-21 20:26:33.006  INFO [PAYMENT-SERVICE,576af23b13f3ff25,576af23b13f3ff25] 26018 --- [http-nio-8086-exec-2] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.1.2
2022-11-21 20:26:33.007  INFO [PAYMENT-SERVICE,576af23b13f3ff25,576af23b13f3ff25] 26018 --- [http-nio-8086-exec-2] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f8c67dc3ae0a3265
2022-11-21 20:26:33.007  INFO [PAYMENT-SERVICE,576af23b13f3ff25,576af23b13f3ff25] 26018 --- [http-nio-8086-exec-2] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1669042593006
2022-11-21 20:26:33.039  INFO [PAYMENT-SERVICE,,] 26018 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.Metadata        : [Producer clientId=producer-1] Resetting the last seen epoch of partition payment_complete-0 to 0 since the associated topicId changed from null to lXK061VOTzqVujfWi-KIWg
2022-11-21 20:26:33.041  INFO [PAYMENT-SERVICE,,] 26018 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.Metadata        : [Producer clientId=producer-1] Cluster ID: N6_RKQEzRKyebGgdHnjA8Q
2022-11-21 20:26:33.043  INFO [PAYMENT-SERVICE,,] 26018 --- [kafka-producer-network-thread | producer-1] o.a.k.c.p.internals.TransactionManager   : [Producer clientId=producer-1] ProducerId set to 3001 with epoch 0
2022-11-21 20:26:33.174  INFO [EMAIL-SERVICE,576af23b13f3ff25,4104eb221ab88ac8] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Payment event received in email service => Payment(transId=73abbfdf-f8e6-49f5-b5f0-49268fbd52d8, status=Transaction completed, orderId=fb39758a-859f-4f63-b5ec-d01b67857b7d, price=0.0)
2022-11-21 20:26:33.203  INFO [ELASTIC-SERVICE,576af23b13f3ff25,04fcf5ee41f45eb3] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] c.adirn.esservice.kafka.PaymentConsumer  : payment event received in ES service => Payment(transId=73abbfdf-f8e6-49f5-b5f0-49268fbd52d8, status=Transaction completed, orderId=fb39758a-859f-4f63-b5ec-d01b67857b7d, price=0.0)
2022-11-21 20:26:33.210  WARN [ELASTIC-SERVICE,576af23b13f3ff25,04fcf5ee41f45eb3] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/fb39758a-859f-4f63-b5ec-d01b67857b7d] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:26:33.358  WARN [ELASTIC-SERVICE,576af23b13f3ff25,04fcf5ee41f45eb3] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.elasticsearch.client.RestClient      : request [PUT http://localhost:9200/order/_doc/fb39758a-859f-4f63-b5ec-d01b67857b7d?timeout=1m] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:26:33.365  WARN [ELASTIC-SERVICE,576af23b13f3ff25,04fcf5ee41f45eb3] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.elasticsearch.client.RestClient      : request [POST http://localhost:9200/order/_refresh] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:26:33.372  INFO [ELASTIC-SERVICE,576af23b13f3ff25,04fcf5ee41f45eb3] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] c.adirn.esservice.kafka.PaymentConsumer  : Updated order => OrderEventES(id=fb39758a-859f-4f63-b5ec-d01b67857b7d, status=SUCCESSFULL, message=ORDER PLACED......., customer=Customer(id=1, name=Aditya, email=abc@gamil.com, age=26), order=Order(id=fb39758a-859f-4f63-b5ec-d01b67857b7d, cid=1, pid=3, qty=5), product=Product(id=3, name=speaker, price=100000.0, qtyavail=12)) 
2022-11-21 20:26:33.397  WARN [ELASTIC-SERVICE,576af23b13f3ff25,7b6d632911dd8169] 29062 --- [http-nio-8085-exec-3] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/fb39758a-859f-4f63-b5ec-d01b67857b7d] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:26:33.411  INFO [EMAIL-SERVICE,576af23b13f3ff25,4104eb221ab88ac8] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Send reciept to customer => Customer(id=1, name=Aditya, email=abc@gamil.com, age=26)
2022-11-21 20:27:11.875  WARN [ELASTIC-SERVICE,fbb2aa84fff294f6,fbb2aa84fff294f6] 29062 --- [http-nio-8085-exec-6] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/fb39758a-859f-4f63-b5ec-d01b67857b7d] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:30:36.869  INFO [PRODUCT-SERVICE,,] 26680 --- [Thread-2] o.s.c.s.a.z.ZipkinAutoConfiguration      : Flushing remaining spans on shutdown
2022-11-21 20:30:42.058  INFO [PRODUCT-SERVICE,,] 31433 --- [main] c.a.s.StockServiceApplication            : Starting StockServiceApplication using Java 19.0.1 on aditya-ASUS-TUF-Gaming-F15-FX506LI-FX566LI with PID 31433 (/home/aditya/Downloads/Ecommerce-ordering-service/stock-service/target/classes started by aditya in /home/aditya/Downloads/Ecommerce-ordering-service)
2022-11-21 20:30:42.059  INFO [PRODUCT-SERVICE,,] 31433 --- [main] c.a.s.StockServiceApplication            : No active profile set, falling back to 1 default profile: "default"
2022-11-21 20:30:42.705  INFO [PRODUCT-SERVICE,,] 31433 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2022-11-21 20:30:42.706  INFO [PRODUCT-SERVICE,,] 31433 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data MongoDB repositories in DEFAULT mode.
2022-11-21 20:30:42.807  INFO [PRODUCT-SERVICE,,] 31433 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 96 ms. Found 1 MongoDB repository interfaces.
2022-11-21 20:30:42.819  INFO [PRODUCT-SERVICE,,] 31433 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2022-11-21 20:30:42.820  INFO [PRODUCT-SERVICE,,] 31433 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-11-21 20:30:42.831  INFO [PRODUCT-SERVICE,,] 31433 --- [main] .RepositoryConfigurationExtensionSupport : Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.adirn.stockservice.repository.ProductRepo; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2022-11-21 20:30:42.831  INFO [PRODUCT-SERVICE,,] 31433 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2022-11-21 20:30:42.984  INFO [PRODUCT-SERVICE,,] 31433 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ff81fbc2-a2aa-38b6-b05b-6cc72c7a987e
2022-11-21 20:30:43.580  INFO [PRODUCT-SERVICE,,] 31433 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8083 (http)
2022-11-21 20:30:43.587  INFO [PRODUCT-SERVICE,,] 31433 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-21 20:30:43.587  INFO [PRODUCT-SERVICE,,] 31433 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.68]
2022-11-21 20:30:43.665  INFO [PRODUCT-SERVICE,,] 31433 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-21 20:30:43.665  INFO [PRODUCT-SERVICE,,] 31433 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1565 ms
2022-11-21 20:30:44.195  INFO [PRODUCT-SERVICE,,] 31433 --- [cluster-ClusterId{value='637b929cd957a90f7d48bf54', description='null'}-srv-cluster0.rckqz.mongodb.net] org.mongodb.driver.cluster               : Adding discovered server cluster0-shard-00-02.rckqz.mongodb.net:27017 to client view of cluster
2022-11-21 20:30:44.203  INFO [PRODUCT-SERVICE,,] 31433 --- [main] org.mongodb.driver.client                : MongoClient with metadata {"driver": {"name": "mongo-java-driver|sync|spring-boot", "version": "4.6.1"}, "os": {"type": "Linux", "name": "Linux", "architecture": "amd64", "version": "5.15.0-53-generic"}, "platform": "Java/Oracle Corporation/19.0.1+10-21"} created with settings MongoClientSettings{readPreference=primary, writeConcern=WriteConcern{w=majority, wTimeout=null ms, journal=null}, retryWrites=true, retryReads=true, readConcern=ReadConcern{level=null}, credential=MongoCredential{mechanism=null, userName='user1', source='admin', password=<hidden>, mechanismProperties=<hidden>}, streamFactoryFactory=null, commandListeners=[org.springframework.cloud.sleuth.instrument.mongodb.TraceMongoCommandListener@1b8fa2fa], codecRegistry=ProvidersCodecRegistry{codecProviders=[ValueCodecProvider{}, BsonValueCodecProvider{}, DBRefCodecProvider{}, DBObjectCodecProvider{}, DocumentCodecProvider{}, IterableCodecProvider{}, MapCodecProvider{}, GeoJsonCodecProvider{}, GridFSFileCodecProvider{}, Jsr310CodecProvider{}, JsonObjectCodecProvider{}, BsonCodecProvider{}, EnumCodecProvider{}, com.mongodb.Jep395RecordCodecProvider@21527b8]}, clusterSettings={hosts=[127.0.0.1:27017], srvHost=cluster0.rckqz.mongodb.net, srvServiceName=mongodb, mode=MULTIPLE, requiredClusterType=REPLICA_SET, requiredReplicaSetName='atlas-tp1paz-shard-0', serverSelector='null', clusterListeners='[]', serverSelectionTimeout='30000 ms', localThreshold='30000 ms'}, socketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=0, receiveBufferSize=0, sendBufferSize=0}, heartbeatSocketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=10000, receiveBufferSize=0, sendBufferSize=0}, connectionPoolSettings=ConnectionPoolSettings{maxSize=100, minSize=0, maxWaitTimeMS=120000, maxConnectionLifeTimeMS=0, maxConnectionIdleTimeMS=0, maintenanceInitialDelayMS=0, maintenanceFrequencyMS=60000, connectionPoolListeners=[], maxConnecting=2}, serverSettings=ServerSettings{heartbeatFrequencyMS=10000, minHeartbeatFrequencyMS=500, serverListeners='[]', serverMonitorListeners='[]'}, sslSettings=SslSettings{enabled=true, invalidHostNameAllowed=false, context=null}, applicationName='null', compressorList=[], uuidRepresentation=JAVA_LEGACY, serverApi=null, autoEncryptionSettings=null, contextProvider=org.springframework.cloud.sleuth.instrument.mongodb.TraceSynchronousMongoClientSettingsBuilderCustomizer$$Lambda$767/0x00000008014c1220@7cc1f72c}
2022-11-21 20:30:44.215  INFO [PRODUCT-SERVICE,,] 31433 --- [cluster-ClusterId{value='637b929cd957a90f7d48bf54', description='null'}-srv-cluster0.rckqz.mongodb.net] org.mongodb.driver.cluster               : Adding discovered server cluster0-shard-00-01.rckqz.mongodb.net:27017 to client view of cluster
2022-11-21 20:30:44.216  INFO [PRODUCT-SERVICE,,] 31433 --- [cluster-ClusterId{value='637b929cd957a90f7d48bf54', description='null'}-srv-cluster0.rckqz.mongodb.net] org.mongodb.driver.cluster               : Adding discovered server cluster0-shard-00-00.rckqz.mongodb.net:27017 to client view of cluster
2022-11-21 20:30:44.639  INFO [PRODUCT-SERVICE,,] 31433 --- [cluster-ClusterId{value='637b929cd957a90f7d48bf54', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:2, serverValue:4234}] to cluster0-shard-00-01.rckqz.mongodb.net:27017
2022-11-21 20:30:44.639  INFO [PRODUCT-SERVICE,,] 31433 --- [cluster-ClusterId{value='637b929cd957a90f7d48bf54', description='null'}-cluster0-shard-00-02.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:1, serverValue:3510}] to cluster0-shard-00-02.rckqz.mongodb.net:27017
2022-11-21 20:30:44.639  INFO [PRODUCT-SERVICE,,] 31433 --- [cluster-rtt-ClusterId{value='637b929cd957a90f7d48bf54', description='null'}-cluster0-shard-00-02.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:4, serverValue:3510}] to cluster0-shard-00-02.rckqz.mongodb.net:27017
2022-11-21 20:30:44.639  INFO [PRODUCT-SERVICE,,] 31433 --- [cluster-ClusterId{value='637b929cd957a90f7d48bf54', description='null'}-cluster0-shard-00-02.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=cluster0-shard-00-02.rckqz.mongodb.net:27017, type=REPLICA_SET_SECONDARY, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=13, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=246913508, setName='atlas-tp1paz-shard-0', canonicalAddress=cluster0-shard-00-02.rckqz.mongodb.net:27017, hosts=[cluster0-shard-00-02.rckqz.mongodb.net:27017, cluster0-shard-00-01.rckqz.mongodb.net:27017, cluster0-shard-00-00.rckqz.mongodb.net:27017], passives=[], arbiters=[], primary='cluster0-shard-00-01.rckqz.mongodb.net:27017', tagSet=TagSet{[Tag{name='nodeType', value='ELECTABLE'}, Tag{name='provider', value='AWS'}, Tag{name='region', value='AP_SOUTH_1'}, Tag{name='workloadType', value='OPERATIONAL'}]}, electionId=null, setVersion=7, topologyVersion=TopologyVersion{processId=637b75e1c106e2311860ce01, counter=3}, lastWriteDate=Mon Nov 21 20:30:44 IST 2022, lastUpdateTimeNanos=4541111907117}
2022-11-21 20:30:44.639  INFO [PRODUCT-SERVICE,,] 31433 --- [cluster-ClusterId{value='637b929cd957a90f7d48bf54', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=cluster0-shard-00-01.rckqz.mongodb.net:27017, type=REPLICA_SET_PRIMARY, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=13, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=247458438, setName='atlas-tp1paz-shard-0', canonicalAddress=cluster0-shard-00-01.rckqz.mongodb.net:27017, hosts=[cluster0-shard-00-02.rckqz.mongodb.net:27017, cluster0-shard-00-01.rckqz.mongodb.net:27017, cluster0-shard-00-00.rckqz.mongodb.net:27017], passives=[], arbiters=[], primary='cluster0-shard-00-01.rckqz.mongodb.net:27017', tagSet=TagSet{[Tag{name='nodeType', value='ELECTABLE'}, Tag{name='provider', value='AWS'}, Tag{name='region', value='AP_SOUTH_1'}, Tag{name='workloadType', value='OPERATIONAL'}]}, electionId=7fffffff0000000000000143, setVersion=7, topologyVersion=TopologyVersion{processId=637b74cc1a363b602e2fc62e, counter=6}, lastWriteDate=Mon Nov 21 20:30:44 IST 2022, lastUpdateTimeNanos=4541111907133}
2022-11-21 20:30:44.641  INFO [PRODUCT-SERVICE,,] 31433 --- [cluster-rtt-ClusterId{value='637b929cd957a90f7d48bf54', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:3, serverValue:4234}] to cluster0-shard-00-01.rckqz.mongodb.net:27017
2022-11-21 20:30:44.641  INFO [PRODUCT-SERVICE,,] 31433 --- [cluster-ClusterId{value='637b929cd957a90f7d48bf54', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Setting max election id to 7fffffff0000000000000143 from replica set primary cluster0-shard-00-01.rckqz.mongodb.net:27017
2022-11-21 20:30:44.642  INFO [PRODUCT-SERVICE,,] 31433 --- [cluster-ClusterId{value='637b929cd957a90f7d48bf54', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Setting max set version to 7 from replica set primary cluster0-shard-00-01.rckqz.mongodb.net:27017
2022-11-21 20:30:44.642  INFO [PRODUCT-SERVICE,,] 31433 --- [cluster-ClusterId{value='637b929cd957a90f7d48bf54', description='null'}-cluster0-shard-00-01.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Discovered replica set primary cluster0-shard-00-01.rckqz.mongodb.net:27017
2022-11-21 20:30:44.650  INFO [PRODUCT-SERVICE,,] 31433 --- [cluster-rtt-ClusterId{value='637b929cd957a90f7d48bf54', description='null'}-cluster0-shard-00-00.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:5, serverValue:4245}] to cluster0-shard-00-00.rckqz.mongodb.net:27017
2022-11-21 20:30:44.653  INFO [PRODUCT-SERVICE,,] 31433 --- [cluster-ClusterId{value='637b929cd957a90f7d48bf54', description='null'}-cluster0-shard-00-00.rckqz.mongodb.net:27017] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:6, serverValue:4244}] to cluster0-shard-00-00.rckqz.mongodb.net:27017
2022-11-21 20:30:44.653  INFO [PRODUCT-SERVICE,,] 31433 --- [cluster-ClusterId{value='637b929cd957a90f7d48bf54', description='null'}-cluster0-shard-00-00.rckqz.mongodb.net:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=cluster0-shard-00-00.rckqz.mongodb.net:27017, type=REPLICA_SET_SECONDARY, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=13, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=258095585, setName='atlas-tp1paz-shard-0', canonicalAddress=cluster0-shard-00-00.rckqz.mongodb.net:27017, hosts=[cluster0-shard-00-02.rckqz.mongodb.net:27017, cluster0-shard-00-01.rckqz.mongodb.net:27017, cluster0-shard-00-00.rckqz.mongodb.net:27017], passives=[], arbiters=[], primary='cluster0-shard-00-01.rckqz.mongodb.net:27017', tagSet=TagSet{[Tag{name='nodeType', value='ELECTABLE'}, Tag{name='provider', value='AWS'}, Tag{name='region', value='AP_SOUTH_1'}, Tag{name='workloadType', value='OPERATIONAL'}]}, electionId=null, setVersion=7, topologyVersion=TopologyVersion{processId=637b73da0126232d3ea0b1ce, counter=4}, lastWriteDate=Mon Nov 21 20:30:44 IST 2022, lastUpdateTimeNanos=4541126612675}
2022-11-21 20:30:45.649  INFO [PRODUCT-SERVICE,,] 31433 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8083 (http) with context path ''
2022-11-21 20:30:45.664  INFO [PRODUCT-SERVICE,,] 31433 --- [main] c.a.s.StockServiceApplication            : Started StockServiceApplication in 4.089 seconds (JVM running for 4.548)
2022-11-21 20:31:22.566  WARN [ELASTIC-SERVICE,da520de055255ed6,da520de055255ed6] 29062 --- [http-nio-8085-exec-10] org.elasticsearch.client.RestClient      : request [DELETE http://localhost:9200/order/_doc/fb39758a-859f-4f63-b5ec-d01b67857b7d?timeout=1m] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:31:22.587  WARN [ELASTIC-SERVICE,da520de055255ed6,da520de055255ed6] 29062 --- [http-nio-8085-exec-10] org.elasticsearch.client.RestClient      : request [POST http://localhost:9200/order/_refresh] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:31:53.486  INFO [CUSTOMER-SERVICE,d14778016aa32e52,464fce7c866431a2] 26885 --- [http-nio-8081-exec-3] c.a.c.controller.CustomerController      : Customer(id=2, name=testuser, email=adebc@gamil.com, age=36)
2022-11-21 20:31:53.581  INFO [PRODUCT-SERVICE,d14778016aa32e52,b3c0ff0b1698c3e1] 31433 --- [http-nio-8083-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-11-21 20:31:53.581  INFO [PRODUCT-SERVICE,d14778016aa32e52,b3c0ff0b1698c3e1] 31433 --- [http-nio-8083-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-11-21 20:31:53.583  INFO [PRODUCT-SERVICE,d14778016aa32e52,b3c0ff0b1698c3e1] 31433 --- [http-nio-8083-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 2 ms
2022-11-21 20:31:54.165  INFO [PRODUCT-SERVICE,d14778016aa32e52,b3c0ff0b1698c3e1] 31433 --- [http-nio-8083-exec-1] org.mongodb.driver.connection            : Opened connection [connectionId{localValue:7, serverValue:4210}] to cluster0-shard-00-01.rckqz.mongodb.net:27017
2022-11-21 20:31:54.281  INFO [ORDER-SERVICE,d14778016aa32e52,d14778016aa32e52] 26524 --- [http-nio-8082-exec-4] c.a.orderservice.kafka.OrderProducer     : Order Event => OrderEvent(status=PENDING, message=Complete the payment, customer=Customer(id=2, name=testuser, email=adebc@gamil.com, age=36), order=Order(id=e120c3e3-ca78-4a5c-be81-cb45581fccf2, cid=2, pid=3, qty=5), product=Product(id=3, name=speaker, price=100000.0, qtyavail=12))
2022-11-21 20:31:54.306  INFO [ORDER-SERVICE,,] 26524 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node -1 disconnected.
2022-11-21 20:31:54.622  INFO [EMAIL-SERVICE,d14778016aa32e52,06f88695da342549] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => OrderEvent(status=PENDING, message=Complete the payment, customer=Customer(id=2, name=testuser, email=adebc@gamil.com, age=36), order=Order(id=e120c3e3-ca78-4a5c-be81-cb45581fccf2, cid=2, pid=3, qty=5), product=Product(id=3, name=speaker, price=100000.0, qtyavail=12))
2022-11-21 20:31:54.827  INFO [ELASTIC-SERVICE,d14778016aa32e52,9100cb2cf4dabe0a] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] com.adirn.esservice.kafka.EsConsumer     : Order event received in ES service => OrderEvent(status=PENDING, message=Complete the payment, customer=Customer(id=2, name=testuser, email=adebc@gamil.com, age=36), order=Order(id=e120c3e3-ca78-4a5c-be81-cb45581fccf2, cid=2, pid=3, qty=5), product=Product(id=3, name=speaker, price=100000.0, qtyavail=12))
2022-11-21 20:31:54.846  WARN [ELASTIC-SERVICE,d14778016aa32e52,9100cb2cf4dabe0a] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.elasticsearch.client.RestClient      : request [PUT http://localhost:9200/order/_doc/e120c3e3-ca78-4a5c-be81-cb45581fccf2?timeout=1m] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:31:54.853  WARN [ELASTIC-SERVICE,d14778016aa32e52,9100cb2cf4dabe0a] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.elasticsearch.client.RestClient      : request [POST http://localhost:9200/order/_refresh] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:31:54.854  INFO [ELASTIC-SERVICE,d14778016aa32e52,9100cb2cf4dabe0a] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] com.adirn.esservice.kafka.EsConsumer     : Saved Order event to es DB
2022-11-21 20:32:11.879  INFO [PAYMENT-SERVICE,a89005f8556fcf20,a89005f8556fcf20] 26018 --- [http-nio-8086-exec-5] c.a.p.kafka.PaymentProducer              : Payment Event => Payment(transId=7595a3a6-0e63-4b6e-9955-94693222db73, status=Transaction completed, orderId=e120c3e3-ca78-4a5c-be81-cb45581fccf2, price=0.0)
2022-11-21 20:32:11.898  INFO [EMAIL-SERVICE,a89005f8556fcf20,70b5dcec44e1c70e] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Payment event received in email service => Payment(transId=7595a3a6-0e63-4b6e-9955-94693222db73, status=Transaction completed, orderId=e120c3e3-ca78-4a5c-be81-cb45581fccf2, price=0.0)
2022-11-21 20:32:11.899  INFO [ELASTIC-SERVICE,a89005f8556fcf20,5049bcd2a8ba4b4f] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] c.adirn.esservice.kafka.PaymentConsumer  : payment event received in ES service => Payment(transId=7595a3a6-0e63-4b6e-9955-94693222db73, status=Transaction completed, orderId=e120c3e3-ca78-4a5c-be81-cb45581fccf2, price=0.0)
2022-11-21 20:32:11.906  WARN [ELASTIC-SERVICE,a89005f8556fcf20,5049bcd2a8ba4b4f] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/e120c3e3-ca78-4a5c-be81-cb45581fccf2] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:32:11.909  WARN [ELASTIC-SERVICE,a89005f8556fcf20,a91ffa857fe2332b] 29062 --- [http-nio-8085-exec-1] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/e120c3e3-ca78-4a5c-be81-cb45581fccf2] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:32:11.918  WARN [ELASTIC-SERVICE,a89005f8556fcf20,5049bcd2a8ba4b4f] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.elasticsearch.client.RestClient      : request [PUT http://localhost:9200/order/_doc/e120c3e3-ca78-4a5c-be81-cb45581fccf2?timeout=1m] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:32:11.919  INFO [EMAIL-SERVICE,a89005f8556fcf20,70b5dcec44e1c70e] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Send reciept to customer => Customer(id=2, name=testuser, email=adebc@gamil.com, age=36)
2022-11-21 20:32:11.929  WARN [ELASTIC-SERVICE,a89005f8556fcf20,5049bcd2a8ba4b4f] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.elasticsearch.client.RestClient      : request [POST http://localhost:9200/order/_refresh] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:32:11.930  INFO [ELASTIC-SERVICE,a89005f8556fcf20,5049bcd2a8ba4b4f] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] c.adirn.esservice.kafka.PaymentConsumer  : Updated order => OrderEventES(id=e120c3e3-ca78-4a5c-be81-cb45581fccf2, status=SUCCESSFULL, message=ORDER PLACED......., customer=Customer(id=2, name=testuser, email=adebc@gamil.com, age=36), order=Order(id=e120c3e3-ca78-4a5c-be81-cb45581fccf2, cid=2, pid=3, qty=5), product=Product(id=3, name=speaker, price=100000.0, qtyavail=12)) 
2022-11-21 20:32:31.371  WARN [ELASTIC-SERVICE,1583d20b8ce51189,1583d20b8ce51189] 29062 --- [http-nio-8085-exec-4] org.elasticsearch.client.RestClient      : request [DELETE http://localhost:9200/order/_doc/7595a3a6-0e63-4b6e-9955-94693222db73?timeout=1m] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:32:31.394  WARN [ELASTIC-SERVICE,1583d20b8ce51189,1583d20b8ce51189] 29062 --- [http-nio-8085-exec-4] org.elasticsearch.client.RestClient      : request [POST http://localhost:9200/order/_refresh] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:32:40.659  INFO [CUSTOMER-SERVICE,82d58d285f54bf20,fa9d2b70606ce504] 26885 --- [http-nio-8081-exec-4] c.a.c.controller.CustomerController      : Customer(id=2, name=testuser, email=adebc@gamil.com, age=36)
2022-11-21 20:32:40.671  INFO [ORDER-SERVICE,82d58d285f54bf20,82d58d285f54bf20] 26524 --- [http-nio-8082-exec-5] c.a.orderservice.kafka.OrderProducer     : Order Event => OrderEvent(status=PENDING, message=Complete the payment, customer=Customer(id=2, name=testuser, email=adebc@gamil.com, age=36), order=Order(id=7cf08a48-900d-4228-ae50-5e778425e057, cid=2, pid=3, qty=5), product=Product(id=3, name=speaker, price=100000.0, qtyavail=12))
2022-11-21 20:32:40.679  INFO [ELASTIC-SERVICE,82d58d285f54bf20,df111cfcbca682f6] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] com.adirn.esservice.kafka.EsConsumer     : Order event received in ES service => OrderEvent(status=PENDING, message=Complete the payment, customer=Customer(id=2, name=testuser, email=adebc@gamil.com, age=36), order=Order(id=7cf08a48-900d-4228-ae50-5e778425e057, cid=2, pid=3, qty=5), product=Product(id=3, name=speaker, price=100000.0, qtyavail=12))
2022-11-21 20:32:40.679  INFO [EMAIL-SERVICE,82d58d285f54bf20,ec81d6788922ec00] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => OrderEvent(status=PENDING, message=Complete the payment, customer=Customer(id=2, name=testuser, email=adebc@gamil.com, age=36), order=Order(id=7cf08a48-900d-4228-ae50-5e778425e057, cid=2, pid=3, qty=5), product=Product(id=3, name=speaker, price=100000.0, qtyavail=12))
2022-11-21 20:32:40.689  WARN [ELASTIC-SERVICE,82d58d285f54bf20,df111cfcbca682f6] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.elasticsearch.client.RestClient      : request [PUT http://localhost:9200/order/_doc/7cf08a48-900d-4228-ae50-5e778425e057?timeout=1m] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:32:40.700  WARN [ELASTIC-SERVICE,82d58d285f54bf20,df111cfcbca682f6] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.elasticsearch.client.RestClient      : request [POST http://localhost:9200/order/_refresh] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:32:40.700  INFO [ELASTIC-SERVICE,82d58d285f54bf20,df111cfcbca682f6] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] com.adirn.esservice.kafka.EsConsumer     : Saved Order event to es DB
2022-11-21 20:33:15.350  WARN [ELASTIC-SERVICE,097538fc4f272a66,097538fc4f272a66] 29062 --- [http-nio-8085-exec-6] org.elasticsearch.client.RestClient      : request [DELETE http://localhost:9200/order/_doc/7cf08a48-900d-4228-ae50-5e778425e057?timeout=1m] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:33:15.381  WARN [ELASTIC-SERVICE,097538fc4f272a66,097538fc4f272a66] 29062 --- [http-nio-8085-exec-6] org.elasticsearch.client.RestClient      : request [POST http://localhost:9200/order/_refresh] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:33:40.695  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Node -1 disconnected.
2022-11-21 20:33:40.700  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Node -1 disconnected.
2022-11-21 20:33:40.716  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Node -1 disconnected.
2022-11-21 20:33:41.408  WARN [ELASTIC-SERVICE,348fbc325836533f,348fbc325836533f] 29062 --- [http-nio-8085-exec-7] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/e120c3e3-ca78-4a5c-be81-cb45581fccf2] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:33:52.398  WARN [ELASTIC-SERVICE,a269f64f8e66146d,a269f64f8e66146d] 29062 --- [http-nio-8085-exec-8] org.elasticsearch.client.RestClient      : request [DELETE http://localhost:9200/order/_doc/e120c3e3-ca78-4a5c-be81-cb45581fccf2?timeout=1m] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:33:52.433  WARN [ELASTIC-SERVICE,a269f64f8e66146d,a269f64f8e66146d] 29062 --- [http-nio-8085-exec-8] org.elasticsearch.client.RestClient      : request [POST http://localhost:9200/order/_refresh] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:33:58.047  WARN [ELASTIC-SERVICE,a5211507eb9172d5,a5211507eb9172d5] 29062 --- [http-nio-8085-exec-9] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/e120c3e3-ca78-4a5c-be81-cb45581fccf2] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:33:58.082 ERROR [ELASTIC-SERVICE,a5211507eb9172d5,a5211507eb9172d5] 29062 --- [http-nio-8085-exec-9] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is java.util.NoSuchElementException: No value present] with root cause

java.util.NoSuchElementException: No value present
	at java.base/java.util.Optional.get(Optional.java:143) ~[na:na]
	at com.adirn.esservice.controller.Controller.getById(Controller.java:77) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.23.jar:5.3.23]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.23.jar:5.3.23]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.23.jar:5.3.23]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.23.jar:5.3.23]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1071) ~[spring-webmvc-5.3.23.jar:5.3.23]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:964) ~[spring-webmvc-5.3.23.jar:5.3.23]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.23.jar:5.3.23]
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898) ~[spring-webmvc-5.3.23.jar:5.3.23]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:670) ~[tomcat-embed-core-9.0.68.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.23.jar:5.3.23]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:779) ~[tomcat-embed-core-9.0.68.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) ~[tomcat-embed-websocket-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.23.jar:5.3.23]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.23.jar:5.3.23]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.springframework.cloud.sleuth.instrument.web.servlet.TracingFilter.doFilter(TracingFilter.java:68) ~[spring-cloud-sleuth-instrumentation-3.1.5.jar:3.1.5]
	at org.springframework.cloud.sleuth.autoconfig.instrument.web.TraceWebServletConfiguration$LazyTracingFilter.doFilter(TraceWebServletConfiguration.java:131) ~[spring-cloud-sleuth-autoconfigure-3.1.5.jar:3.1.5]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.23.jar:5.3.23]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:541) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.springframework.cloud.sleuth.instrument.web.tomcat.TraceValve.invoke(TraceValve.java:103) ~[spring-cloud-sleuth-instrumentation-3.1.5.jar:3.1.5]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:360) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1789) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.68.jar:9.0.68]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]

2022-11-21 20:34:15.909  INFO [CUSTOMER-SERVICE,9e9c550e62608678,ab73c5ebc480cd14] 26885 --- [http-nio-8081-exec-6] c.a.c.controller.CustomerController      : Customer(id=3, name=testuser2, email=adebcf@gamil.com, age=56)
2022-11-21 20:34:15.963  INFO [ORDER-SERVICE,9e9c550e62608678,9e9c550e62608678] 26524 --- [http-nio-8082-exec-8] c.a.orderservice.kafka.OrderProducer     : Order Event => OrderEvent(status=PENDING, message=Complete the payment, customer=Customer(id=3, name=testuser2, email=adebcf@gamil.com, age=56), order=Order(id=c0975159-91c5-4dc4-90eb-023bd59c4776, cid=3, pid=3, qty=5), product=Product(id=3, name=speaker, price=100000.0, qtyavail=12))
2022-11-21 20:34:15.970  INFO [EMAIL-SERVICE,9e9c550e62608678,86217f5b306e48db] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Order event received in email service => OrderEvent(status=PENDING, message=Complete the payment, customer=Customer(id=3, name=testuser2, email=adebcf@gamil.com, age=56), order=Order(id=c0975159-91c5-4dc4-90eb-023bd59c4776, cid=3, pid=3, qty=5), product=Product(id=3, name=speaker, price=100000.0, qtyavail=12))
2022-11-21 20:34:15.971  INFO [ELASTIC-SERVICE,9e9c550e62608678,1e33809998e40c13] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] com.adirn.esservice.kafka.EsConsumer     : Order event received in ES service => OrderEvent(status=PENDING, message=Complete the payment, customer=Customer(id=3, name=testuser2, email=adebcf@gamil.com, age=56), order=Order(id=c0975159-91c5-4dc4-90eb-023bd59c4776, cid=3, pid=3, qty=5), product=Product(id=3, name=speaker, price=100000.0, qtyavail=12))
2022-11-21 20:34:15.986  WARN [ELASTIC-SERVICE,9e9c550e62608678,1e33809998e40c13] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.elasticsearch.client.RestClient      : request [PUT http://localhost:9200/order/_doc/c0975159-91c5-4dc4-90eb-023bd59c4776?timeout=1m] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:34:16.070  WARN [ELASTIC-SERVICE,9e9c550e62608678,1e33809998e40c13] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.elasticsearch.client.RestClient      : request [POST http://localhost:9200/order/_refresh] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:34:16.071  INFO [ELASTIC-SERVICE,9e9c550e62608678,1e33809998e40c13] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] com.adirn.esservice.kafka.EsConsumer     : Saved Order event to es DB
2022-11-21 20:34:31.981  WARN [ELASTIC-SERVICE,07be7b373421fba0,07be7b373421fba0] 29062 --- [http-nio-8085-exec-10] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/c0975159-91c5-4dc4-90eb-023bd59c4776] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:34:42.553  INFO [PAYMENT-SERVICE,1c03fbe60e3e4d4a,1c03fbe60e3e4d4a] 26018 --- [http-nio-8086-exec-8] c.a.p.kafka.PaymentProducer              : Payment Event => Payment(transId=afb6d6c4-3c17-4534-a029-5f30399c6088, status=Transaction completed, orderId= c0975159-91c5-4dc4-90eb-023bd59c4776, price=0.0)
2022-11-21 20:34:42.567  INFO [EMAIL-SERVICE,1c03fbe60e3e4d4a,a212871d390f5789] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Payment event received in email service => Payment(transId=afb6d6c4-3c17-4534-a029-5f30399c6088, status=Transaction completed, orderId= c0975159-91c5-4dc4-90eb-023bd59c4776, price=0.0)
2022-11-21 20:34:42.569  INFO [ELASTIC-SERVICE,1c03fbe60e3e4d4a,2cc6ffc916d9cae9] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] c.adirn.esservice.kafka.PaymentConsumer  : payment event received in ES service => Payment(transId=afb6d6c4-3c17-4534-a029-5f30399c6088, status=Transaction completed, orderId= c0975159-91c5-4dc4-90eb-023bd59c4776, price=0.0)
2022-11-21 20:34:42.583  WARN [ELASTIC-SERVICE,1c03fbe60e3e4d4a,2cc6ffc916d9cae9] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/%20c0975159-91c5-4dc4-90eb-023bd59c4776] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:34:42.591  WARN [ELASTIC-SERVICE,1c03fbe60e3e4d4a,4818135a36e07c9e] 29062 --- [http-nio-8085-exec-2] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/%20c0975159-91c5-4dc4-90eb-023bd59c4776] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:34:42.624  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Seeking to offset 6 for partition payment_complete-0
2022-11-21 20:34:42.629 ERROR [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.esservice.kafka.PaymentConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.NoSuchElementException: No value present; nested exception is java.util.NoSuchElementException: No value present
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.esservice.kafka.PaymentConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.NoSuchElementException: No value present; nested exception is java.util.NoSuchElementException: No value present
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: java.util.NoSuchElementException: No value present
	at java.base/java.util.Optional.get(Optional.java:143) ~[na:na]
	at com.adirn.esservice.service.QueryDslService.updateOrder(QueryDslService.java:58) ~[classes/:na]
	at com.adirn.esservice.kafka.PaymentConsumer.consume(PaymentConsumer.java:26) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$beb184e.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-21 20:34:42.682  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Seeking to offset 6 for partition payment_complete-0
2022-11-21 20:34:42.690 ERROR [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:101) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:168) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:122) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:819) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:777) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:732) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.getForEntity(RestTemplate.java:370) ~[spring-web-5.3.23.jar:5.3.23]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:52) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$c8bbb0b2.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-21 20:34:43.081  INFO [ELASTIC-SERVICE,1c03fbe60e3e4d4a,1075e703406b26db] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] c.adirn.esservice.kafka.PaymentConsumer  : payment event received in ES service => Payment(transId=afb6d6c4-3c17-4534-a029-5f30399c6088, status=Transaction completed, orderId= c0975159-91c5-4dc4-90eb-023bd59c4776, price=0.0)
2022-11-21 20:34:43.082  INFO [EMAIL-SERVICE,1c03fbe60e3e4d4a,6fd25b10c0437b4f] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Payment event received in email service => Payment(transId=afb6d6c4-3c17-4534-a029-5f30399c6088, status=Transaction completed, orderId= c0975159-91c5-4dc4-90eb-023bd59c4776, price=0.0)
2022-11-21 20:34:43.091  WARN [ELASTIC-SERVICE,1c03fbe60e3e4d4a,1075e703406b26db] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/%20c0975159-91c5-4dc4-90eb-023bd59c4776] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:34:43.104  WARN [ELASTIC-SERVICE,1c03fbe60e3e4d4a,18a80f0601eccb91] 29062 --- [http-nio-8085-exec-3] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/%20c0975159-91c5-4dc4-90eb-023bd59c4776] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:34:43.105  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Seeking to offset 6 for partition payment_complete-0
2022-11-21 20:34:43.107 ERROR [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.esservice.kafka.PaymentConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.NoSuchElementException: No value present; nested exception is java.util.NoSuchElementException: No value present
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.esservice.kafka.PaymentConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.NoSuchElementException: No value present; nested exception is java.util.NoSuchElementException: No value present
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: java.util.NoSuchElementException: No value present
	at java.base/java.util.Optional.get(Optional.java:143) ~[na:na]
	at com.adirn.esservice.service.QueryDslService.updateOrder(QueryDslService.java:58) ~[classes/:na]
	at com.adirn.esservice.kafka.PaymentConsumer.consume(PaymentConsumer.java:26) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$beb184e.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-21 20:34:43.124  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Seeking to offset 6 for partition payment_complete-0
2022-11-21 20:34:43.127 ERROR [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:101) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:168) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:122) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:819) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:777) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:732) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.getForEntity(RestTemplate.java:370) ~[spring-web-5.3.23.jar:5.3.23]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:52) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$c8bbb0b2.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-21 20:34:43.587  INFO [EMAIL-SERVICE,1c03fbe60e3e4d4a,2f0f88169bd23bd4] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Payment event received in email service => Payment(transId=afb6d6c4-3c17-4534-a029-5f30399c6088, status=Transaction completed, orderId= c0975159-91c5-4dc4-90eb-023bd59c4776, price=0.0)
2022-11-21 20:34:43.587  INFO [ELASTIC-SERVICE,1c03fbe60e3e4d4a,5c3221f33319742d] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] c.adirn.esservice.kafka.PaymentConsumer  : payment event received in ES service => Payment(transId=afb6d6c4-3c17-4534-a029-5f30399c6088, status=Transaction completed, orderId= c0975159-91c5-4dc4-90eb-023bd59c4776, price=0.0)
2022-11-21 20:34:43.593  WARN [ELASTIC-SERVICE,1c03fbe60e3e4d4a,5c3221f33319742d] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/%20c0975159-91c5-4dc4-90eb-023bd59c4776] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:34:43.597  WARN [ELASTIC-SERVICE,1c03fbe60e3e4d4a,c98c33f15519c9f4] 29062 --- [http-nio-8085-exec-4] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/%20c0975159-91c5-4dc4-90eb-023bd59c4776] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:34:43.606  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Seeking to offset 6 for partition payment_complete-0
2022-11-21 20:34:43.607 ERROR [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.esservice.kafka.PaymentConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.NoSuchElementException: No value present; nested exception is java.util.NoSuchElementException: No value present
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.esservice.kafka.PaymentConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.NoSuchElementException: No value present; nested exception is java.util.NoSuchElementException: No value present
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: java.util.NoSuchElementException: No value present
	at java.base/java.util.Optional.get(Optional.java:143) ~[na:na]
	at com.adirn.esservice.service.QueryDslService.updateOrder(QueryDslService.java:58) ~[classes/:na]
	at com.adirn.esservice.kafka.PaymentConsumer.consume(PaymentConsumer.java:26) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$beb184e.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-21 20:34:43.612  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Seeking to offset 6 for partition payment_complete-0
2022-11-21 20:34:43.613 ERROR [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:101) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:168) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:122) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:819) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:777) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:732) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.getForEntity(RestTemplate.java:370) ~[spring-web-5.3.23.jar:5.3.23]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:52) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$c8bbb0b2.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-21 20:34:44.090  INFO [ELASTIC-SERVICE,1c03fbe60e3e4d4a,1e54ea73be9ac5fb] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] c.adirn.esservice.kafka.PaymentConsumer  : payment event received in ES service => Payment(transId=afb6d6c4-3c17-4534-a029-5f30399c6088, status=Transaction completed, orderId= c0975159-91c5-4dc4-90eb-023bd59c4776, price=0.0)
2022-11-21 20:34:44.090  INFO [EMAIL-SERVICE,1c03fbe60e3e4d4a,0706215d00fb2e8b] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Payment event received in email service => Payment(transId=afb6d6c4-3c17-4534-a029-5f30399c6088, status=Transaction completed, orderId= c0975159-91c5-4dc4-90eb-023bd59c4776, price=0.0)
2022-11-21 20:34:44.096  WARN [ELASTIC-SERVICE,1c03fbe60e3e4d4a,1e54ea73be9ac5fb] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/%20c0975159-91c5-4dc4-90eb-023bd59c4776] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:34:44.113  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Seeking to offset 6 for partition payment_complete-0
2022-11-21 20:34:44.184  WARN [ELASTIC-SERVICE,1c03fbe60e3e4d4a,c5e631ce20a0b628] 29062 --- [http-nio-8085-exec-5] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/%20c0975159-91c5-4dc4-90eb-023bd59c4776] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:34:44.184 ERROR [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.esservice.kafka.PaymentConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.NoSuchElementException: No value present; nested exception is java.util.NoSuchElementException: No value present
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.esservice.kafka.PaymentConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.NoSuchElementException: No value present; nested exception is java.util.NoSuchElementException: No value present
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: java.util.NoSuchElementException: No value present
	at java.base/java.util.Optional.get(Optional.java:143) ~[na:na]
	at com.adirn.esservice.service.QueryDslService.updateOrder(QueryDslService.java:58) ~[classes/:na]
	at com.adirn.esservice.kafka.PaymentConsumer.consume(PaymentConsumer.java:26) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$beb184e.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-21 20:34:44.236  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Seeking to offset 6 for partition payment_complete-0
2022-11-21 20:34:44.265 ERROR [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:101) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:168) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:122) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:819) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:777) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:732) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.getForEntity(RestTemplate.java:370) ~[spring-web-5.3.23.jar:5.3.23]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:52) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$c8bbb0b2.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-21 20:34:44.592  INFO [ELASTIC-SERVICE,1c03fbe60e3e4d4a,48ac3e0fceb1baba] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] c.adirn.esservice.kafka.PaymentConsumer  : payment event received in ES service => Payment(transId=afb6d6c4-3c17-4534-a029-5f30399c6088, status=Transaction completed, orderId= c0975159-91c5-4dc4-90eb-023bd59c4776, price=0.0)
2022-11-21 20:34:44.592  INFO [EMAIL-SERVICE,1c03fbe60e3e4d4a,fc0d0edd1c3cf9ba] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Payment event received in email service => Payment(transId=afb6d6c4-3c17-4534-a029-5f30399c6088, status=Transaction completed, orderId= c0975159-91c5-4dc4-90eb-023bd59c4776, price=0.0)
2022-11-21 20:34:44.595  WARN [ELASTIC-SERVICE,1c03fbe60e3e4d4a,48ac3e0fceb1baba] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/%20c0975159-91c5-4dc4-90eb-023bd59c4776] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:34:44.599  WARN [ELASTIC-SERVICE,1c03fbe60e3e4d4a,075db228aacdd4cc] 29062 --- [http-nio-8085-exec-6] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/%20c0975159-91c5-4dc4-90eb-023bd59c4776] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:34:44.612  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Seeking to offset 6 for partition payment_complete-0
2022-11-21 20:34:44.618  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Seeking to offset 6 for partition payment_complete-0
2022-11-21 20:34:44.614 ERROR [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:101) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:168) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:122) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:819) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:777) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:732) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.getForEntity(RestTemplate.java:370) ~[spring-web-5.3.23.jar:5.3.23]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:52) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$c8bbb0b2.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-21 20:34:44.620 ERROR [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.esservice.kafka.PaymentConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.NoSuchElementException: No value present; nested exception is java.util.NoSuchElementException: No value present
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.esservice.kafka.PaymentConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.NoSuchElementException: No value present; nested exception is java.util.NoSuchElementException: No value present
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: java.util.NoSuchElementException: No value present
	at java.base/java.util.Optional.get(Optional.java:143) ~[na:na]
	at com.adirn.esservice.service.QueryDslService.updateOrder(QueryDslService.java:58) ~[classes/:na]
	at com.adirn.esservice.kafka.PaymentConsumer.consume(PaymentConsumer.java:26) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$beb184e.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-21 20:34:45.096  INFO [EMAIL-SERVICE,1c03fbe60e3e4d4a,82cd7aa2777ead68] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Payment event received in email service => Payment(transId=afb6d6c4-3c17-4534-a029-5f30399c6088, status=Transaction completed, orderId= c0975159-91c5-4dc4-90eb-023bd59c4776, price=0.0)
2022-11-21 20:34:45.096  INFO [ELASTIC-SERVICE,1c03fbe60e3e4d4a,03037d36cd657437] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] c.adirn.esservice.kafka.PaymentConsumer  : payment event received in ES service => Payment(transId=afb6d6c4-3c17-4534-a029-5f30399c6088, status=Transaction completed, orderId= c0975159-91c5-4dc4-90eb-023bd59c4776, price=0.0)
2022-11-21 20:34:45.172  WARN [ELASTIC-SERVICE,1c03fbe60e3e4d4a,03037d36cd657437] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/%20c0975159-91c5-4dc4-90eb-023bd59c4776] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:34:45.175  WARN [ELASTIC-SERVICE,1c03fbe60e3e4d4a,36f23c6c2e9cf966] 29062 --- [http-nio-8085-exec-7] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/%20c0975159-91c5-4dc4-90eb-023bd59c4776] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:34:45.186  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Seeking to offset 6 for partition payment_complete-0
2022-11-21 20:34:45.191  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Seeking to offset 6 for partition payment_complete-0
2022-11-21 20:34:45.187 ERROR [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.esservice.kafka.PaymentConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.NoSuchElementException: No value present; nested exception is java.util.NoSuchElementException: No value present
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.esservice.kafka.PaymentConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.NoSuchElementException: No value present; nested exception is java.util.NoSuchElementException: No value present
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: java.util.NoSuchElementException: No value present
	at java.base/java.util.Optional.get(Optional.java:143) ~[na:na]
	at com.adirn.esservice.service.QueryDslService.updateOrder(QueryDslService.java:58) ~[classes/:na]
	at com.adirn.esservice.kafka.PaymentConsumer.consume(PaymentConsumer.java:26) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$beb184e.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-21 20:34:45.192 ERROR [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:101) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:168) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:122) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:819) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:777) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:732) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.getForEntity(RestTemplate.java:370) ~[spring-web-5.3.23.jar:5.3.23]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:52) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$c8bbb0b2.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-21 20:34:45.605  INFO [EMAIL-SERVICE,1c03fbe60e3e4d4a,fa7c81de40c1cc04] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Payment event received in email service => Payment(transId=afb6d6c4-3c17-4534-a029-5f30399c6088, status=Transaction completed, orderId= c0975159-91c5-4dc4-90eb-023bd59c4776, price=0.0)
2022-11-21 20:34:45.607  INFO [ELASTIC-SERVICE,1c03fbe60e3e4d4a,7d06cc31c27558af] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] c.adirn.esservice.kafka.PaymentConsumer  : payment event received in ES service => Payment(transId=afb6d6c4-3c17-4534-a029-5f30399c6088, status=Transaction completed, orderId= c0975159-91c5-4dc4-90eb-023bd59c4776, price=0.0)
2022-11-21 20:34:45.615  WARN [ELASTIC-SERVICE,1c03fbe60e3e4d4a,7d06cc31c27558af] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/%20c0975159-91c5-4dc4-90eb-023bd59c4776] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:34:45.619  WARN [ELASTIC-SERVICE,1c03fbe60e3e4d4a,c631919109ef4c5a] 29062 --- [http-nio-8085-exec-8] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/%20c0975159-91c5-4dc4-90eb-023bd59c4776] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:34:45.629  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Seeking to offset 6 for partition payment_complete-0
2022-11-21 20:34:45.637  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Seeking to offset 6 for partition payment_complete-0
2022-11-21 20:34:45.632 ERROR [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.esservice.kafka.PaymentConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.NoSuchElementException: No value present; nested exception is java.util.NoSuchElementException: No value present
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.esservice.kafka.PaymentConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.NoSuchElementException: No value present; nested exception is java.util.NoSuchElementException: No value present
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: java.util.NoSuchElementException: No value present
	at java.base/java.util.Optional.get(Optional.java:143) ~[na:na]
	at com.adirn.esservice.service.QueryDslService.updateOrder(QueryDslService.java:58) ~[classes/:na]
	at com.adirn.esservice.kafka.PaymentConsumer.consume(PaymentConsumer.java:26) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$beb184e.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-21 20:34:45.639 ERROR [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:101) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:168) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:122) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:819) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:777) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:732) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.getForEntity(RestTemplate.java:370) ~[spring-web-5.3.23.jar:5.3.23]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:52) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$c8bbb0b2.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-21 20:34:46.108  INFO [EMAIL-SERVICE,1c03fbe60e3e4d4a,2af6ed7e8b0746d6] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Payment event received in email service => Payment(transId=afb6d6c4-3c17-4534-a029-5f30399c6088, status=Transaction completed, orderId= c0975159-91c5-4dc4-90eb-023bd59c4776, price=0.0)
2022-11-21 20:34:46.110  INFO [ELASTIC-SERVICE,1c03fbe60e3e4d4a,bacb8451d89da1ef] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] c.adirn.esservice.kafka.PaymentConsumer  : payment event received in ES service => Payment(transId=afb6d6c4-3c17-4534-a029-5f30399c6088, status=Transaction completed, orderId= c0975159-91c5-4dc4-90eb-023bd59c4776, price=0.0)
2022-11-21 20:34:46.119  WARN [ELASTIC-SERVICE,1c03fbe60e3e4d4a,bacb8451d89da1ef] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/%20c0975159-91c5-4dc4-90eb-023bd59c4776] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:34:46.125  WARN [ELASTIC-SERVICE,1c03fbe60e3e4d4a,c942b940e4efe823] 29062 --- [http-nio-8085-exec-9] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/%20c0975159-91c5-4dc4-90eb-023bd59c4776] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:34:46.132  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Seeking to offset 6 for partition payment_complete-0
2022-11-21 20:34:46.138 ERROR [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.esservice.kafka.PaymentConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.NoSuchElementException: No value present; nested exception is java.util.NoSuchElementException: No value present
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.esservice.kafka.PaymentConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.NoSuchElementException: No value present; nested exception is java.util.NoSuchElementException: No value present
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: java.util.NoSuchElementException: No value present
	at java.base/java.util.Optional.get(Optional.java:143) ~[na:na]
	at com.adirn.esservice.service.QueryDslService.updateOrder(QueryDslService.java:58) ~[classes/:na]
	at com.adirn.esservice.kafka.PaymentConsumer.consume(PaymentConsumer.java:26) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$beb184e.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-21 20:34:46.142  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Seeking to offset 6 for partition payment_complete-0
2022-11-21 20:34:46.143 ERROR [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:101) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:168) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:122) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:819) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:777) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:732) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.getForEntity(RestTemplate.java:370) ~[spring-web-5.3.23.jar:5.3.23]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:52) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$c8bbb0b2.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-21 20:34:46.615  INFO [EMAIL-SERVICE,1c03fbe60e3e4d4a,91089dcd1f0752d8] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Payment event received in email service => Payment(transId=afb6d6c4-3c17-4534-a029-5f30399c6088, status=Transaction completed, orderId= c0975159-91c5-4dc4-90eb-023bd59c4776, price=0.0)
2022-11-21 20:34:46.618  INFO [ELASTIC-SERVICE,1c03fbe60e3e4d4a,71fbb35f2a9d7022] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] c.adirn.esservice.kafka.PaymentConsumer  : payment event received in ES service => Payment(transId=afb6d6c4-3c17-4534-a029-5f30399c6088, status=Transaction completed, orderId= c0975159-91c5-4dc4-90eb-023bd59c4776, price=0.0)
2022-11-21 20:34:46.625  WARN [ELASTIC-SERVICE,1c03fbe60e3e4d4a,71fbb35f2a9d7022] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/%20c0975159-91c5-4dc4-90eb-023bd59c4776] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:34:46.631  WARN [ELASTIC-SERVICE,1c03fbe60e3e4d4a,ff9545ef530b5629] 29062 --- [http-nio-8085-exec-1] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/%20c0975159-91c5-4dc4-90eb-023bd59c4776] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:34:46.638  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Seeking to offset 6 for partition payment_complete-0
2022-11-21 20:34:46.640 ERROR [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.esservice.kafka.PaymentConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.NoSuchElementException: No value present; nested exception is java.util.NoSuchElementException: No value present
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.esservice.kafka.PaymentConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.NoSuchElementException: No value present; nested exception is java.util.NoSuchElementException: No value present
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: java.util.NoSuchElementException: No value present
	at java.base/java.util.Optional.get(Optional.java:143) ~[na:na]
	at com.adirn.esservice.service.QueryDslService.updateOrder(QueryDslService.java:58) ~[classes/:na]
	at com.adirn.esservice.kafka.PaymentConsumer.consume(PaymentConsumer.java:26) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$beb184e.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-21 20:34:46.650  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Seeking to offset 6 for partition payment_complete-0
2022-11-21 20:34:46.652 ERROR [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Error handler threw an exception

org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:135) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2706) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2587) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 9 common frames omitted
Caused by: org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:101) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:168) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:122) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:819) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:777) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:732) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.getForEntity(RestTemplate.java:370) ~[spring-web-5.3.23.jar:5.3.23]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:52) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$c8bbb0b2.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-21 20:34:47.121  INFO [ELASTIC-SERVICE,1c03fbe60e3e4d4a,f00f71b16a185b5a] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] c.adirn.esservice.kafka.PaymentConsumer  : payment event received in ES service => Payment(transId=afb6d6c4-3c17-4534-a029-5f30399c6088, status=Transaction completed, orderId= c0975159-91c5-4dc4-90eb-023bd59c4776, price=0.0)
2022-11-21 20:34:47.121  INFO [EMAIL-SERVICE,1c03fbe60e3e4d4a,ca9ca3dfec025351] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Payment event received in email service => Payment(transId=afb6d6c4-3c17-4534-a029-5f30399c6088, status=Transaction completed, orderId= c0975159-91c5-4dc4-90eb-023bd59c4776, price=0.0)
2022-11-21 20:34:47.132  WARN [ELASTIC-SERVICE,1c03fbe60e3e4d4a,f00f71b16a185b5a] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/%20c0975159-91c5-4dc4-90eb-023bd59c4776] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:34:47.142  WARN [ELASTIC-SERVICE,1c03fbe60e3e4d4a,dfb34064b6b74b0f] 29062 --- [http-nio-8085-exec-10] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/%20c0975159-91c5-4dc4-90eb-023bd59c4776] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:34:47.141 ERROR [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.kafka.listener.DefaultErrorHandler   : Backoff FixedBackOff{interval=0, currentAttempts=10, maxAttempts=9} exhausted for payment_complete-0@6

org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.esservice.kafka.PaymentConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is java.util.NoSuchElementException: No value present; nested exception is java.util.NoSuchElementException: No value present
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: java.util.NoSuchElementException: No value present
	at java.base/java.util.Optional.get(Optional.java:143) ~[na:na]
	at com.adirn.esservice.service.QueryDslService.updateOrder(QueryDslService.java:58) ~[classes/:na]
	at com.adirn.esservice.kafka.PaymentConsumer.consume(PaymentConsumer.java:26) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$beb184e.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-21 20:34:47.162 ERROR [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.kafka.listener.DefaultErrorHandler   : Backoff FixedBackOff{interval=0, currentAttempts=10, maxAttempts=9} exhausted for payment_complete-0@6

org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void com.adirn.emailservice.kafka.OrderConsumer.consume(com.adirn.basemodels.models.Payment)' threw exception; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"; nested exception is org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2719) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2689) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2649) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2576) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2456) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2334) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2005) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.10.jar:2.8.10]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]
Caused by: org.springframework.web.client.HttpClientErrorException$BadRequest: 400 : "Invalid id"
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:101) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:168) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:122) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:819) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:777) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:732) ~[spring-web-5.3.23.jar:5.3.23]
	at org.springframework.web.client.RestTemplate.getForEntity(RestTemplate.java:370) ~[spring-web-5.3.23.jar:5.3.23]
	at com.adirn.emailservice.kafka.OrderConsumer.consume(OrderConsumer.java:52) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:578) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$FastClassBySpringCGLIB$$cde8c01d.invoke(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.cloud.sleuth.brave.instrument.messaging.MessageListenerMethodInterceptor.invoke(MessageListenerMethodInterceptor.java:58) ~[spring-cloud-sleuth-brave-3.1.5.jar:3.1.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.23.jar:5.3.23]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter$$EnhancerBySpringCGLIB$$c8bbb0b2.onMessage(<generated>) ~[spring-kafka-2.8.10.jar:2.8.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2669) ~[spring-kafka-2.8.10.jar:2.8.10]
	... 11 common frames omitted

2022-11-21 20:34:47.262  WARN [ELASTIC-SERVICE,59c4063622b3a05b,59c4063622b3a05b] 29062 --- [http-nio-8085-exec-2] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/c0975159-91c5-4dc4-90eb-023bd59c4776] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:34:48.550  WARN [ELASTIC-SERVICE,948cb2046c171816,948cb2046c171816] 29062 --- [http-nio-8085-exec-3] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/c0975159-91c5-4dc4-90eb-023bd59c4776] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:35:24.772  INFO [PAYMENT-SERVICE,5620af985312f005,5620af985312f005] 26018 --- [http-nio-8086-exec-9] c.a.p.kafka.PaymentProducer              : Payment Event => Payment(transId=602ad792-4557-4222-b091-24ddff3433e5, status=Transaction completed, orderId=c0975159-91c5-4dc4-90eb-023bd59c4776, price=0.0)
2022-11-21 20:35:24.777  INFO [ELASTIC-SERVICE,5620af985312f005,21e96670f113609a] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] c.adirn.esservice.kafka.PaymentConsumer  : payment event received in ES service => Payment(transId=602ad792-4557-4222-b091-24ddff3433e5, status=Transaction completed, orderId=c0975159-91c5-4dc4-90eb-023bd59c4776, price=0.0)
2022-11-21 20:35:24.777  INFO [EMAIL-SERVICE,5620af985312f005,cd226a05b4a444a8] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Payment event received in email service => Payment(transId=602ad792-4557-4222-b091-24ddff3433e5, status=Transaction completed, orderId=c0975159-91c5-4dc4-90eb-023bd59c4776, price=0.0)
2022-11-21 20:35:24.781  WARN [ELASTIC-SERVICE,5620af985312f005,21e96670f113609a] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/c0975159-91c5-4dc4-90eb-023bd59c4776] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:35:24.787  WARN [ELASTIC-SERVICE,5620af985312f005,6e4e147c62e4600b] 29062 --- [http-nio-8085-exec-4] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/c0975159-91c5-4dc4-90eb-023bd59c4776] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:35:24.793  INFO [EMAIL-SERVICE,5620af985312f005,cd226a05b4a444a8] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] c.a.emailservice.kafka.OrderConsumer     : Send reciept to customer => Customer(id=3, name=testuser2, email=adebcf@gamil.com, age=56)
2022-11-21 20:35:24.802  WARN [ELASTIC-SERVICE,5620af985312f005,21e96670f113609a] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.elasticsearch.client.RestClient      : request [PUT http://localhost:9200/order/_doc/c0975159-91c5-4dc4-90eb-023bd59c4776?timeout=1m] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:35:24.914  WARN [ELASTIC-SERVICE,5620af985312f005,21e96670f113609a] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.elasticsearch.client.RestClient      : request [POST http://localhost:9200/order/_refresh] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:35:24.918  INFO [ELASTIC-SERVICE,5620af985312f005,21e96670f113609a] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] c.adirn.esservice.kafka.PaymentConsumer  : Updated order => OrderEventES(id=c0975159-91c5-4dc4-90eb-023bd59c4776, status=SUCCESSFULL, message=ORDER PLACED......., customer=Customer(id=3, name=testuser2, email=adebcf@gamil.com, age=56), order=Order(id=c0975159-91c5-4dc4-90eb-023bd59c4776, cid=3, pid=3, qty=5), product=Product(id=3, name=speaker, price=100000.0, qtyavail=12)) 
2022-11-21 20:35:27.552  WARN [ELASTIC-SERVICE,c20d55982b273b74,c20d55982b273b74] 29062 --- [http-nio-8085-exec-5] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/c0975159-91c5-4dc4-90eb-023bd59c4776] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:35:49.141  WARN [ELASTIC-SERVICE,1cb419d1ad4e21f7,1cb419d1ad4e21f7] 29062 --- [http-nio-8085-exec-6] org.elasticsearch.client.RestClient      : request [GET http://localhost:9200/order/_doc/c0975159-91c5-4dc4-90eb-023bd59c4776] returned 1 warnings: [299 Elasticsearch-7.17.0-bee86328705acaa9a6daede7140defd4d9ec56bd "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
2022-11-21 20:35:54.809  INFO [PAYMENT-SERVICE,,] 26018 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.NetworkClient   : [Producer clientId=producer-1] Node -1 disconnected.
2022-11-21 20:44:18.396  INFO [ELASTIC-SERVICE,,] 29062 --- [Thread-2] o.s.c.s.a.z.ZipkinAutoConfiguration      : Flushing remaining spans on shutdown
2022-11-21 20:44:18.373  INFO [PAYMENT-SERVICE,,] 26018 --- [Thread-2] o.s.c.s.a.z.ZipkinAutoConfiguration      : Flushing remaining spans on shutdown
2022-11-21 20:44:18.389  INFO [EMAIL-SERVICE,,] 26218 --- [Thread-2] o.s.c.s.a.z.ZipkinAutoConfiguration      : Flushing remaining spans on shutdown
2022-11-21 20:44:18.448  INFO [ORDER-SERVICE,,] 26524 --- [Thread-2] o.s.c.s.a.z.ZipkinAutoConfiguration      : Flushing remaining spans on shutdown
2022-11-21 20:44:18.486  INFO [CUSTOMER-SERVICE,,] 26885 --- [Thread-2] o.s.c.s.a.z.ZipkinAutoConfiguration      : Flushing remaining spans on shutdown
2022-11-21 20:44:18.481  INFO [PRODUCT-SERVICE,,] 31433 --- [Thread-2] o.s.c.s.a.z.ZipkinAutoConfiguration      : Flushing remaining spans on shutdown
2022-11-21 20:44:20.680  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Revoke previously assigned partitions order_topics-0
2022-11-21 20:44:20.683  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Revoke previously assigned partitions customer_topic-0
2022-11-21 20:44:20.689  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Revoke previously assigned partitions payment_complete-0
2022-11-21 20:44:21.137  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : esconsumer: partitions revoked: [customer_topic-0]
2022-11-21 20:44:21.157  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : esconsumer: partitions revoked: [order_topics-0]
2022-11-21 20:44:21.156  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : esconsumer: partitions revoked: [payment_complete-0]
2022-11-21 20:44:21.798  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Member consumer-esconsumer-3-4695e67b-78a5-4d10-bb66-54d24d38766f sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2022-11-21 20:44:21.800  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Member consumer-esconsumer-1-f9928859-ec32-4e82-8c2f-fe797490759c sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2022-11-21 20:44:21.821  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Member consumer-esconsumer-2-25477664-ed9d-4e3d-8704-d1e6f5a644f5 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2022-11-21 20:44:21.881  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Resetting generation due to: consumer pro-actively leaving the group
2022-11-21 20:44:21.881  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Resetting generation due to: consumer pro-actively leaving the group
2022-11-21 20:44:21.882  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Request joining group due to: consumer pro-actively leaving the group
2022-11-21 20:44:21.881  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Request joining group due to: consumer pro-actively leaving the group
2022-11-21 20:44:21.882  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Unsubscribed all topics or patterns and assigned partitions
2022-11-21 20:44:21.882  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Unsubscribed all topics or patterns and assigned partitions
2022-11-21 20:44:21.881  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Resetting generation due to: consumer pro-actively leaving the group
2022-11-21 20:44:21.882  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Request joining group due to: consumer pro-actively leaving the group
2022-11-21 20:44:21.882  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Unsubscribed all topics or patterns and assigned partitions
2022-11-21 20:44:21.920  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Resetting generation due to: consumer pro-actively leaving the group
2022-11-21 20:44:21.920  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Resetting generation due to: consumer pro-actively leaving the group
2022-11-21 20:44:21.920  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-2, groupId=esconsumer] Request joining group due to: consumer pro-actively leaving the group
2022-11-21 20:44:21.920  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-1, groupId=esconsumer] Request joining group due to: consumer pro-actively leaving the group
2022-11-21 20:44:21.920  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Resetting generation due to: consumer pro-actively leaving the group
2022-11-21 20:44:21.922  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-esconsumer-3, groupId=esconsumer] Request joining group due to: consumer pro-actively leaving the group
2022-11-21 20:44:22.119  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-21 20:44:22.119  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-21 20:44:22.119  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-21 20:44:22.119  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-21 20:44:22.120  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-21 20:44:22.121  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-21 20:44:22.157  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-esconsumer-3 unregistered
2022-11-21 20:44:22.158  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-esconsumer-2 unregistered
2022-11-21 20:44:22.164  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : esconsumer: Consumer stopped
2022-11-21 20:44:22.164  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : esconsumer: Consumer stopped
2022-11-21 20:44:22.349  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-21 20:44:22.354  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-21 20:44:22.359  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-21 20:44:22.437  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-esconsumer-1 unregistered
2022-11-21 20:44:22.445  INFO [ELASTIC-SERVICE,,] 29062 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : esconsumer: Consumer stopped
2022-11-21 20:44:24.012  INFO [PAYMENT-SERVICE,,] 26018 --- [SpringApplicationShutdownHook] o.a.k.clients.producer.KafkaProducer     : [Producer clientId=producer-1] Closing the Kafka producer with timeoutMillis = 30000 ms.
2022-11-21 20:44:24.063  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Revoke previously assigned partitions payment_complete-0
2022-11-21 20:44:24.066  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Revoke previously assigned partitions customer_topic-0
2022-11-21 20:44:24.068  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Revoke previously assigned partitions order_topics-0
2022-11-21 20:44:24.071  INFO [PAYMENT-SERVICE,,] 26018 --- [SpringApplicationShutdownHook] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-21 20:44:24.072  INFO [PAYMENT-SERVICE,,] 26018 --- [SpringApplicationShutdownHook] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-21 20:44:24.073  INFO [PAYMENT-SERVICE,,] 26018 --- [SpringApplicationShutdownHook] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-21 20:44:24.084  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions revoked: [payment_complete-0]
2022-11-21 20:44:24.084  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions revoked: [customer_topic-0]
2022-11-21 20:44:24.085  INFO [PAYMENT-SERVICE,,] 26018 --- [SpringApplicationShutdownHook] o.a.kafka.common.utils.AppInfoParser     : App info kafka.producer for producer-1 unregistered
2022-11-21 20:44:24.088  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: partitions revoked: [order_topics-0]
2022-11-21 20:44:24.117  INFO [ORDER-SERVICE,,] 26524 --- [SpringApplicationShutdownHook] o.a.k.clients.producer.KafkaProducer     : [Producer clientId=producer-1] Closing the Kafka producer with timeoutMillis = 30000 ms.
2022-11-21 20:44:24.134  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Member consumer-email-1-bd9b05dd-f216-4d1d-ae04-60a3e53bc1f8 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2022-11-21 20:44:24.139  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Member consumer-email-3-67fe0f1c-769e-4dbf-b102-33d6c60be30d sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2022-11-21 20:44:24.139  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Member consumer-email-2-2f1c4228-2dd6-42c7-b673-14b3a28c0bc6 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2022-11-21 20:44:24.151  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-21 20:44:24.152  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-21 20:44:24.152  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-21 20:44:24.152  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-21 20:44:24.153  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-21 20:44:24.153  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-21 20:44:24.154  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-3, groupId=email] Unsubscribed all topics or patterns and assigned partitions
2022-11-21 20:44:24.154  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-2, groupId=email] Unsubscribed all topics or patterns and assigned partitions
2022-11-21 20:44:24.153  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-email-1, groupId=email] Unsubscribed all topics or patterns and assigned partitions
2022-11-21 20:44:24.168  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-21 20:44:24.168  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-21 20:44:24.168  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Resetting generation due to: consumer pro-actively leaving the group
2022-11-21 20:44:24.169  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-3, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-21 20:44:24.169  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-2, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-21 20:44:24.170  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-email-1, groupId=email] Request joining group due to: consumer pro-actively leaving the group
2022-11-21 20:44:24.217  INFO [ORDER-SERVICE,,] 26524 --- [SpringApplicationShutdownHook] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-21 20:44:24.220  INFO [ORDER-SERVICE,,] 26524 --- [SpringApplicationShutdownHook] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-21 20:44:24.259  INFO [ORDER-SERVICE,,] 26524 --- [SpringApplicationShutdownHook] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-21 20:44:24.311  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-21 20:44:24.311  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-21 20:44:24.313  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-11-21 20:44:24.315  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-21 20:44:24.315  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-21 20:44:24.316  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-11-21 20:44:24.314  INFO [ORDER-SERVICE,,] 26524 --- [SpringApplicationShutdownHook] o.a.kafka.common.utils.AppInfoParser     : App info kafka.producer for producer-1 unregistered
2022-11-21 20:44:24.318  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-21 20:44:24.322  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-21 20:44:24.326  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-11-21 20:44:24.444  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-email-1 unregistered
2022-11-21 20:44:24.445  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-email-3 unregistered
2022-11-21 20:44:24.446  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-email-2 unregistered
2022-11-21 20:44:24.454  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: Consumer stopped
2022-11-21 20:44:24.456  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: Consumer stopped
2022-11-21 20:44:24.456  INFO [EMAIL-SERVICE,,] 26218 --- [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : email: Consumer stopped
